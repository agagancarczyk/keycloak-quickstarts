import{_ as F,r as i,i as E,by as q,j as a,p as z,u as K,d as W,n as X,B as N,bG as Y,bH as R,cQ as Z}from"./index-a3421f29.js";import{P as ee,L as $}from"./PaginatingTableToolbar-08ca9efb.js";import{e as se,D as ae,a as te,c as ie,d as ne}from"./DataListItemRow-75e02946.js";import{s as v}from"./data-list-7d55714c.js";import{M as le,a as O}from"./Modal-21c37af7.js";const T=o=>{var{children:c,className:d,visibility:r,id:p,"aria-label":f,"aria-labelledby":h,isPlainButtonAction:t}=o,m=F(o,["children","className","visibility","id","aria-label","aria-labelledby","isPlainButtonAction"]);return i.createElement("div",Object.assign({className:E(v.dataListItemAction,q(r,v),d)},m),t?i.createElement("div",{className:E(v.dataListAction)},c):c)};T.displayName="DataListAction";const V=o=>{var{className:c="",onChange:d=(n,x)=>{},isValid:r=!0,isDisabled:p=!1,isChecked:f=!1,checked:h=!1,defaultChecked:t,otherControls:m=!1}=o,b=F(o,["className","onChange","isValid","isDisabled","isChecked","checked","defaultChecked","otherControls"]);const y=i.createElement("div",{className:E(v.dataListCheck)},i.createElement("input",Object.assign({},b,{type:"checkbox",onChange:n=>d(n.currentTarget.checked,n),"aria-invalid":!r,disabled:p},[!0,!1].includes(t)&&{defaultChecked:t},![!0,!1].includes(t)&&{checked:f||h})));return i.createElement(i.Fragment,null,!m&&i.createElement("div",{className:E(v.dataListItemControl,c)},y),m&&y)};V.displayName="DataListCheck";const ce=({group:{path:o},onMouseEnter:c,...d})=>{const[r,p]=i.useState(""),f=t=>{p(o),c?.(t)},h=a.jsx("span",{onMouseEnter:f,...d,children:o});return r!==""?a.jsx(z,{content:r,isVisible:!0,children:h}):h};const he=({id:o,type:c,filterGroups:d,text:r,canBrowse:p=!0,onClose:f,onConfirm:h})=>{const{t}=K(),{adminClient:m}=W(),[b,y]=i.useState([]),[n,x]=i.useState([]),[G,H]=i.useState([]),[k,J]=i.useState(""),[Q,U]=i.useState([]),[w,j]=i.useState(),[u,P]=i.useState(!1),[S,M]=i.useState(10),[I,D]=i.useState(0),A=()=>n[n.length-1];X(async()=>{let e,s,l;if(!w)s=await m.groups.find({first:I,max:S+1,search:u?k:""});else{if(e=await m.groups.findOne({id:w}),!e)throw new Error(t("common:notFound"));s=e.subGroups}return o&&(l=await m.users.listGroups({id:o})),{group:e,groups:s,existingUserGroups:l}},async({group:e,groups:s,existingUserGroups:l})=>{U(l||[]),e&&x([...n,e]),s.forEach(C=>{C.checked=!!b.find(_=>_.id===C.id)}),H(s)},[w,k,I,S]);const L=e=>[...Q.map(s=>s.id),...(d||[]).map(s=>s.id)].some(s=>s===e?.id),B=e=>e.subGroups?.length!==0,g=(e,s)=>{if(e.name?.includes(s))return e;if(e.subGroups)for(const l of e.subGroups)return g(l,s);return e};return a.jsx(le,{variant:u?O.medium:O.small,title:t(r.title,{group1:d?.[0]?.name,group2:n.length?A().name:t("root")}),isOpen:!0,onClose:f,actions:[a.jsx(N,{"data-testid":`${r.ok}-button`,variant:"primary",form:"group-form",onClick:()=>{h(c==="selectMany"?b:n.length?[A()]:void 0)},isDisabled:c==="selectMany"&&b.length===0,children:t(r.ok)},"confirm")],children:a.jsxs(ee,{count:G.length,first:I,max:S,onNextClick:D,onPreviousClick:D,onPerPageSelect:(e,s)=>{D(e),M(s)},inputGroupName:"common:search",inputGroupOnEnter:e=>{J(e),P(e!==""),D(0),M(10),x([]),j(void 0)},inputGroupPlaceholder:t("users:searchForGroups"),children:[a.jsxs(Y,{children:[n.length>0&&a.jsx(R,{children:a.jsx(N,{variant:"link",onClick:()=>{j(void 0),x([])},children:t("groups")})},"home"),n.map((e,s)=>a.jsxs(R,{children:[n.length-1!==s&&a.jsx(N,{variant:"link",onClick:()=>{j(e.id),x([...n].slice(0,s))},children:e.name}),n.length-1===s&&e.name]},s))]}),a.jsx(se,{"aria-label":t("groups"),isCompact:!0,children:G.slice(0,S).map(e=>a.jsx(ae,{className:`join-group-dialog-row-${L(e)?"disabled":""}`,"aria-labelledby":e.name,id:e.id,onClick:s=>{const l=u?g(e,k):e;L(l)||(c==="selectOne"?j(l.id):B(e)&&s.target.type!=="checkbox"&&(j(u?g(e,k).id:e.id),P(!1)))},children:a.jsxs(te,{className:`join-group-dialog-row-${L(e)?"m-disabled":""}`,"data-testid":e.name,children:[c==="selectMany"&&a.jsx(V,{className:"kc-join-group-modal-check","data-testid":`${e.name}-check`,"aria-label":e.name,checked:e.checked,isDisabled:L(e),onChange:s=>{e.checked=s;let l=[];e.checked?l=[...b,u?g(e,k):e]:l=b.filter(C=>C.id!==e.id),y(l)},"aria-labelledby":`select-${e.name}`}),a.jsx(ie,{dataListCells:[a.jsx(ne,{className:"keycloak-groups-group-path",children:u?a.jsx(ce,{id:`select-${e.name}`,group:g(e,k)}):a.jsx("span",{id:`select-${e.name}`,children:e.name})},`name-${e.id}`)]}),a.jsx(T,{id:"actions","aria-labelledby":`select-${e.name}`,"aria-label":t("groupName"),isPlainButtonAction:!0,children:(B(e)&&p||c==="selectOne")&&a.jsx(N,{isDisabled:!0,variant:"link","aria-label":t("common:select"),children:a.jsx(Z,{})})})]})},e.id))}),G.length===0&&!u&&a.jsx($,{hasIcon:!1,message:t("groups:moveGroupEmpty"),instructions:t("groups:moveGroupEmptyInstructions")}),G.length===0&&u&&a.jsx($,{message:t("common:noSearchResults"),instructions:t("common:noSearchResultsInstructions")})]})})};export{he as G,ce as a};
//# sourceMappingURL=GroupPickerDialog-caf8c38d.js.map
