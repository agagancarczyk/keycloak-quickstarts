import{u as P,R as K,r as i,j as e,K as F,B as L,k as E,D as O,v as V,ah as $,w as I,L as N}from"./index-a3421f29.js";import{L as R}from"./PaginatingTableToolbar-08ca9efb.js";import{K as v}from"./KeycloakDataTable-10a62d94.js";import{u as W,m as T}from"./useLocaleSort-3efc7c31.js";import{M as q,a as z}from"./Modal-21c37af7.js";import{T as b,a as G}from"./Text-564bf299.js";import{e as H,D as k,a as A,c as w,d as C}from"./DataListItemRow-75e02946.js";const J=o=>{const{t:a}=P("client-scopes"),l=K(),f=o.protocol,n=l.protocolMapperTypes[f],m=l.builtinProtocolMappers[f],[g,p]=i.useState([]),[u,x]=i.useState([]),h=W(),d=i.useMemo(()=>h(m,T("name")).map(t=>{const r=n.filter(c=>c.id===t.protocolMapper)[0];return{item:t,name:t.name,description:r.helpText}}),[m,n]),[y,D]=i.useState(d);if(o.filter&&o.filter.length!==g.length){p(o.filter);const t=o.filter.map(r=>r.name);D([...d.filter(r=>!t.includes(r.item.name))])}const M=i.useMemo(()=>h(n,T("name")),[n]),s=!!o.filter,S=[a("common:name"),a("common:description")];return e.jsxs(q,{"aria-label":a(s?"addPredefinedMappers":"emptySecondaryAction"),variant:z.medium,header:e.jsxs(F,{role:"dialog","aria-label":a(s?"addPredefinedMappers":"emptySecondaryAction"),children:[e.jsx(b,{component:G.h1,children:a(s?"addPredefinedMappers":"emptySecondaryAction")}),e.jsx(b,{children:a(s?"predefinedMappingDescription":"configureMappingDescription")})]}),isOpen:o.open,onClose:o.toggleDialog,actions:s?[e.jsx(L,{id:"modal-confirm","data-testid":"confirm",isDisabled:y.length===0||u.length===0,onClick:()=>{o.onConfirm(u.map(({item:t})=>t)),o.toggleDialog()},children:a("common:add")},"confirm"),e.jsx(L,{id:"modal-cancel","data-testid":"cancel",variant:E.link,onClick:()=>{o.toggleDialog()},children:a("common:cancel")},"cancel")]:[],children:[!s&&e.jsxs(H,{onSelectDataListItem:t=>{const r=n.find(c=>c.id===t);o.onConfirm(r),o.toggleDialog()},"aria-label":a("addPredefinedMappers"),isCompact:!0,children:[e.jsx(k,{"aria-label":a("headerName"),id:"header",children:e.jsx(A,{children:e.jsx(w,{dataListCells:S.map(t=>e.jsx(C,{style:{fontWeight:700},children:t},t))})})}),M.map(t=>e.jsx(k,{"aria-label":t.name,id:t.id,children:e.jsx(A,{children:e.jsx(w,{dataListCells:[e.jsx(C,{children:t.name},`name-${t.id}`),e.jsx(C,{children:t.helpText},`helpText-${t.id}`)]})})},t.id))]}),s&&e.jsx(v,{loader:y,onSelect:x,canSelectAll:!0,ariaLabelKey:"client-scopes:addPredefinedMappers",searchPlaceholderKey:"common:searchForMapper",columns:[{name:"name",displayKey:"common:name"},{name:"description",displayKey:"common:description"}],emptyState:e.jsx(R,{message:a("common:emptyMappers"),instructions:a("client-scopes:emptyBuiltInMappersInstructions")})})]})},Q=({id:o,name:a,detailLink:l})=>e.jsx(N,{to:l(o),children:a}),oe=({model:o,onAdd:a,onDelete:l,detailLink:f})=>{const{t:n}=P("client-scopes"),[m,g]=i.useState(!1),p=o.protocolMappers,u=K().protocolMapperTypes[o.protocol],[x,h]=i.useState(0);i.useEffect(()=>h(x+1),[p]);const[d,y]=i.useState(!1),[D,M]=i.useState(o.protocolMappers),s=t=>{M(t?p||[]:void 0),y(!d)},S=async()=>p?p.reduce((r,c)=>{const j=u.find(({id:B})=>B===c.protocolMapper);return j?r.concat({...c,category:j.category,type:j.name,priority:j.priority}):r},[]).sort((r,c)=>r.priority-c.priority):[];return e.jsxs(e.Fragment,{children:[e.jsx(J,{protocol:o.protocol,filter:D,onConfirm:a,open:d,toggleDialog:()=>y(!d)}),e.jsx(v,{loader:S,ariaLabelKey:"client-scopes:clientScopeList",searchPlaceholderKey:"common:searchForMapper",toolbarItem:e.jsx(O,{onSelect:()=>g(!1),toggle:e.jsx(V,{isPrimary:!0,id:"mapperAction",onToggle:()=>g(!m),toggleIndicator:$,children:n("common:addMapper")}),isOpen:m,dropdownItems:[e.jsx(I,{onClick:()=>s(!0),children:n("fromPredefinedMapper")},"predefined"),e.jsx(I,{onClick:()=>s(!1),children:n("byConfiguration")},"byConfiguration")]}),actions:[{title:n("common:delete"),onRowClick:l}],columns:[{name:"name",cellRenderer:t=>e.jsx(Q,{...t,detailLink:f})},{name:"category"},{name:"type"},{name:"priority"}],emptyState:e.jsx(R,{message:n("common:emptyMappers"),instructions:n("common:emptyMappersInstructions"),secondaryActions:[{text:n("common:emptyPrimaryAction"),onClick:()=>s(!0)},{text:n("emptySecondaryAction"),onClick:()=>s(!1)}]})},x)]})};export{oe as M};
//# sourceMappingURL=MapperList-9e36e770.js.map
