import{u as P,d as R,a as _,r as u,n as V,j as d,C as E}from"./index-a3421f29.js";import{S as M,a as T,b as w}from"./Select-0f56a9cc.js";const D={resources:{searchFunction:"listResources",fetchFunction:"getAssociatedResources"},policies:{searchFunction:"listPolicies",fetchFunction:"getAssociatedPolicies"}},k=({name:t,clientId:h,permissionId:m,variant:v=T.typeaheadMulti,preSelected:o,isRequired:x=!1})=>{const{t:f}=P("clients"),{adminClient:g}=R(),{control:F,formState:{errors:C}}=_(),[y,b]=u.useState([]),[i,r]=u.useState(""),[j,A]=u.useState(!1),p=D[t],O=e=>({id:"_id"in e?e._id:"id"in e?e.id:void 0,name:e.name});V(async()=>{const e=Object.assign({id:h,first:0,max:10,permission:"false"},i===""?null:{name:i});return(await Promise.all([g.clients[p.searchFunction](e),m?g.clients[p.fetchFunction]({id:h,permissionId:m}):Promise.resolve([])])).flat().filter(s=>typeof s!="string").map(O).filter(({id:s},n,a)=>n===a.findIndex(({id:c})=>s===c))},b,[i]);const S=()=>y.map(e=>d.jsx(w,{value:e.id,children:e.name},e.id));return d.jsx(E,{name:t,defaultValue:o?[o]:[],control:F,rules:{validate:e=>!x||e.length>0},render:({field:e})=>d.jsx(M,{toggleId:t,variant:v,onToggle:A,onFilter:(s,n)=>(r(n),S()),onClear:()=>{e.onChange([]),r("")},selections:e.value,onSelect:(s,n)=>{const a=n.toString(),c=e.value?.find(l=>l===a)?e.value.filter(l=>l!==a):[...e.value,a];e.onChange(c),r("")},isOpen:j,"aria-labelledby":f(t),isDisabled:!!o,validated:C[t]?"error":"default",typeAheadAriaLabel:f(t),children:S()})})};export{k as R};
//# sourceMappingURL=ResourcesPolicySelect-e8d3e505.js.map
