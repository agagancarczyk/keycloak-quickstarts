import{bf as U,bg as $,bi as H,bQ as Q,_ as Z,r as l,bR as _,i as T,u as L,d as F,e as K,j as e,B as S,k as B,K as w,a2 as v,R as W,c as R,b as Y,n as q,A as J,bS as X,Z as z,P as ee,O as ae,Q as k,bT as te,D as se,v as re,aZ as ie,L as V,bL as ne,aW as oe,bU as A,w as le}from"./index-a3421f29.js";import{u as de}from"./ConfirmDialog-09ff7a12.js";import{G as ce,C as me}from"./ClickableCard-893889b5.js";import{K as pe}from"./KeycloakDataTable-10a62d94.js";import{V as ue}from"./ViewHeader-832ec56e.js";import{M as ge,a as he}from"./Modal-21c37af7.js";import{T as I,a as N}from"./Text-564bf299.js";import{e as xe,D as je,a as fe,b as ye,c as De,d as be}from"./DataListItemRow-75e02946.js";import{D as ve}from"./DataListControl-d3367bab.js";import{C as Ce}from"./CardTitle-9175b04a.js";import{b as E}from"./ToolbarContent-7b435752.js";import"./Card-aa3ba03c.js";import"./PaginatingTableToolbar-08ca9efb.js";import"./plus-circle-icon-cb854796.js";import"./EmptyStateBody-7b4fcee1.js";import"./EmptyStateSecondaryActions-08edafb5.js";import"./TableToolbar-ee0c86ef.js";import"./Form-518a2cf2.js";import"./Td-6d4ab209.js";import"./star-icon-6a7e7d25.js";import"./check-fc57dbe1.js";import"./grip-vertical-icon-cbeff50f.js";import"./Checkbox-d00621d8.js";import"./data-list-7d55714c.js";function Oe(a,s,t,n){for(var o=-1,m=a==null?0:a.length;++o<m;){var d=a[o];s(n,d,t(d),a)}return n}function Pe(a,s,t,n){return U(a,function(o,m,d){s(n,o,t(o),d)}),n}function Se(a,s){return function(t,n){var o=$(t)?Oe:Pe,m=s?s():{};return o(t,a,H(n),m)}}var we=Object.prototype,Ie=we.hasOwnProperty,Le=Se(function(a,s,t){Ie.call(a,t)?a[t].push(s):Q(a,t,[s])});const Te=Le,M=a=>{var{children:s=null,className:t="",label:n=""}=a,o=Z(a,["children","className","label"]);return l.createElement(_.Consumer,null,({sectionClass:m,sectionTitleClass:d,sectionComponent:u})=>{const x=u;return l.createElement(x,Object.assign({className:T(m,t)},o),n&&l.createElement("h1",{className:T(d),"aria-hidden":!0},n),l.createElement("ul",{role:"none"},s))})};M.displayName="DropdownGroup";const ke=({providers:a,onClose:s})=>{const{t}=L("identity-providers"),{adminClient:n}=F(),{addAlert:o,addError:m}=K(),[d,u]=l.useState(""),[x,g]=l.useState(""),[j,p]=l.useState(a.map(i=>i.alias)),y=i=>{u(i),g(t("common:onDragStart",{item:i}))},f=()=>{g(t("common:onDragMove",{item:d}))},C=()=>{g(t("common:onDragCancel"))},D=i=>{g(t("common:onDragFinish",{list:i})),p(i)};return e.jsxs(ge,{variant:he.small,title:t("manageDisplayOrder"),isOpen:!0,onClose:s,actions:[e.jsx(S,{id:"modal-confirm","data-testid":"confirm",onClick:async()=>{const i=j.map((h,O)=>{const b=a.find(P=>P.alias===h);return b.config.guiOrder=O,n.identityProviders.update({alias:h},b)});try{await Promise.all(i),o(t("orderChangeSuccess"))}catch(h){m("identity-providers:orderChangeError",h)}s()},children:t("common:save")},"confirm"),e.jsx(S,{id:"modal-cancel","data-testid":"cancel",variant:B.link,onClick:s,children:t("common:cancel")},"cancel")],children:[e.jsx(w,{className:"pf-u-pb-lg",children:e.jsx(I,{children:t("orderDialogIntro")})}),e.jsx(xe,{"aria-label":t("manageOrderTableAria"),"data-testid":"manageOrderDataList",isCompact:!0,onDragFinish:D,onDragStart:y,onDragMove:f,onDragCancel:C,itemOrder:j,children:v(a,"config.guiOrder","alias").map(i=>e.jsx(je,{"aria-label":i.alias,id:i.alias,children:e.jsxs(fe,{children:[e.jsx(ve,{children:e.jsx(ye,{"aria-label":t("common-help:dragHelp")})}),e.jsx(De,{dataListCells:[e.jsx(be,{"data-testid":i.alias,children:i.alias},i.alias)]})]})},i.alias))}),e.jsx("div",{className:"pf-screen-reader","aria-live":"assertive",children:x})]})},Ae=a=>{const{t:s}=L("identity-providers"),{realm:t}=R();return e.jsxs(V,{to:ne({realm:t,providerId:a.providerId,alias:a.alias,tab:"settings"}),children:[a.displayName||a.alias,!a.enabled&&e.jsx(oe,{isRead:!0,className:"pf-u-ml-sm",children:s("common:disabled")},`${a.providerId}-disabled`)]},a.providerId)};function sa(){const{t:a}=L("identity-providers"),s=Te(W().identityProviders,"groupName"),{realm:t}=R(),n=Y(),[o,m]=l.useState(0),d=()=>m(o+1),[u,x]=l.useState(!1),[g,j]=l.useState(!1),[p,y]=l.useState(),[f,C]=l.useState(),{adminClient:D}=F(),{addAlert:i,addError:h}=K();q(async()=>{const r=await D.realms.findOne({realm:t});if(!r)throw new Error(a("common:notFound"));return r.identityProviders},r=>{y(v(r,["config.guiOrder","alias"]))},[o]);const O=r=>n(A({realm:t,providerId:r})),b=()=>Object.keys(s).map(r=>e.jsx(M,{label:r,children:v(s[r],"name").map(c=>e.jsx(le,{value:c.id,component:e.jsx(V,{to:A({realm:t,providerId:c.id}),"data-testid":c.id,children:c.name})},c.id))},r)),[P,G]=de({titleKey:"identity-providers:deleteProvider",messageKey:a("deleteConfirm",{provider:f?.alias}),continueButtonLabel:"common:delete",continueButtonVariant:B.danger,onConfirm:async()=>{try{await D.identityProviders.del({alias:f.alias}),y([...p.filter(r=>r.alias!==f?.alias)]),d(),i(a("deletedSuccess"),J.success)}catch(r){h("identity-providers:deleteError",r)}}});return p?e.jsxs(e.Fragment,{children:[e.jsx(G,{}),g&&e.jsx(ke,{onClose:()=>{j(!1),d()},providers:p.filter(r=>r.enabled)}),e.jsx(ue,{titleKey:"common:identityProviders",subKey:"identity-providers:listExplain",helpUrl:z.identityProvidersUrl}),e.jsxs(ee,{variant:p.length===0?"default":"light",className:p.length===0?"":"pf-u-p-0",children:[p.length===0&&e.jsxs(e.Fragment,{children:[e.jsx(w,{children:e.jsx(I,{component:N.p,children:a("getStarted")})}),Object.keys(s).map(r=>e.jsxs(l.Fragment,{children:[e.jsx(w,{children:e.jsxs(I,{className:"pf-u-mt-lg",component:N.h2,children:[r,":"]})}),e.jsx("hr",{className:"pf-u-mb-lg"}),e.jsx(ce,{hasGutter:!0,children:v(s[r],"name").map(c=>e.jsx(me,{"data-testid":`${c.id}-card`,onClick:()=>O(c.id),children:e.jsx(Ce,{children:e.jsxs(ae,{hasGutter:!0,children:[e.jsx(k,{children:e.jsx(te,{icon:c.id})}),e.jsx(k,{isFilled:!0,children:c.name})]})})},c.id))})]},r))]}),p.length!==0&&e.jsx(pe,{loader:p,ariaLabelKey:"common:identityProviders",searchPlaceholderKey:"identity-providers:searchForProvider",toolbarItem:e.jsxs(e.Fragment,{children:[e.jsx(E,{children:e.jsx(se,{"data-testid":"addProviderDropdown",toggle:e.jsx(re,{onToggle:()=>x(!u),isPrimary:!0,children:a("addProvider")}),isOpen:u,dropdownItems:b()})}),e.jsx(E,{children:e.jsx(S,{"data-testid":"manageDisplayOrder",variant:"link",onClick:()=>j(!0),children:a("manageDisplayOrder")})})]}),actions:[{title:a("common:delete"),onRowClick:r=>{C(r),P()}}],columns:[{name:"alias",displayKey:"common:name",cellRenderer:Ae},{name:"providerId",displayKey:"identity-providers:providerDetails",cellFormatters:[ie()]}]})]})]}):e.jsx(X,{})}export{sa as default};
//# sourceMappingURL=IdentityProvidersSection-cbd88aab.js.map
