import{_ as N,r as l,i as B,m as W,j as e,D as X,a7 as Y,L as ee,E as ae,u as E,d as V,e as K,B as O,k as G,K as w,a2 as te,c as re,b as se,R as oe,n as ne,w as P,dk as T,as as S,A as ie,Z as le,P as de,O as ce,Q as L,dl as me,dm as ue,dn as pe}from"./index-a3421f29.js";import{u as ge}from"./ConfirmDialog-09ff7a12.js";import{G as U,C as he}from"./ClickableCard-893889b5.js";import{s as F,C as fe}from"./Card-aa3ba03c.js";import{C as xe}from"./CardHeader-457352d1.js";import{C as $}from"./CardTitle-9175b04a.js";import{C as Ce}from"./CardBody-519f6395.js";import{F as je,a as M}from"./FlexItem-65b5f999.js";import{V as De}from"./ViewHeader-832ec56e.js";import{M as ye,a as ve}from"./Modal-21c37af7.js";import{T as I,a as A}from"./Text-564bf299.js";import{e as be,D as ke,a as Se,b as we,c as Fe,d as Ie}from"./DataListItemRow-75e02946.js";import{D as Ne}from"./DataListControl-d3367bab.js";import"./ToolbarContent-7b435752.js";import"./data-list-7d55714c.js";import"./grip-vertical-icon-cbeff50f.js";const z=t=>{var{children:n=null,className:r="",hasNoOffset:d=!1}=t,s=N(t,["children","className","hasNoOffset"]);return l.createElement("div",Object.assign({className:B(F.cardActions,d&&F.modifiers.noOffset,r)},s),n)};z.displayName="CardActions";const R=t=>{var{children:n=null,className:r="",component:d="div"}=t,s=N(t,["children","className","component"]);const i=d;return l.createElement(i,Object.assign({className:B(F.cardFooter,r)},s),n)};R.displayName="CardFooter";const _=t=>{var{children:n=null,component:r="div"}=t,d=N(t,["children","component"]);const s=r;return l.createElement(s,Object.assign({},d),n)};_.displayName="GalleryItem";const Oe={name:"DatabaseIcon",height:512,width:448,svgPath:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z",yOffset:0,xOffset:0},Pe=W(Oe);const Te=({title:t,dropdownItems:n,labelText:r,labelColor:d,footerText:s,to:i})=>{const[m,p]=l.useState(!1),g=()=>{p(!m)};return e.jsxs(fe,{isSelectable:!0,children:[e.jsxs(xe,{children:[e.jsx(z,{children:n&&e.jsx(X,{"data-testid":`${t}-dropdown`,isPlain:!0,position:"right",toggle:e.jsx(Y,{onToggle:g}),isOpen:m,dropdownItems:n})}),e.jsx($,{"data-testid":"keycloak-card-title",children:e.jsx(ee,{to:i,children:t})})]}),e.jsx(Ce,{}),e.jsx(R,{children:e.jsxs(je,{children:[e.jsx(M,{className:"keycloak--keycloak-card__footer",children:s&&s}),e.jsx(M,{children:r&&e.jsx(ae,{color:d||"gray",children:r})})]})})]})},Le=({components:t,onClose:n})=>{const{t:r}=E("user-federation"),{adminClient:d}=V(),{addAlert:s,addError:i}=K(),[m,p]=l.useState(""),[g,u]=l.useState(""),[h,D]=l.useState(t.map(o=>o.name)),C=o=>{p(o),u(r("common:onDragStart",{item:o}))},j=()=>{u(r("common:onDragMove",{item:m}))},y=()=>{u(r("common:onDragCancel"))},v=o=>{u(r("common:onDragFinish",{list:o})),D(o)};return e.jsxs(ye,{variant:ve.small,title:r("managePriorityOrder"),isOpen:!0,onClose:n,actions:[e.jsx(O,{id:"modal-confirm",onClick:async()=>{const o=h.map((f,b)=>{const x=t.find(k=>k.name===f);return x.config.priority=[b.toString()],d.components.update({id:x.id},x)});try{await Promise.all(o),s(r("orderChangeSuccess"))}catch(f){i("orderChangeError",f)}n()},children:r("common:save")},"confirm"),e.jsx(O,{id:"modal-cancel",variant:G.link,onClick:n,children:r("common:cancel")},"cancel")],children:[e.jsx(w,{className:"pf-u-pb-lg",children:e.jsx(I,{children:r("managePriorityInfo")})}),e.jsx(be,{"aria-label":r("manageOrderTableAria"),"data-testid":"manageOrderDataList",isCompact:!0,onDragFinish:v,onDragStart:C,onDragMove:j,onDragCancel:y,itemOrder:h,children:te(t,"config.priority","name").map(o=>e.jsx(ke,{"aria-label":o.name,id:o.name,children:e.jsxs(Se,{children:[e.jsx(Ne,{children:e.jsx(we,{"aria-label":r("common-help:dragHelp")})}),e.jsx(Fe,{dataListCells:[e.jsx(Ie,{"data-testid":o.name,children:o.name},o.name)]})]})},o.name))}),e.jsx("div",{className:"pf-screen-reader","aria-live":"assertive",children:g})]})};function Je(){const[t,n]=l.useState(),{addAlert:r,addError:d}=K(),{t:s}=E("user-federation"),{realm:i}=re(),{adminClient:m}=V(),[p,g]=l.useState(0),u=()=>g(new Date().getTime()),h=se(),[D,C]=l.useState(!1),j=oe().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[];ne(async()=>{const c={parentId:(await m.realms.findOne({realm:i})).id,type:"org.keycloak.storage.UserStorageProvider"};return m.components.find(c)},a=>{n(a)},[p]);const y=l.useMemo(()=>j.map(a=>e.jsx(P,{onClick:()=>h(T({realm:i,providerId:a.id})),children:a.id.toUpperCase()=="LDAP"?a.id.toUpperCase():S(a.id)},a.id)),[]),v={variant:"link",onClick:()=>C(!0),lowerButtonTitle:s("managePriorities")};let o;const[f,b]=l.useState(""),[x,k]=ge({titleKey:s("userFedDeleteConfirmTitle"),messageKey:s("userFedDeleteConfirm"),continueButtonLabel:"common:delete",continueButtonVariant:G.danger,onConfirm:async()=>{try{await m.components.del({id:f}),u(),r(s("userFedDeletedSuccess"),ie.success)}catch(a){d("user-federation:userFedDeleteError",a)}}}),H=a=>{b(a),x()},Q=(a,c)=>{const q=`${a.name}`,J=`${c.name}`;return q<J?-1:1},Z=(a,c)=>{switch(a){case"ldap":return pe({realm:i,id:c});case"kerberos":return ue({realm:i,id:c});default:return me({realm:i,providerId:a,id:c})}};return t&&(o=t.sort(Q).map((a,c)=>e.jsx(_,{className:"keycloak-admin--user-federation__gallery-item",children:e.jsx(Te,{to:Z(a.providerId,a.id),dropdownItems:[e.jsx(P,{onClick:()=>{H(a.id)},"data-testid":"card-delete",children:s("common:delete")},`${c}-cardDelete`)],title:a.name,footerText:S(a.providerId),labelText:a.config?.enabled?.[0]!=="false"?`${s("common:enabled")}`:`${s("common:disabled")}`,labelColor:a.config?.enabled?.[0]!=="false"?"blue":"gray"})},c))),e.jsxs(e.Fragment,{children:[e.jsx(k,{}),D&&t&&e.jsx(Le,{onClose:()=>C(!1),components:t.filter(a=>a.config?.enabled)}),e.jsx(De,{titleKey:"userFederation",subKey:"user-federation:userFederationExplain",helpUrl:le.userFederationUrl,...t&&t.length>0?{lowerDropdownItems:y,lowerDropdownMenuTitle:"user-federation:addNewProvider",lowerButton:v}:{}}),e.jsx(de,{children:t&&t.length>0?e.jsx(U,{hasGutter:!0,children:o}):e.jsxs(e.Fragment,{children:[e.jsx(w,{children:e.jsx(I,{component:A.p,children:s("getStarted")})}),e.jsx(w,{children:e.jsx(I,{className:"pf-u-mt-lg",component:A.h2,children:s("providers")})}),e.jsx("hr",{className:"pf-u-mb-lg"}),e.jsx(U,{hasGutter:!0,children:j.map(a=>e.jsx(he,{onClick:()=>h(T({realm:i,providerId:a.id})),"data-testid":`${a.id}-card`,children:e.jsx($,{children:e.jsxs(ce,{hasGutter:!0,children:[e.jsx(L,{children:e.jsx(Pe,{size:"lg"})}),e.jsx(L,{isFilled:!0,children:s("addProvider",{provider:S(a.id),count:4})})]})})},a.id))})]})})]})}export{Je as default};
//# sourceMappingURL=UserFederationSection-e4164e25.js.map
