import{u as K,b as E,f as B,d as O,c as G,e as L,r as j,n as N,N as q,k as H,am as h,j as e,X as U,w as $,P as z,F as P,V as d,G as W,g as X,B as b,L as J,an as M}from"./index-a3421f29.js";import{u as Q}from"./ConfirmDialog-09ff7a12.js";import{D as Y}from"./DynamicComponents-72877b30.js";import{F as Z}from"./FormAccess-1cceaef6.js";import{K as C}from"./KeycloakTextInput-e7f6e917.js";import{V as _}from"./ViewHeader-832ec56e.js";import{u as ee}from"./useParams-5abeab7d.js";import{A as te}from"./Form-518a2cf2.js";import"./Modal-21c37af7.js";import"./ClientSelect-3f0fc581.js";import"./Select-0f56a9cc.js";import"./check-fc57dbe1.js";import"./star-icon-6a7e7d25.js";import"./FileUpload-ca37c1a6.js";import"./CodeEditor-2fb93648.js";import"./copy-icon-a4fe01af.js";import"./EmptyStateBody-7b4fcee1.js";import"./EmptyStateSecondaryActions-08edafb5.js";import"./GroupPickerDialog-caf8c38d.js";import"./PaginatingTableToolbar-08ca9efb.js";import"./plus-circle-icon-cb854796.js";import"./TableToolbar-ee0c86ef.js";import"./ToolbarContent-7b435752.js";import"./DataListItemRow-75e02946.js";import"./data-list-7d55714c.js";import"./grip-vertical-icon-cbeff50f.js";import"./ActionListItem-ab1a4322.js";import"./FlexItem-65b5f999.js";import"./minus-circle-icon-6f9a971c.js";import"./MultiLineInput-14187d1c.js";import"./PasswordInput-85f9399f.js";import"./useToggle-a9cb2c55.js";import"./AddRoleMappingModal-abb19beb.js";import"./KeycloakDataTable-10a62d94.js";import"./Td-6d4ab209.js";import"./Checkbox-d00621d8.js";import"./useLocaleSort-3efc7c31.js";import"./resource-08ae7dbc.js";import"./joinPath-55fd24bc.js";import"./filter-icon-9d72dc58.js";import"./KeycloakTextArea-1b518857.js";import"./GridItem-d34dae2e.js";import"./Text-564bf299.js";function ze(){const{t}=K("clients"),{id:r,providerId:m,subTab:l}=ee(),c=E(),p=B({defaultValues:{providerId:m}}),{register:u,control:I,handleSubmit:D,reset:k,formState:{errors:f}}=p,{adminClient:s}=O(),{realm:n}=G(),{addAlert:g,addError:y}=L(),[v,R]=j.useState(),[S,w]=j.useState("");N(async()=>await Promise.all([s.realms.getClientRegistrationPolicyProviders({realm:n}),s.realms.findOne({realm:n}),r?s.components.findOne({id:r}):Promise.resolve()]),([i,o,a])=>{R(i.find(V=>V.id===m)),w(o?.id||""),k(a||{providerId:m})},[]);const x=q({control:I,defaultValue:"",name:"name"}),A=async i=>{i.config&&Object.entries(i.config).forEach(([o,a])=>i.config[o]=Array.isArray(a)?a:[a]);try{const o={...i,subType:l,parentId:S,providerType:"org.keycloak.services.clientregistration.policy.ClientRegistrationPolicy",providerId:m};if(r)await s.components.update({id:r},o);else{const{id:a}=await s.components.create(o);c(M({id:a,realm:n,subTab:l,providerId:m}))}g(t(`provider${r?"Updated":"Create"}Success`))}catch(o){y(`clients:provider${r?"Updated":"Create"}Error`,o)}},[F,T]=Q({titleKey:"clients:clientRegisterPolicyDeleteConfirmTitle",messageKey:t("clientRegisterPolicyDeleteConfirm",{name:x}),continueButtonLabel:"common:delete",continueButtonVariant:H.danger,onConfirm:async()=>{try{await s.components.del({realm:n,id:r}),g(t("clientRegisterPolicyDeleteSuccess")),c(h({realm:n,subTab:l}))}catch(i){y("clients:clientRegisterPolicyDeleteError",i)}}});return v?e.jsxs(e.Fragment,{children:[e.jsx(_,{titleKey:r?x:"clients:createPolicy",subKey:r,dropdownItems:r?[e.jsx($,{"data-testid":"delete",onClick:F,children:t("common:delete")},"delete")]:void 0}),e.jsx(T,{}),e.jsx(z,{variant:"light",children:e.jsxs(Z,{role:"manage-clients",isHorizontal:!0,onSubmit:D(A),children:[e.jsx(P,{label:t("provider"),fieldId:"provider",children:e.jsx(C,{id:"providerId","data-testid":"providerId",...u("providerId"),readOnly:!0})}),e.jsx(P,{label:t("common:name"),fieldId:"kc-name",helperTextInvalid:t("common:required"),validated:f.name?d.error:d.default,labelIcon:e.jsx(W,{helpText:t("clients-help:clientPolicyName"),fieldLabelId:"kc-name"}),isRequired:!0,children:e.jsx(C,{id:"kc-name","data-testid":"name",validated:f.name?d.error:d.default,...u("name",{required:!0})})}),e.jsx(X,{...p,children:e.jsx(Y,{properties:v.properties})}),e.jsxs(te,{children:[e.jsx(b,{"data-testid":"save",type:"submit",children:t("common:save")}),e.jsx(b,{variant:"link",component:i=>e.jsx(J,{...i,to:h({realm:n,subTab:l})}),children:t("common:cancel")})]})]})})]}):e.jsx(U,{})}export{ze as default};
//# sourceMappingURL=DetailProvider-bb073b03.js.map
