import{c as F,u as k,d as E,e as L,r as c,k as q,A as R,j as t,Z as z,P as G,B as J,L as B,a6 as Q,D as X,a7 as Y,w as _,a8 as K,a5 as $}from"./index-a3421f29.js";import{V as ee}from"./ViewHeader-832ec56e.js";import{K as te}from"./KeycloakDataTable-10a62d94.js";import{u as oe}from"./ConfirmDialog-09ff7a12.js";import{u as se,m as ne}from"./useLocaleSort-3efc7c31.js";import{A as m,r as re,a as ae,c as ce,C as P}from"./ClientScopeTypes-b557e5db.js";import{S as le,a as ie,C as pe,n as me,t as de,p as Se}from"./SearchFilter-bebed391.js";import{g as ue}from"./utils-49fe564a.js";import{b as C}from"./ToolbarContent-7b435752.js";import{N as A}from"./Td-6d4ab209.js";import"./Text-564bf299.js";import"./PaginatingTableToolbar-08ca9efb.js";import"./plus-circle-icon-cb854796.js";import"./EmptyStateBody-7b4fcee1.js";import"./EmptyStateSecondaryActions-08edafb5.js";import"./TableToolbar-ee0c86ef.js";import"./Form-518a2cf2.js";import"./Modal-21c37af7.js";import"./Select-0f56a9cc.js";import"./check-fc57dbe1.js";import"./star-icon-6a7e7d25.js";import"./filter-icon-9d72dc58.js";import"./grip-vertical-icon-cbeff50f.js";import"./Checkbox-d00621d8.js";const ye=s=>{const{t:o}=k("client-scopes"),{adminClient:n}=E(),{addAlert:d,addError:S}=L();return t.jsx(ae,{clientScope:s,type:s.type,all:!0,onSelect:async u=>{try{await ce(n,s,u),d(o("clientScopeSuccess"),R.success),s.refresh()}catch(i){S("client-scopes:clientScopeError",i)}}})},he=({id:s,name:o})=>{const{realm:n}=F();return t.jsx(B,{to:$({realm:n,id:s,tab:"settings"}),children:o},s)};function Me(){const{realm:s}=F(),{t:o}=k("client-scopes"),{adminClient:n}=E(),{addAlert:d,addError:S}=L(),[u,i]=c.useState(!1),[l,y]=c.useState([]),[r,j]=c.useState("name"),[w,h]=c.useState(m.none),[b,f]=c.useState("all"),N=se(),[T,O]=c.useState(0),a=()=>{y([]),O(T+1)},V=async(e,p,I)=>{const U=await n.clientScopes.listDefaultClientScopes(),H=await n.clientScopes.listDefaultOptionalClientScopes(),M=await n.clientScopes.find(),W=r==="name"?me(I):r==="type"?de(w):Se(b),Z=M.map(g=>({...g,type:U.find(x=>x.name===g.name)?P.default:H.find(x=>x.name===g.name)?P.optional:m.none})).filter(W);return N(Z,ne("name")).slice(e,Number(e)+Number(p))},[D,v]=oe({titleKey:o("deleteClientScope",{count:l.length,name:l[0]?.name}),messageKey:"client-scopes:deleteConfirm",continueButtonLabel:"common:delete",continueButtonVariant:q.danger,onConfirm:async()=>{try{for(const e of l){try{await re(n,e)}catch(p){console.warn("could not remove scope",p.response?.data?.errorMessage||p)}await n.clientScopes.del({id:e.id})}d(o("deletedSuccess"),R.success),a()}catch(e){S("client-scopes:deleteError",e)}}});return t.jsxs(t.Fragment,{children:[t.jsx(v,{}),t.jsx(ee,{titleKey:"clientScopes",subKey:"client-scopes:clientScopeExplain",helpUrl:z.clientScopesUrl}),t.jsx(G,{variant:"light",className:"pf-u-p-0",children:t.jsx(te,{loader:V,ariaLabelKey:"client-scopes:clientScopeList",searchPlaceholderKey:r==="name"?"client-scopes:searchFor":void 0,isSearching:r!=="name",searchTypeComponent:t.jsx(le,{searchType:r,onSelect:e=>j(e),withProtocol:!0}),isPaginated:!0,onSelect:e=>y([...e]),canSelectAll:!0,toolbarItem:t.jsxs(t.Fragment,{children:[t.jsx(ie,{searchType:r,type:w,onSelect:e=>{j(e),f("all"),h(m.none),a()},onType:e=>{h(e),f("all"),a()},protocol:b,onProtocol:e=>{f(e),h(m.none),a()}}),t.jsx(C,{children:t.jsx(J,{component:e=>t.jsx(B,{...e,to:Q({realm:s})}),children:o("createClientScope")})}),t.jsx(C,{children:t.jsx(pe,{selectedRows:l,refresh:a})}),t.jsx(C,{children:t.jsx(X,{toggle:t.jsx(Y,{onToggle:i}),isOpen:u,isPlain:!0,dropdownItems:[t.jsx(_,{component:"button",isDisabled:l.length===0,onClick:()=>{D(),i(!1)},children:o("common:delete")},"action")]})})]}),actions:[{title:o("common:delete"),onRowClick:e=>{y([e]),D()}}],columns:[{name:"name",cellRenderer:he},{name:"type",displayKey:"client-scopes:assignedType",cellRenderer:e=>t.jsx(ye,{...e,refresh:a})},{name:"protocol",displayKey:"client-scopes:protocol",cellRenderer:e=>ue(o,e.protocol??"openid-connect"),transforms:[A(15)]},{name:"attributes['gui.order']",displayKey:"client-scopes:displayOrder",cellFormatters:[K()],transforms:[A(15)]},{name:"description",cellFormatters:[K()]}]},T)})]})}export{Me as default};
//# sourceMappingURL=ClientScopesSection-6e89ea39.js.map
