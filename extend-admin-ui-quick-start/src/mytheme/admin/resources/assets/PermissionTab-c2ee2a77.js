import{u as F,b as E,d as I,c as N,r as x,n as v,j as s,X as L,P as D,F as k,G as w,S as G,L as K,at as j}from"./index-a3421f29.js";import{u as R}from"./useLocaleSort-3efc7c31.js";import{u as _}from"./ConfirmDialog-09ff7a12.js";import{T as A}from"./Trans-2fec9e72.js";import{C as c}from"./Card-aa3ba03c.js";import{C as f}from"./CardTitle-9175b04a.js";import{C as d}from"./CardBody-519f6395.js";import{F as O}from"./Form-518a2cf2.js";import{R as U,S as $,O as P,U as b,T as B,P as p,aj as H}from"./Td-6d4ab209.js";const Z=({id:n,type:t})=>{const{t:i}=F("common"),g=E(),{adminClient:r}=I(),{realm:o}=N(),[u,C]=x.useState(""),[m,l]=x.useState(),T=R(),h=e=>{switch(t){case"clients":return r.clients.updateFineGrainPermission({id:n},{enabled:e});case"users":return r.realms.updateUsersManagementPermissions({realm:o,enabled:e});case"groups":return r.groups.updatePermission({id:n},{enabled:e});case"roles":return r.roles.updatePermission({id:n},{enabled:e});case"identityProviders":return r.identityProviders.updatePermission({alias:n},{enabled:e})}};v(()=>Promise.all([r.clients.find({search:!0,clientId:o==="master"?"master-realm":"realm-management"}),(()=>{switch(t){case"clients":return r.clients.listFineGrainPermissions({id:n});case"users":return r.realms.getUsersManagementPermissions({realm:o});case"groups":return r.groups.listPermissions({id:n});case"roles":return r.roles.listPermissions({id:n});case"identityProviders":return r.identityProviders.listPermissions({alias:n})}})()]),([e,a])=>{C(e[0]?.id),l(a)},[n]);const[y,S]=_({titleKey:"common:permissionsDisable",messageKey:"common:permissionsDisableConfirm",continueButtonLabel:"common:confirm",onConfirm:async()=>{const e=await h(!1);l(e)}});return m?s.jsxs(D,{variant:"light",children:[s.jsx(S,{}),s.jsxs(c,{isFlat:!0,children:[s.jsx(f,{children:i("permissions")}),s.jsxs(d,{children:[i(`${t}PermissionsHint`),s.jsx(O,{isHorizontal:!0,className:"pf-u-pt-md",children:s.jsx(k,{hasNoPaddingTop:!0,className:"permission-label",label:i("permissionsEnabled"),fieldId:"permissionsEnabled",labelIcon:s.jsx(w,{helpText:i("clients-help:permissionsEnabled"),fieldLabelId:"clients:permissionsEnabled"}),children:s.jsx(G,{id:"permissionsEnabled","data-testid":"permissionSwitch",label:i("common:on"),labelOff:i("common:off"),isChecked:m.enabled,onChange:async e=>{if(e){const a=await h(e);l(a)}else y()},"aria-label":i("permissionsEnabled")})})})]})]}),m.enabled&&s.jsxs(s.Fragment,{children:[s.jsxs(c,{isFlat:!0,className:"pf-u-mt-lg",children:[s.jsx(f,{children:i("permissionsList")}),s.jsx(d,{children:s.jsxs(A,{i18nKey:"common:permissionsListIntro",children:[" ",s.jsx("strong",{children:{realm:o==="master"?"master-realm":"realm-management"}}),"."]})})]}),s.jsx(c,{isFlat:!0,className:"keycloak__permission__permission-table",children:s.jsx(d,{className:"pf-u-p-0",children:s.jsxs(U,{"aria-label":i("permissionsList"),variant:"compact",children:[s.jsx($,{children:s.jsxs(P,{children:[s.jsx(b,{id:"permissionsScopeName",children:i("permissionsScopeName")}),s.jsx(b,{id:"description",children:i("description")})]})}),s.jsx(B,{children:T(Object.entries(m.scopePermissions||{}),([e])=>e).map(([e,a])=>s.jsxs(P,{children:[s.jsx(p,{children:s.jsx(K,{to:j({realm:o,id:u,permissionType:"scope",permissionId:a}),children:e})}),s.jsx(p,{children:i(`scopePermissions.${t}.${e}-description`)}),s.jsx(p,{isActionCell:!0,children:s.jsx(H,{items:[{title:i("common:edit"),onClick(){g(j({realm:o,id:u,permissionType:"scope",permissionId:a}))}}]})})]},a))})]})})})]})]}):s.jsx(L,{})};export{Z as P};
//# sourceMappingURL=PermissionTab-c2ee2a77.js.map
