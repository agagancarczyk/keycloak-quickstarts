import{u as w,d as y,e as M,r as T,az as E,j as e,P as C,F as R,G as v,S as D,U as I,A as x,b as F,n as P,X as L,aL as A,b4 as b}from"./index-a3421f29.js";import{M as G}from"./MapperList-9e36e770.js";import{R as O,u as k}from"./RoutableTabs-7f56b0c5.js";import{V as K}from"./ViewHeader-832ec56e.js";import{u as N}from"./useParams-5abeab7d.js";import{F as V}from"./FormAccess-1cceaef6.js";import{R as z}from"./AddRoleMappingModal-abb19beb.js";import{a as g,b as j}from"./Tabs-5beaba80.js";import"./PaginatingTableToolbar-08ca9efb.js";import"./plus-circle-icon-cb854796.js";import"./EmptyStateBody-7b4fcee1.js";import"./EmptyStateSecondaryActions-08edafb5.js";import"./TableToolbar-ee0c86ef.js";import"./ToolbarContent-7b435752.js";import"./Form-518a2cf2.js";import"./KeycloakDataTable-10a62d94.js";import"./Td-6d4ab209.js";import"./star-icon-6a7e7d25.js";import"./check-fc57dbe1.js";import"./grip-vertical-icon-cbeff50f.js";import"./Checkbox-d00621d8.js";import"./Modal-21c37af7.js";import"./useLocaleSort-3efc7c31.js";import"./Text-564bf299.js";import"./DataListItemRow-75e02946.js";import"./data-list-7d55714c.js";import"./copy-icon-a4fe01af.js";import"./GridItem-d34dae2e.js";import"./resource-08ae7dbc.js";import"./joinPath-55fd24bc.js";import"./filter-icon-9d72dc58.js";import"./ConfirmDialog-09ff7a12.js";import"./plus-icon-2a767bad.js";import"./MenuList-e3786b59.js";const H=({client:d})=>{const{t:a}=w("clients"),{adminClient:r}=y(),{addAlert:m,addError:c}=M(),[t,f]=T.useState(d),{hasAccess:s}=E(),u=s("manage-clients")||t.access?.manage,S=async l=>{try{const n=l.filter(i=>i.client===void 0).map(i=>i.role).flat();await Promise.all([r.clients.addRealmScopeMappings({id:t.id},n),...l.filter(i=>i.client!==void 0).map(i=>r.clients.addClientScopeMappings({id:t.id,client:i.client.id},[i.role]))]),m(a("clientScopeSuccess"),x.success)}catch(n){c("clients:clientScopeError",n)}},h=async()=>{const l={...t,fullScopeAllowed:!t.fullScopeAllowed};try{await r.clients.update({id:t.id},l),m(a("clientScopeSuccess"),x.success),f(l)}catch(n){c("clients:clientScopeError",n)}};return e.jsxs(C,{children:[e.jsx(V,{role:"manage-clients",fineGrainedAccess:t.access?.manage,isHorizontal:!0,children:e.jsx(R,{hasNoPaddingTop:!0,label:a("fullScopeAllowed"),labelIcon:e.jsx(v,{helpText:a("clients-help:fullScopeAllowed"),fieldLabelId:"clients:fullScopeAllowed"}),fieldId:"fullScopeAllowed",children:e.jsx(D,{id:"fullScopeAllowed",label:a("common:on"),labelOff:a("common:off"),isChecked:t.fullScopeAllowed,onChange:h,"aria-label":a("fullScopeAllowed")})})}),!t.fullScopeAllowed&&e.jsxs(e.Fragment,{children:[e.jsx(I,{}),e.jsx(z,{name:t.clientId,id:t.id,type:"clients",save:S,isManager:u})]})]})};function ye(){const{t:d}=w("clients"),a=F(),{realm:r,clientId:m}=N(),{adminClient:c}=y(),{addAlert:t,addError:f}=M(),[s,u]=T.useState();P(()=>c.clients.findOne({id:m}),u,[]);const S=o=>k(A({realm:r,clientId:m,tab:o})),h=S("mappers"),l=S("scope");if(!s)return e.jsx(L,{});const n=async o=>{if(Array.isArray(o))try{await c.clients.addMultipleProtocolMappers({id:s.id},o),u(await c.clients.findOne({id:s.id})),t(d("common:mappingCreatedSuccess"),x.success)}catch(p){f("common:mappingCreatedError",p)}else{const p=o;a(b({realm:r,id:s.id,mapperId:p.id}))}},i=async o=>{try{await c.clients.delProtocolMapper({id:s.id,mapperId:o.id}),u({...s,protocolMappers:s.protocolMappers?.filter(p=>p.id!==o.id)}),t(d("common:mappingDeletedSuccess"),x.success)}catch(p){f("common:mappingDeletedError",p)}return!0};return e.jsxs(e.Fragment,{children:[e.jsx(K,{titleKey:s.clientId,subKey:"clients-help:dedicatedScopeExplain",divider:!1}),e.jsx(C,{variant:"light",className:"pf-u-p-0",children:e.jsxs(O,{isBox:!0,mountOnEnter:!0,defaultLocation:A({realm:r,clientId:m,tab:"mappers"}),children:[e.jsx(g,{title:e.jsx(j,{children:d("mappers")}),"data-testid":"mappersTab",...h,children:e.jsx(G,{model:s,onAdd:n,onDelete:i,detailLink:o=>b({realm:r,id:s.id,mapperId:o})})}),e.jsx(g,{title:e.jsx(j,{children:d("scope")}),"data-testid":"scopeTab",...l,children:e.jsx(H,{client:s})})]})})]})}export{ye as default};
//# sourceMappingURL=DedicatedScopes-d29b287d.js.map
