import{u as w,b as D,d as F,e as T,r as U,f as k,n as z,j as e,aR as d,w as V,P as C,F as m,G as p,V as r,B as u,k as E,L,A as q}from"./index-a3421f29.js";import{F as G}from"./FormAccess-1cceaef6.js";import{K as h}from"./KeycloakTextInput-e7f6e917.js";import{V as R}from"./ViewHeader-832ec56e.js";import{u as B}from"./useParams-5abeab7d.js";import{u as K}from"./useToggle-a9cb2c55.js";import{D as P}from"./DeleteScopeDialog-976d398c.js";import{A as H}from"./Form-518a2cf2.js";import"./copy-icon-a4fe01af.js";import"./GridItem-d34dae2e.js";import"./Text-564bf299.js";import"./ToolbarContent-7b435752.js";import"./ConfirmDialog-09ff7a12.js";import"./Modal-21c37af7.js";function oe(){const{t}=w("clients"),{id:i,scopeId:o,realm:n}=B(),x=D(),{adminClient:l}=F(),{addAlert:I,addError:v}=T(),[S,f]=K(),[s,j]=U.useState(),{register:c,reset:b,handleSubmit:y,formState:{errors:g}}=k({mode:"onChange"});z(async()=>{if(o){const a=await l.clients.getAuthorizationScope({id:i,scopeId:o});if(!a)throw new Error(t("common:notFound"));return a}},a=>{j(a),b({...a})},[]);const A=async a=>{try{o?(await l.clients.updateAuthorizationScope({id:i,scopeId:o},a),j(a)):(await l.clients.createAuthorizationScope({id:i},{name:a.name,displayName:a.displayName,iconUri:a.iconUri}),x(d({realm:n,clientId:i,tab:"scopes"}))),I(t((o?"update":"create")+"ScopeSuccess"),q.success)}catch(N){v("clients:scopeSaveError",N)}};return e.jsxs(e.Fragment,{children:[e.jsx(P,{clientId:i,open:S,toggleDialog:f,selectedScope:s,refresh:()=>x(d({realm:n,clientId:i,tab:"scopes"}))}),e.jsx(R,{titleKey:o?s?.name:t("clients:createAuthorizationScope"),dropdownItems:o?[e.jsx(V,{"data-testid":"delete-resource",onClick:()=>f(),children:t("common:delete")},"delete")]:void 0}),e.jsx(C,{variant:"light",children:e.jsxs(G,{isHorizontal:!0,role:"view-clients",onSubmit:y(A),children:[e.jsx(m,{label:t("common:name"),fieldId:"name",labelIcon:e.jsx(p,{helpText:t("clients-help:scopeName"),fieldLabelId:"name"}),helperTextInvalid:t("common:required"),validated:g.name?r.error:r.default,isRequired:!0,children:e.jsx(h,{id:"name",validated:g.name?r.error:r.default,isRequired:!0,...c("name",{required:!0})})}),e.jsx(m,{label:t("displayName"),fieldId:"displayName",labelIcon:e.jsx(p,{helpText:t("clients-help:scopeDisplayName"),fieldLabelId:"displayName"}),children:e.jsx(h,{id:"displayName",...c("displayName")})}),e.jsx(m,{label:t("iconUri"),fieldId:"iconUri",labelIcon:e.jsx(p,{helpText:t("clients-help:iconUri"),fieldLabelId:"clients:iconUri"}),children:e.jsx(h,{id:"iconUri",...c("iconUri")})}),e.jsx(H,{children:e.jsxs("div",{className:"pf-u-mt-md",children:[e.jsx(u,{variant:E.primary,type:"submit","data-testid":"save",children:t("common:save")}),s?e.jsx(u,{variant:"link","data-testid":"revert",onClick:()=>b({...s}),children:t("common:revert")}):e.jsx(u,{variant:"link","data-testid":"cancel",component:a=>e.jsx(L,{...a,to:d({realm:n,clientId:i,tab:"scopes"})}),children:t("common:cancel")})]})})]})})]})}export{oe as default};
//# sourceMappingURL=ScopeDetails-b560065c.js.map
