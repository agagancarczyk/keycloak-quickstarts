import{u as I,z as j,d as D,e as E,a as w,N as $,A as a,j as r,w as c,aD as A}from"./index-a3421f29.js";import{u as l}from"./ConfirmDialog-09ff7a12.js";import{H as b}from"./SettingsCache-d185f52c.js";const H=({provider:m,editMode:d,save:U,noDivider:f=!1})=>{const{t:s}=I("user-federation"),{id:n}=j(),{adminClient:i}=D(),{addAlert:o,addError:t}=E(),{control:g}=w(),u=$({name:"config.importEnabled",control:g,defaultValue:["true"]})[0],[y,p]=l({titleKey:"user-federation:userFedUnlinkUsersConfirmTitle",messageKey:"user-federation:userFedUnlinkUsersConfirm",continueButtonLabel:"user-federation:unlinkUsers",onConfirm:()=>S()}),[v,C]=l({titleKey:s("removeImportedUsers"),messageKey:s("removeImportedUsersMessage"),continueButtonLabel:"common:remove",onConfirm:async()=>{try{h(),o(s("removeImportedUsersSuccess"),a.success)}catch(e){t("user-federation:removeImportedUsersError",e)}}}),h=async()=>{try{n&&await i.userStorageProvider.removeImportedUsers({id:n}),o(s("removeImportedUsersSuccess"),a.success)}catch(e){t("user-federation:removeImportedUsersError",e)}},k=async()=>{try{if(n){const e=await i.userStorageProvider.sync({id:n,action:"triggerChangedUsersSync"});e.ignored?o(`${e.status}.`,a.warning):o(s("syncUsersSuccess")+`${e.added} users added, ${e.updated} users updated, ${e.removed} users removed, ${e.failed} users failed.`,a.success)}}catch(e){t("user-federation:syncUsersError",e)}},x=async()=>{try{if(n){const e=await i.userStorageProvider.sync({id:n,action:"triggerFullSync"});e.ignored?o(`${e.status}.`,a.warning):o(s("syncUsersSuccess")+`${e.added} users added, ${e.updated} users updated, ${e.removed} users removed, ${e.failed} users failed.`,a.success)}}catch(e){t("user-federation:syncUsersError",e)}},S=async()=>{try{n&&await i.userStorageProvider.unlinkUsers({id:n}),o(s("unlinkUsersSuccess"),a.success)}catch(e){t("user-federation:unlinkUsersError",e)}};return r.jsxs(r.Fragment,{children:[r.jsx(p,{}),r.jsx(C,{}),r.jsx(b,{provider:m,noDivider:f,save:U,dropdownItems:[r.jsx(c,{onClick:k,isDisabled:u==="false",children:s("syncChangedUsers")},"sync"),r.jsx(c,{onClick:x,isDisabled:u==="false",children:s("syncAllUsers")},"syncall"),r.jsx(c,{isDisabled:d?!d.includes("UNSYNCED"):!1,onClick:y,children:s("unlinkUsers")},"unlink"),r.jsx(c,{onClick:v,children:s("removeImported")},"remove"),r.jsx(A,{},"separator")]})]})};export{H as E};
//# sourceMappingURL=ExtendedHeader-d25be090.js.map
