import{u as m,d as R,c as O,e as F,r as P,N as U,j as e,F as i,G as s,C as p,S as j,B as D,V as k,A as E,c8 as z,n as $,a as K,b as M,R as _,da as B}from"./index-a3421f29.js";import{S as G}from"./ScrollForm-a21fd695.js";import{F as T}from"./FormAccess-1cceaef6.js";import{W as A,S as W}from"./SettingsCache-d185f52c.js";import{K as u}from"./KeycloakTextInput-e7f6e917.js";import{P as Y}from"./PasswordInput-85f9399f.js";import{i as J}from"./isEqual-69fbe00f.js";import{S as L,b,a as w}from"./Select-0f56a9cc.js";import{F as Q,A as X}from"./Form-518a2cf2.js";const Z=["connectionUrl","bindDn","bindCredential","useTruststoreSpi","connectionTimeout","startTls","authType"],H=t=>{const n={};return Z.forEach(o=>{const a=z(t.getValues(),`config.${o}`);n[o]=Array.isArray(a)?a[0]:""}),n},ee=({form:t,id:n,showSectionHeading:o=!1,showSectionDescription:a=!1})=>{const{t:r}=m("user-federation"),{t:h}=m("user-federation-help"),{adminClient:c}=R(),{realm:l}=O(),{addAlert:f,addError:g}=F(),S=!!n,d=async x=>{try{const I=H(t);await c.realms.testLDAPConnection({realm:l},{...I,action:x,componentId:n}),f(r("testSuccess"),E.success)}catch(I){g("user-federation:testError",I)}},[v,y]=P.useState(!1),[C,q]=P.useState(!1),N=U({control:t.control,name:"config.authType",defaultValue:["simple"]});return e.jsxs(e.Fragment,{children:[o&&e.jsx(A,{title:r("connectionAndAuthenticationSettings"),description:h("ldapConnectionAndAuthorizationSettingsDescription"),showDescription:a}),e.jsxs(T,{role:"manage-realm",isHorizontal:!0,children:[e.jsx(i,{label:r("connectionURL"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:consoleDisplayConnectionUrlHelp"),fieldLabelId:"user-federation:connectionURL"}),fieldId:"kc-ui-connection-url",isRequired:!0,validated:t.formState.errors.config?.connectionUrl?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.connectionUrl?.[0].message,children:e.jsx(u,{isRequired:!0,type:"url",id:"kc-ui-connection-url","data-testid":"ldap-connection-url",validated:t.formState.errors.config?.connectionUrl?.[0]?"error":"default",...t.register("config.connectionUrl.0",{required:{value:!0,message:r("validateConnectionUrl").toString()}})})}),e.jsx(i,{label:r("enableStartTls"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:enableStartTlsHelp"),fieldLabelId:"user-federation:enableStartTls"}),fieldId:"kc-enable-start-tls",hasNoPaddingTop:!0,children:e.jsx(p,{name:"config.startTls",defaultValue:["false"],control:t.control,render:({field:x})=>e.jsx(j,{id:"kc-enable-start-tls","data-testid":"enable-start-tls",isDisabled:!1,onChange:I=>x.onChange([`${I}`]),isChecked:x.value[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("enableStartTls")})})}),e.jsx(i,{label:r("useTruststoreSpi"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:useTruststoreSpiHelp"),fieldLabelId:"user-federation:useTruststoreSpi"}),fieldId:"kc-use-truststore-spi",children:e.jsx(p,{name:"config.useTruststoreSpi[0]",control:t.control,defaultValue:"ldapsOnly",render:({field:x})=>e.jsxs(L,{toggleId:"kc-use-truststore-spi",onToggle:()=>y(!v),isOpen:v,onSelect:(I,V)=>{x.onChange(V.toString()),y(!1)},selections:x.value,children:[e.jsx(b,{value:"always",children:r("always")}),e.jsx(b,{value:"ldapsOnly",children:r("onlyLdaps")}),e.jsx(b,{value:"never",children:r("never")})]})})}),e.jsx(i,{label:r("connectionPooling"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:connectionPoolingHelp"),fieldLabelId:"user-federation:connectionPooling"}),fieldId:"kc-connection-pooling",hasNoPaddingTop:!0,children:e.jsx(p,{name:"config.connectionPooling",defaultValue:["false"],control:t.control,render:({field:x})=>e.jsx(j,{id:"kc-connection-pooling","data-testid":"connection-pooling",isDisabled:!1,onChange:I=>x.onChange([`${I}`]),isChecked:x.value[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("connectionPooling")})})}),e.jsx(i,{label:r("connectionTimeout"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:connectionTimeoutHelp"),fieldLabelId:"user-federation:consoleTimeout"}),fieldId:"kc-ui-connection-timeout",children:e.jsx(u,{type:"number",min:0,id:"kc-ui-connection-timeout","data-testid":"connection-timeout",...t.register("config.connectionTimeout.0")})}),e.jsx(i,{fieldId:"kc-test-connection-button",children:e.jsx(D,{variant:"secondary",id:"kc-test-connection-button","data-testid":"test-connection-button",onClick:()=>d("testConnection"),children:r("common:testConnection")})}),e.jsx(i,{label:r("bindType"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:bindTypeHelp"),fieldLabelId:"user-federation:bindType"}),fieldId:"kc-bind-type",isRequired:!0,children:e.jsx(p,{name:"config.authType[0]",defaultValue:"simple",control:t.control,render:({field:x})=>e.jsxs(L,{toggleId:"kc-bind-type",required:!0,onToggle:()=>q(!C),isOpen:C,onSelect:(I,V)=>{x.onChange(V),q(!1)},selections:x.value,variant:w.single,"data-testid":"ldap-bind-type",children:[e.jsx(b,{value:"simple"}),e.jsx(b,{value:"none"})]})})}),J(N,["simple"])&&e.jsxs(e.Fragment,{children:[e.jsx(i,{label:r("bindDn"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:bindDnHelp"),fieldLabelId:"user-federation:bindDn"}),fieldId:"kc-ui-bind-dn",helperTextInvalid:r("validateBindDn"),validated:t.formState.errors.config?.bindDn?k.error:k.default,isRequired:!0,children:e.jsx(u,{type:"text",id:"kc-ui-bind-dn","data-testid":"ldap-bind-dn",validated:t.formState.errors.config?.bindDn?k.error:k.default,...t.register("config.bindDn.0",{required:!0})})}),e.jsx(i,{label:r("bindCredentials"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:bindCredentialsHelp"),fieldLabelId:"user-federation:bindCredentials"}),fieldId:"kc-ui-bind-credentials",helperTextInvalid:r("validateBindCredentials"),validated:t.formState.errors.config?.bindCredential?k.error:k.default,isRequired:!0,children:e.jsx(Y,{hasReveal:!S,isRequired:!0,id:"kc-ui-bind-credentials","data-testid":"ldap-bind-credentials",validated:t.formState.errors.config?.bindCredential?k.error:k.default,...t.register("config.bindCredential.0",{required:!0})})})]}),e.jsx(i,{fieldId:"kc-test-auth-button",children:e.jsx(D,{variant:"secondary",id:"kc-test-auth-button","data-testid":"test-auth-button",onClick:()=>d("testAuthentication"),children:r("testAuthentication")})})]})]})},te="1.3.6.1.4.1.4203.1.11.1",ae=({id:t,form:n,showSectionHeading:o=!1,showSectionDescription:a=!1})=>{const{t:r}=m("user-federation"),{t:h}=m("user-federation-help"),{adminClient:c}=R(),{realm:l}=O(),{addAlert:f,addError:g}=F(),S=async()=>{if(await n.trigger())try{const d=H(n),v=await c.realms.ldapServerCapabilities({realm:l},{...d,componentId:t});f(r("testSuccess"));const y=v.filter(C=>C.oid===te);n.setValue("config.usePasswordModifyExtendedOp",[(y.length>0).toString()])}catch(d){g("user-federation:testError",d)}};return e.jsxs(e.Fragment,{children:[o&&e.jsx(A,{title:r("advancedSettings"),description:h("ldapAdvancedSettingsDescription"),showDescription:a}),e.jsxs(T,{role:"manage-realm",isHorizontal:!0,children:[e.jsx(i,{label:r("enableLdapv3Password"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:enableLdapv3PasswordHelp"),fieldLabelId:"user-federation:enableLdapv3Password"}),fieldId:"kc-enable-ldapv3-password",hasNoPaddingTop:!0,children:e.jsx(p,{name:"config.usePasswordModifyExtendedOp",defaultValue:["false"],control:n.control,render:({field:d})=>e.jsx(j,{id:"kc-enable-ldapv3-password","data-testid":"ldapv3-password",isDisabled:!1,onChange:v=>d.onChange([`${v}`]),isChecked:d.value[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("enableLdapv3Password")})})}),e.jsx(i,{label:r("validatePasswordPolicy"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:validatePasswordPolicyHelp"),fieldLabelId:"user-federation:validatePasswordPolicy"}),fieldId:"kc-validate-password-policy",hasNoPaddingTop:!0,children:e.jsx(p,{name:"config.validatePasswordPolicy",defaultValue:["false"],control:n.control,render:({field:d})=>e.jsx(j,{id:"kc-validate-password-policy","data-testid":"password-policy",isDisabled:!1,onChange:v=>d.onChange([`${v}`]),isChecked:d.value[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("validatePasswordPolicy")})})}),e.jsx(i,{label:r("trustEmail"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:trustEmailHelp"),fieldLabelId:"user-federation:trustEmail"}),fieldId:"kc-trust-email",hasNoPaddingTop:!0,children:e.jsx(p,{name:"config.trustEmail",defaultValue:["false"],control:n.control,render:({field:d})=>e.jsx(j,{id:"kc-trust-email","data-testid":"trust-email",isDisabled:!1,onChange:v=>d.onChange([`${v}`]),isChecked:d.value[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("trustEmail")})})}),e.jsx(i,{fieldId:"query-extensions",children:e.jsx(D,{variant:"secondary",id:"query-extensions","data-testid":"query-extensions",onClick:S,children:r("queryExtensions")})})]})]})},re=({form:t,showSectionHeading:n=!1,showSectionDescription:o=!1,vendorEdit:a=!1})=>{const{t:r}=m("user-federation"),{t:h}=m("user-federation-help"),{adminClient:c}=R(),{realm:l}=O();$(()=>c.realms.findOne({realm:l}),d=>t.setValue("parentId",d.id),[]);const[f,g]=P.useState(!1),S=()=>{switch(t.getValues("config.vendor[0]")){case"ad":t.setValue("config.usernameLDAPAttribute[0]","cn"),t.setValue("config.rdnLDAPAttribute[0]","cn"),t.setValue("config.uuidLDAPAttribute[0]","objectGUID"),t.setValue("config.userObjectClasses[0]","person, organizationalPerson, user");break;case"rhds":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","nsuniqueid"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;case"tivoli":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","uniqueidentifier"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;case"edirectory":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","guid"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;case"other":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","entryUUID"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;default:return""}};return e.jsxs(e.Fragment,{children:[n&&e.jsx(A,{title:r("generalOptions"),description:h("ldapGeneralOptionsSettingsDescription"),showDescription:o}),e.jsxs(T,{role:"manage-realm",isHorizontal:!0,children:[e.jsxs(i,{label:r("uiDisplayName"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:uiDisplayNameHelp"),fieldLabelId:"user-federation:uiDisplayName"}),fieldId:"kc-ui-display-name",isRequired:!0,validated:t.formState.errors.name?"error":"default",helperTextInvalid:t.formState.errors.name?.message,children:[e.jsx(u,{hidden:!0,id:"kc-ui-provider-id",defaultValue:"ldap",...t.register("providerId")}),e.jsx(u,{hidden:!0,id:"kc-ui-provider-type",defaultValue:"org.keycloak.storage.UserStorageProvider",...t.register("providerType")}),e.jsx(u,{hidden:!0,id:"kc-ui-parentId",defaultValue:l,...t.register("parentId")}),e.jsx(u,{isRequired:!0,id:"kc-ui-display-name",defaultValue:"ldap","data-testid":"ldap-name",validated:t.formState.errors.name?"error":"default",...t.register("name",{required:{value:!0,message:`${r("validateName")}`}})})]}),e.jsx(i,{label:r("vendor"),labelIcon:e.jsx(s,{helpText:r("user-federation-help:vendorHelp"),fieldLabelId:"user-federation:vendor"}),fieldId:"kc-vendor",isRequired:!0,children:e.jsx(p,{name:"config.vendor[0]",defaultValue:"ad",control:t.control,render:({field:d})=>e.jsxs(L,{isDisabled:!!a,toggleId:"kc-vendor",required:!0,onToggle:()=>g(!f),isOpen:f,onSelect:(v,y)=>{d.onChange(y),g(!1),S()},selections:d.value,variant:w.single,children:[e.jsx(b,{value:"ad",isPlaceholder:!0,children:"Active Directory"},0),e.jsx(b,{value:"rhds",children:"Red Hat Directory Server"},1),e.jsx(b,{value:"tivoli",children:"Tivoli"},2),e.jsx(b,{value:"edirectory",children:"Novell eDirectory"},3),e.jsx(b,{value:"other",children:"Other"},4)]})})})]})]})},ie=({form:t,showSectionHeading:n=!1,showSectionDescription:o=!1})=>{const{t:a}=m("user-federation"),{t:r}=m("user-federation-help"),h=U({control:t.control,name:"config.allowKerberosAuthentication",defaultValue:["false"]});return e.jsxs(e.Fragment,{children:[n&&e.jsx(A,{title:a("kerberosIntegration"),description:r("ldapKerberosSettingsDescription"),showDescription:o}),e.jsxs(T,{role:"manage-realm",isHorizontal:!0,children:[e.jsx(i,{label:a("allowKerberosAuthentication"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:allowKerberosAuthenticationHelp"),fieldLabelId:"user-federation:allowKerberosAuthentication"}),fieldId:"kc-allow-kerberos-authentication",hasNoPaddingTop:!0,children:e.jsx(p,{name:"config.allowKerberosAuthentication",defaultValue:["false"],control:t.control,render:({field:c})=>e.jsx(j,{id:"kc-allow-kerberos-authentication","data-testid":"allow-kerberos-auth",isDisabled:!1,onChange:l=>c.onChange([`${l}`]),isChecked:c.value[0]==="true",label:a("common:on"),labelOff:a("common:off"),"aria-label":a("allowKerberosAuthentication")})})}),h[0]==="true"&&e.jsxs(e.Fragment,{children:[e.jsx(i,{label:a("kerberosRealm"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:kerberosRealmHelp"),fieldLabelId:"user-federation:kerberosRealm"}),fieldId:"kc-kerberos-realm",isRequired:!0,validated:t.formState.errors.config?.kerberosRealm?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.kerberosRealm?.[0].message,children:e.jsx(u,{isRequired:!0,id:"kc-kerberos-realm","data-testid":"kerberos-realm",validated:t.formState.errors.config?.kerberosRealm?.[0]?"error":"default",...t.register("config.kerberosRealm.0",{required:{value:!0,message:a("validateRealm").toString()}})})}),e.jsx(i,{label:a("serverPrincipal"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:serverPrincipalHelp"),fieldLabelId:"user-federation:serverPrincipal"}),fieldId:"kc-server-principal",isRequired:!0,validated:t.formState.errors.config?.serverPrincipal?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.serverPrincipal?.[0].message,children:e.jsx(u,{isRequired:!0,id:"kc-server-principal","data-testid":"kerberos-principal",validated:t.formState.errors.config?.serverPrincipal?.[0]?"error":"default",...t.register("config.serverPrincipal.0",{required:{value:!0,message:`${a("validateServerPrincipal")}`}})})}),e.jsx(i,{label:a("keyTab"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:keyTabHelp"),fieldLabelId:"user-federation:keyTab"}),fieldId:"kc-key-tab",isRequired:!0,validated:t.formState.errors.config?.keyTab?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.keyTab?.[0].message,children:e.jsx(u,{isRequired:!0,id:"kc-key-tab","data-testid":"kerberos-keytab",validated:t.formState.errors.config?.keyTab?.[0]?"error":"default",...t.register("config.keyTab.0",{required:{value:!0,message:`${a("validateKeyTab")}`}})})}),e.jsxs(i,{label:a("debug"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:debugHelp"),fieldLabelId:"user-federation:debug"}),fieldId:"kc-debug",hasNoPaddingTop:!0,children:[" ",e.jsx(p,{name:"config.debug",defaultValue:["false"],control:t.control,render:({field:c})=>e.jsx(j,{id:"kc-debug","data-testid":"debug",isDisabled:!1,onChange:l=>c.onChange([`${l}`]),isChecked:c.value[0]==="true",label:a("common:on"),labelOff:a("common:off"),"aria-label":a("debug")})})]})]}),e.jsx(i,{label:a("useKerberosForPasswordAuthentication"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:useKerberosForPasswordAuthenticationHelp"),fieldLabelId:"user-federation:useKerberosForPasswordAuthentication"}),fieldId:"kc-use-kerberos-password-authentication",hasNoPaddingTop:!0,children:e.jsx(p,{name:"config.useKerberosForPasswordAuthentication",defaultValue:["false"],control:t.control,render:({field:c})=>e.jsx(j,{id:"kc-use-kerberos-password-authentication","data-testid":"use-kerberos-pw-auth",isDisabled:!1,onChange:l=>c.onChange([`${l}`]),isChecked:c.value[0]==="true",label:a("common:on"),labelOff:a("common:off"),"aria-label":a("useKerberosForPasswordAuthentication")})})})]})]})},se=({form:t,showSectionHeading:n=!1,showSectionDescription:o=!1})=>{const{t:a}=m("user-federation"),{t:r}=m("user-federation-help"),[h,c]=P.useState(!1),[l,f]=P.useState(!1);return e.jsxs(e.Fragment,{children:[n&&e.jsx(A,{title:a("ldapSearchingAndUpdatingSettings"),description:r("ldapSearchingAndUpdatingSettingsDescription"),showDescription:o}),e.jsxs(T,{role:"manage-realm",isHorizontal:!0,children:[e.jsx(i,{label:a("editMode"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:editModeLdapHelp"),fieldLabelId:"user-federation:editMode"}),fieldId:"kc-edit-mode",isRequired:!0,validated:t.formState.errors.config?.editMode?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.editMode?.[0].message,children:e.jsx(p,{name:"config.editMode[0]",defaultValue:"",control:t.control,rules:{required:{value:!0,message:a("validateEditMode")}},render:({field:g})=>e.jsxs(L,{toggleId:"kc-edit-mode",required:!0,onToggle:()=>f(!l),isOpen:l,onSelect:(S,d)=>{g.onChange(d.toString()),f(!1)},selections:g.value,variant:w.single,validated:t.formState.errors.config?.editMode?.[0]?"error":"default",children:[e.jsx(b,{value:"",isPlaceholder:!0}),e.jsx(b,{value:"READ_ONLY"}),e.jsx(b,{value:"WRITABLE"}),e.jsx(b,{value:"UNSYNCED"})]})})}),e.jsx(i,{label:a("usersDN"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:usersDNHelp"),fieldLabelId:"user-federation:usersDn"}),fieldId:"kc-ui-users-dn",isRequired:!0,validated:t.formState.errors.config?.usersDn?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.usersDn?.[0].message,children:e.jsx(u,{isRequired:!0,defaultValue:"",id:"kc-ui-users-dn","data-testid":"ldap-users-dn",validated:t.formState.errors.config?.usersDn?.[0]?"error":"default",...t.register("config.usersDn.0",{required:{value:!0,message:a("validateUsersDn").toString()}})})}),e.jsx(i,{label:a("usernameLdapAttribute"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:usernameLdapAttributeHelp"),fieldLabelId:"user-federation:usernameLdapAttribute"}),fieldId:"kc-username-ldap-attribute",isRequired:!0,validated:t.formState.errors.config?.usernameLDAPAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.usernameLDAPAttribute?.[0].message,children:e.jsx(u,{isRequired:!0,defaultValue:"cn",id:"kc-username-ldap-attribute","data-testid":"ldap-username-attribute",validated:t.formState.errors.config?.usernameLDAPAttribute?.[0]?"error":"default",...t.register("config.usernameLDAPAttribute.0",{required:{value:!0,message:`${a("validateUsernameLDAPAttribute")}`}})})}),e.jsx(i,{label:a("rdnLdapAttribute"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:rdnLdapAttributeHelp"),fieldLabelId:"user-federation:rdnLdapAttribute"}),fieldId:"kc-rdn-ldap-attribute",isRequired:!0,validated:t.formState.errors.config?.rdnLDAPAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.rdnLDAPAttribute?.[0].message,children:e.jsx(u,{isRequired:!0,defaultValue:"cn",id:"kc-rdn-ldap-attribute","data-testid":"ldap-rdn-attribute",validated:t.formState.errors.config?.rdnLDAPAttribute?.[0]?"error":"default",...t.register("config.rdnLDAPAttribute.0",{required:{value:!0,message:`${a("validateRdnLdapAttribute")}`}})})}),e.jsx(i,{label:a("uuidLdapAttribute"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:uuidLdapAttributeHelp"),fieldLabelId:"user-federation:uuidLdapAttribute"}),fieldId:"kc-uuid-ldap-attribute",isRequired:!0,validated:t.formState.errors.config?.uuidLDAPAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.uuidLDAPAttribute?.[0].message,children:e.jsx(u,{isRequired:!0,defaultValue:"objectGUID",id:"kc-uuid-ldap-attribute","data-testid":"ldap-uuid-attribute",validated:t.formState.errors.config?.uuidLDAPAttribute?.[0]?"error":"default",...t.register("config.uuidLDAPAttribute.0",{required:{value:!0,message:`${a("validateUuidLDAPAttribute")}`}})})}),e.jsx(i,{label:a("userObjectClasses"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:userObjectClassesHelp"),fieldLabelId:"user-federation:userObjectClasses"}),fieldId:"kc-user-object-classes",isRequired:!0,validated:t.formState.errors.config?.userObjectClasses?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.userObjectClasses?.[0].message,children:e.jsx(u,{isRequired:!0,defaultValue:"person, organizationalPerson, user",id:"kc-user-object-classes","data-testid":"ldap-user-object-classes",validated:t.formState.errors.config?.userObjectClasses?.[0]?"error":"default",...t.register("config.userObjectClasses.0",{required:{value:!0,message:a("validateUserObjectClasses").toString()}})})}),e.jsx(i,{label:a("userLdapFilter"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:userLdapFilterHelp"),fieldLabelId:"user-federation:userLdapFilter"}),fieldId:"kc-user-ldap-filter",validated:t.formState.errors.config?.customUserSearchFilter?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.customUserSearchFilter?.[0].message,children:e.jsx(u,{id:"kc-user-ldap-filter","data-testid":"user-ldap-filter",validated:t.formState.errors.config?.customUserSearchFilter?.[0]?"error":"default",...t.register("config.customUserSearchFilter.0",{pattern:{value:/(\(.*\))$/,message:a("validateCustomUserSearchFilter").toString()}})})}),e.jsx(i,{label:a("searchScope"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:searchScopeHelp"),fieldLabelId:"user-federation:searchScope"}),fieldId:"kc-search-scope",children:e.jsx(p,{name:"config.searchScope[0]",defaultValue:"",control:t.control,render:({field:g})=>e.jsxs(L,{toggleId:"kc-search-scope",required:!0,onToggle:()=>c(!h),isOpen:h,onSelect:(S,d)=>{g.onChange(d),c(!1)},selections:g.value,variant:w.single,children:[e.jsx(b,{value:"1",isPlaceholder:!0,children:a("oneLevel")},0),e.jsx(b,{value:"2",children:a("subtree")},1)]})})}),e.jsx(i,{label:a("readTimeout"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:readTimeoutHelp"),fieldLabelId:"user-federation:readTimeout"}),fieldId:"kc-read-timeout",children:e.jsx(u,{type:"number",min:0,id:"kc-read-timeout","data-testid":"ldap-read-timeout",...t.register("config.readTimeout.0")})}),e.jsx(i,{label:a("pagination"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:paginationHelp"),fieldLabelId:"user-federation:pagination"}),fieldId:"kc-ui-pagination",hasNoPaddingTop:!0,children:e.jsx(p,{name:"config.pagination",defaultValue:["false"],control:t.control,render:({field:g})=>e.jsx(j,{id:"kc-ui-pagination","data-testid":"ui-pagination",isDisabled:!1,onChange:S=>g.onChange([`${S}`]),isChecked:g.value[0]==="true",label:a("common:on"),labelOff:a("common:off"),"aria-label":a("pagination")})})})]})]})},ne=({form:t,showSectionHeading:n=!1,showSectionDescription:o=!1})=>{const{t:a}=m("user-federation"),{t:r}=m("user-federation-help"),h=t.watch("config.periodicFullSync",!1),c=t.watch("config.periodicChangedUsersSync",!1);return e.jsxs(e.Fragment,{children:[n&&e.jsx(A,{title:a("synchronizationSettings"),description:r("ldapSynchronizationSettingsDescription"),showDescription:o}),e.jsxs(T,{role:"manage-realm",isHorizontal:!0,children:[e.jsx(i,{hasNoPaddingTop:!0,label:a("importUsers"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:importUsersHelp"),fieldLabelId:"user-federation:importUsers"}),fieldId:"kc-import-users",children:e.jsx(p,{name:"config.importEnabled",defaultValue:["true"],control:t.control,render:({field:l})=>e.jsx(j,{id:"kc-import-users","data-testid":"import-users",name:"importEnabled",label:a("common:on"),labelOff:a("common:off"),onChange:f=>l.onChange([`${f}`]),isChecked:l.value[0]==="true",isDisabled:!1,"aria-label":a("importUsers")})})}),e.jsx(i,{hasNoPaddingTop:!0,label:a("syncRegistrations"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:syncRegistrations"),fieldLabelId:"user-federation:syncRegistrations"}),fieldId:"syncRegistrations",children:e.jsx(p,{name:"config.syncRegistrations",defaultValue:["true"],control:t.control,render:({field:l})=>e.jsx(j,{id:"syncRegistrations","data-testid":"syncRegistrations",label:a("common:on"),labelOff:a("common:off"),onChange:f=>l.onChange([`${f}`]),isChecked:l.value[0]==="true","aria-label":a("syncRegistrations")})})}),e.jsx(i,{label:a("batchSize"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:batchSizeHelp"),fieldLabelId:"user-federation:batchSize"}),fieldId:"kc-batch-size",children:e.jsx(u,{type:"number",min:0,id:"kc-batch-size","data-testid":"batch-size",...t.register("config.batchSizeForSync.0")})}),e.jsx(i,{label:a("periodicFullSync"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:periodicFullSyncHelp"),fieldLabelId:"user-federation:periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e.jsx(p,{name:"config.periodicFullSync",defaultValue:!1,control:t.control,render:({field:l})=>e.jsx(j,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",isDisabled:!1,onChange:f=>l.onChange(f),isChecked:l.value===!0,label:a("common:on"),labelOff:a("common:off"),"aria-label":a("periodicFullSync")})})}),h&&e.jsx(i,{hasNoPaddingTop:!0,label:a("fullSyncPeriod"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:fullSyncPeriodHelp"),fieldLabelId:"user-federation:fullSyncPeriod"}),fieldId:"kc-full-sync-period",children:e.jsx(u,{type:"number",min:-1,defaultValue:604800,id:"kc-full-sync-period","data-testid":"full-sync-period",...t.register("config.fullSyncPeriod.0")})}),e.jsx(i,{label:a("periodicChangedUsersSync"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:periodicChangedUsersSyncHelp"),fieldLabelId:"user-federation:periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e.jsx(p,{name:"config.periodicChangedUsersSync",defaultValue:!1,control:t.control,render:({field:l})=>e.jsx(j,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",isDisabled:!1,onChange:f=>l.onChange(f),isChecked:l.value===!0,label:a("common:on"),labelOff:a("common:off"),"aria-label":a("periodicChangedUsersSync")})})}),c&&e.jsx(i,{label:a("changedUsersSyncPeriod"),labelIcon:e.jsx(s,{helpText:a("user-federation-help:changedUsersSyncHelp"),fieldLabelId:"user-federation:changedUsersSyncPeriod"}),fieldId:"kc-changed-users-sync-period",hasNoPaddingTop:!0,children:e.jsx(u,{type:"number",min:-1,defaultValue:86400,id:"kc-changed-users-sync-period","data-testid":"changed-users-sync-period",...t.register("config.changedSyncPeriod.0")})})]})]})},he=({id:t,onSubmit:n})=>{const{t:o}=m("user-federation"),a=K(),r=M(),{realm:h}=O(),c=_().profileInfo?.disabledFeatures?.includes("KERBEROS");return e.jsxs(e.Fragment,{children:[e.jsx(G,{sections:[{title:o("generalOptions"),panel:e.jsx(re,{form:a,vendorEdit:!!t})},{title:o("connectionAndAuthenticationSettings"),panel:e.jsx(ee,{form:a,id:t})},{title:o("ldapSearchingAndUpdatingSettings"),panel:e.jsx(se,{form:a})},{title:o("synchronizationSettings"),panel:e.jsx(ne,{form:a})},{title:o("kerberosIntegration"),panel:e.jsx(ie,{form:a}),isHidden:c},{title:o("cacheSettings"),panel:e.jsx(W,{form:a})},{title:o("advancedSettings"),panel:e.jsx(ae,{form:a,id:t})}]}),e.jsx(Q,{onSubmit:a.handleSubmit(n),children:e.jsxs(X,{className:"keycloak__form_actions",children:[e.jsx(D,{isDisabled:!a.formState.isDirty,variant:"primary",type:"submit","data-testid":"ldap-save",children:o("common:save")}),e.jsx(D,{variant:"link",onClick:()=>r(B({realm:h})),"data-testid":"ldap-cancel",children:o("common:cancel")})]})})]})};function xe(t){const{config:n}=t;return n?.periodicChangedUsersSync!==void 0&&(n.periodicChangedUsersSync===!1&&(n.changedSyncPeriod=["-1"]),delete n.periodicChangedUsersSync),n?.periodicFullSync!==void 0&&(n.periodicFullSync===!1&&(n.fullSyncPeriod=["-1"]),delete n.periodicFullSync),t}export{he as U,xe as s};
//# sourceMappingURL=UserFederationLdapForm-17767f2d.js.map
