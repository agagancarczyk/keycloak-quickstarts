{"version":3,"file":"CreateFlow-bb36a1ba.js","sources":["../../src/authentication/form/FlowType.tsx","../../src/authentication/form/CreateFlow.tsx"],"sourcesContent":["import AuthenticationFlowRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/authenticationFlowRepresentation\";\nimport {\n  FormGroup,\n  Select,\n  SelectOption,\n  SelectVariant,\n} from \"@patternfly/react-core\";\nimport { useState } from \"react\";\nimport { Controller, useFormContext } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { HelpItem } from \"ui-shared\";\n\nconst TYPES = [\"basic-flow\", \"client-flow\"] as const;\n\nexport const FlowType = () => {\n  const { t } = useTranslation(\"authentication\");\n  const { control } = useFormContext<AuthenticationFlowRepresentation>();\n  const [open, setOpen] = useState(false);\n\n  return (\n    <FormGroup\n      label={t(\"flowType\")}\n      labelIcon={\n        <HelpItem\n          helpText={t(\"authentication-help:topLevelFlowType\")}\n          fieldLabelId=\"authentication:flowType\"\n        />\n      }\n      fieldId=\"flowType\"\n    >\n      <Controller\n        name=\"providerId\"\n        defaultValue={TYPES[0]}\n        control={control}\n        render={({ field }) => (\n          <Select\n            toggleId=\"flowType\"\n            onToggle={setOpen}\n            onSelect={(_, value) => {\n              field.onChange(value.toString());\n              setOpen(false);\n            }}\n            selections={t(`top-level-flow-type.${field.value}`)}\n            variant={SelectVariant.single}\n            aria-label={t(\"flowType\")}\n            isOpen={open}\n          >\n            {TYPES.map((type) => (\n              <SelectOption\n                key={type}\n                selected={type === field.value}\n                value={type}\n              >\n                {t(`top-level-flow-type.${type}`)}\n              </SelectOption>\n            ))}\n          </Select>\n        )}\n      />\n    </FormGroup>\n  );\n};\n","import type AuthenticationFlowRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/authenticationFlowRepresentation\";\nimport {\n  ActionGroup,\n  AlertVariant,\n  Button,\n  PageSection,\n} from \"@patternfly/react-core\";\nimport { FormProvider, useForm } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link, useNavigate } from \"react-router-dom\";\n\nimport { useAlerts } from \"../../components/alert/Alerts\";\nimport { FormAccess } from \"../../components/form-access/FormAccess\";\nimport { ViewHeader } from \"../../components/view-header/ViewHeader\";\nimport { useAdminClient } from \"../../context/auth/AdminClient\";\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\nimport { toAuthentication } from \"../routes/Authentication\";\nimport { toFlow } from \"../routes/Flow\";\nimport { FlowType } from \"./FlowType\";\nimport { NameDescription } from \"./NameDescription\";\n\nexport default function CreateFlow() {\n  const { t } = useTranslation(\"authentication\");\n  const navigate = useNavigate();\n  const { realm } = useRealm();\n  const { adminClient } = useAdminClient();\n  const { addAlert } = useAlerts();\n  const form = useForm<AuthenticationFlowRepresentation>();\n  const { handleSubmit } = form;\n\n  const onSubmit = async (formValues: AuthenticationFlowRepresentation) => {\n    const flow = { ...formValues, builtIn: false, topLevel: true };\n\n    try {\n      const { id } = await adminClient.authenticationManagement.createFlow(\n        flow\n      );\n      addAlert(t(\"flowCreatedSuccess\"), AlertVariant.success);\n      navigate(\n        toFlow({\n          realm,\n          id: id!,\n          usedBy: \"notInUse\",\n        })\n      );\n    } catch (error: any) {\n      addAlert(\n        t(\"flowCreateError\", {\n          error: error.response?.data?.errorMessage || error,\n        }),\n        AlertVariant.danger\n      );\n    }\n  };\n\n  return (\n    <>\n      <ViewHeader\n        titleKey=\"authentication:createFlow\"\n        subKey=\"authentication-help:createFlow\"\n      />\n      <PageSection variant=\"light\">\n        <FormProvider {...form}>\n          <FormAccess\n            isHorizontal\n            role=\"manage-authorization\"\n            onSubmit={handleSubmit(onSubmit)}\n          >\n            <NameDescription />\n            <FlowType />\n            <ActionGroup>\n              <Button data-testid=\"create\" type=\"submit\">\n                {t(\"common:create\")}\n              </Button>\n              <Button\n                data-testid=\"cancel\"\n                variant=\"link\"\n                component={(props) => (\n                  <Link {...props} to={toAuthentication({ realm })}></Link>\n                )}\n              >\n                {t(\"common:cancel\")}\n              </Button>\n            </ActionGroup>\n          </FormAccess>\n        </FormProvider>\n      </PageSection>\n    </>\n  );\n}\n"],"names":["TYPES","FlowType","useTranslation","control","useFormContext","open","setOpen","useState","jsx","FormGroup","HelpItem","Controller","field","Select","_","value","SelectVariant","type","SelectOption","CreateFlow","navigate","useNavigate","realm","useRealm","adminClient","useAdminClient","addAlert","useAlerts","form","useForm","handleSubmit","onSubmit","formValues","flow","id","AlertVariant","toFlow","error","jsxs","Fragment","ViewHeader","PageSection","FormProvider","FormAccess","NameDescription","ActionGroup","Button","props","Link","toAuthentication"],"mappings":"0pBAaA,MAAMA,EAAQ,CAAC,aAAc,aAAa,EAE7BC,EAAW,IAAM,CAC5B,KAAM,CAAE,CAAA,EAAMC,EAAe,gBAAgB,EACvC,CAAE,QAAAC,GAAYC,IACd,CAACC,EAAMC,CAAO,EAAIC,WAAS,EAAK,EAGpC,OAAAC,EAAA,IAACC,EAAA,CACC,MAAO,EAAE,UAAU,EACnB,UACED,EAAA,IAACE,EAAA,CACC,SAAU,EAAE,sCAAsC,EAClD,aAAa,yBAAA,CACf,EAEF,QAAQ,WAER,SAAAF,EAAA,IAACG,EAAA,CACC,KAAK,aACL,aAAcX,EAAM,CAAC,EACrB,QAAAG,EACA,OAAQ,CAAC,CAAE,MAAAS,CAAA,IACTJ,EAAA,IAACK,EAAA,CACC,SAAS,WACT,SAAUP,EACV,SAAU,CAACQ,EAAGC,IAAU,CAChBH,EAAA,SAASG,EAAM,SAAU,CAAA,EAC/BT,EAAQ,EAAK,CACf,EACA,WAAY,EAAE,uBAAuBM,EAAM,OAAO,EAClD,QAASI,EAAc,OACvB,aAAY,EAAE,UAAU,EACxB,OAAQX,EAEP,SAAAL,EAAM,IAAKiB,GACVT,EAAA,IAACU,EAAA,CAEC,SAAUD,IAASL,EAAM,MACzB,MAAOK,EAEN,SAAA,EAAE,uBAAuBA,GAAM,CAAA,EAJ3BA,CAAA,CAMR,CAAA,CACH,CAAA,CAEJ,CAAA,CAAA,CAGN,ECzCA,SAAwBE,GAAa,CACnC,KAAM,CAAE,CAAA,EAAMjB,EAAe,gBAAgB,EACvCkB,EAAWC,IACX,CAAE,MAAAC,GAAUC,IACZ,CAAE,YAAAC,GAAgBC,IAClB,CAAE,SAAAC,GAAaC,IACfC,EAAOC,IACP,CAAE,aAAAC,CAAiB,EAAAF,EAEnBG,EAAW,MAAOC,GAAiD,CACvE,MAAMC,EAAO,CAAE,GAAGD,EAAY,QAAS,GAAO,SAAU,IAEpD,GAAA,CACF,KAAM,CAAE,GAAAE,CAAO,EAAA,MAAMV,EAAY,yBAAyB,WACxDS,CAAA,EAEFP,EAAS,EAAE,oBAAoB,EAAGS,EAAa,OAAO,EACtDf,EACEgB,EAAO,CACL,MAAAd,EACA,GAAAY,EACA,OAAQ,UAAA,CACT,CAAA,QAEIG,GACPX,EACE,EAAE,kBAAmB,CACnB,MAAOW,EAAM,UAAU,MAAM,cAAgBA,CAAA,CAC9C,EACDF,EAAa,MAAA,CAEjB,CAAA,EAGF,OAEIG,EAAA,KAAAC,WAAA,CAAA,SAAA,CAAA/B,EAAA,IAACgC,EAAA,CACC,SAAS,4BACT,OAAO,gCAAA,CACT,QACCC,EAAY,CAAA,QAAQ,QACnB,SAACjC,EAAA,IAAAkC,EAAA,CAAc,GAAGd,EAChB,SAAAU,EAAA,KAACK,EAAA,CACC,aAAY,GACZ,KAAK,uBACL,SAAUb,EAAaC,CAAQ,EAE/B,SAAA,CAAAvB,EAAA,IAACoC,EAAgB,EAAA,QAChB3C,EAAS,EAAA,SACT4C,EACC,CAAA,SAAA,CAAArC,EAAAA,IAACsC,GAAO,cAAY,SAAS,KAAK,SAC/B,SAAA,EAAE,eAAe,EACpB,EACAtC,EAAA,IAACsC,EAAA,CACC,cAAY,SACZ,QAAQ,OACR,UAAYC,GACVvC,EAAA,IAACwC,EAAM,CAAA,GAAGD,EAAO,GAAIE,EAAiB,CAAE,MAAA3B,CAAM,CAAC,CAAG,CAAA,EAGnD,WAAE,eAAe,CAAA,CACpB,CAAA,EACF,CAAA,CAAA,GAEJ,CACF,CAAA,CACF,CAAA,CAAA,CAEJ"}