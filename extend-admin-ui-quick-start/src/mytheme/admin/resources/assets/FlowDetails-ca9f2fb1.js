import{_ as Ja,r as w,i as Ct,B as pe,k as tt,l as fg,m as es,u as Fe,d as Kt,n as yn,j as p,P as Pd,f as ur,F as xt,V as be,G as wt,C as Gs,T as hg,o as pg,e as ts,p as lr,g as qd,q as gg,s as mg,A as st,D as vg,v as yg,w as _t,x as bg,y as ns,c as xg,z as wg,b as _g,t as Eg,E as Us,H as Sg}from"./index-a3421f29.js";import{V as Cg}from"./ViewHeader-832ec56e.js";import{P as Ng,L as Mg}from"./PaginatingTableToolbar-08ca9efb.js";import{u as Ig,m as kg}from"./useLocaleSort-3efc7c31.js";import{D as $d,a as jd,b as Fd,c as Dd,d as Dt,e as Rg}from"./DataListItemRow-75e02946.js";import{C as Tg}from"./Card-aa3ba03c.js";import{C as Ag}from"./CardBody-519f6395.js";import{S as Ma,a as Ia,b as ka}from"./Select-0f56a9cc.js";import{D as Lg}from"./DynamicComponents-72877b30.js";import{K as Un}from"./KeycloakTextInput-e7f6e917.js";import{T as Od}from"./trash-icon-593b2b02.js";import{M as bn,a as xn}from"./Modal-21c37af7.js";import{F as wn,A as Pg}from"./Form-518a2cf2.js";import{P as zd}from"./plus-icon-2a767bad.js";import{K as qg}from"./KeycloakTextArea-1b518857.js";import{u as Ra}from"./useToggle-a9cb2c55.js";import{P as $g,r as At,_ as Bd,a as Hd,s as jg,b as Fg,c as _n,d as Dg,e as Vd,f as Og,g as Gd,h as zg,i as Ud,j as Bg,k as Hg}from"./KeycloakDataTable-10a62d94.js";import{D as Vg}from"./DataListControl-d3367bab.js";import{s as Rr}from"./data-list-7d55714c.js";import{T as Gg,a as Ug}from"./Text-564bf299.js";import{_ as dr,k as En,a as Yd,b as Kd,c as rs,d as Yg,i as fr,e as Xd,f as is,g as Wd,r as os,h as Kg,j as Xg,l as Wg,m as as,n as Sn,o as xe,p as Zd,q as Cn,s as Nn,t as Qd,u as Zg,v as ss,w as Jd,x as Qg,y as Jg,z as ef,A as em,B as tf,C as cs,D as tm,E as nf,F as nm,G as us,H as rm,I as im,J as om,K as am,L as sm,M as cm}from"./Td-6d4ab209.js";import{u as Ys}from"./ConfirmDialog-09ff7a12.js";import{B as um,D as lm}from"./AuthenticationSection-d711df15.js";import{N as dm}from"./NameDescription-49e50e8d.js";import{T as Ks}from"./Trans-2fec9e72.js";import{T as fm,a as hm,b as Tr}from"./ToolbarContent-7b435752.js";import{R as pm}from"./Radio-e3ba1ffb.js";import{F as Xs,a as Ws}from"./FlexItem-65b5f999.js";import"./plus-circle-icon-cb854796.js";import"./EmptyStateBody-7b4fcee1.js";import"./EmptyStateSecondaryActions-08edafb5.js";import"./TableToolbar-ee0c86ef.js";import"./grip-vertical-icon-cbeff50f.js";import"./check-fc57dbe1.js";import"./star-icon-6a7e7d25.js";import"./ClientSelect-3f0fc581.js";import"./FileUpload-ca37c1a6.js";import"./CodeEditor-2fb93648.js";import"./copy-icon-a4fe01af.js";import"./GroupPickerDialog-caf8c38d.js";import"./ActionListItem-ab1a4322.js";import"./minus-circle-icon-6f9a971c.js";import"./MultiLineInput-14187d1c.js";import"./PasswordInput-85f9399f.js";import"./AddRoleMappingModal-abb19beb.js";import"./resource-08ae7dbc.js";import"./joinPath-55fd24bc.js";import"./filter-icon-9d72dc58.js";import"./Checkbox-d00621d8.js";import"./RoutableTabs-7f56b0c5.js";import"./Tabs-5beaba80.js";import"./MenuList-e3786b59.js";import"./FormAccess-1cceaef6.js";import"./GridItem-d34dae2e.js";import"./TimeSelector-a2bc30e2.js";import"./NumberInput-85f36a0d.js";import"./minus-icon-16876c86.js";import"./question-circle-icon-45a94074.js";import"./DraggableTable-40ed6015.js";const rf=e=>{var{className:t="",isExpanded:n=!1,"aria-controls":r="","aria-label":i="Details",rowid:o="",id:a,buttonProps:s}=e,c=Ja(e,["className","isExpanded","aria-controls","aria-label","rowid","id","buttonProps"]);return w.createElement("div",Object.assign({className:Ct(Rr.dataListItemControl,t)},c),w.createElement("div",{className:Ct(Rr.dataListToggle)},w.createElement(pe,Object.assign({id:a,variant:tt.plain,"aria-controls":r!==""&&r,"aria-label":i,"aria-labelledby":i!=="Details"?null:`${o} ${a}`,"aria-expanded":n},s),w.createElement("div",{className:Ct(Rr.dataListToggleIcon)},w.createElement(fg,null)))))};rf.displayName="DataListToggle";const Nt={modifiers:{compact:"pf-m-compact",selected:"pf-m-selected",disabled:"pf-m-disabled"},themeDark:"pf-theme-dark",toggleGroup:"pf-c-toggle-group",toggleGroupButton:"pf-c-toggle-group__button",toggleGroupIcon:"pf-c-toggle-group__icon",toggleGroupItem:"pf-c-toggle-group__item",toggleGroupText:"pf-c-toggle-group__text"};var Yn;(function(e){e.icon="icon",e.text="text"})(Yn||(Yn={}));const Ta=({variant:e,children:t})=>w.createElement("span",{className:Ct(e==="icon"&&Nt.toggleGroupIcon,e==="text"&&Nt.toggleGroupText)},t);Ta.displayName="ToggleGroupItemElement";const Kn=e=>{var{text:t,icon:n,className:r,isDisabled:i=!1,isSelected:o=!1,"aria-label":a="",onChange:s=()=>{},buttonId:c=""}=e,l=Ja(e,["text","icon","className","isDisabled","isSelected","aria-label","onChange","buttonId"]);const u=d=>{s(!o,d)};return!a&&n&&!t&&console.warn("An accessible aria-label is required when using the toggle group item icon variant."),w.createElement("div",Object.assign({className:Ct(Nt.toggleGroupItem,r)},l),w.createElement("button",Object.assign({type:"button",className:Ct(Nt.toggleGroupButton,o&&Nt.modifiers.selected),"aria-pressed":o,onClick:u},a&&{"aria-label":a},i&&{disabled:!0},c&&{id:c}),n?w.createElement(Ta,{variant:Yn.icon},n):null,t?w.createElement(Ta,{variant:Yn.text},t):null))};Kn.displayName="ToggleGroupItem";const of=e=>{var{className:t,children:n,isCompact:r=!1,areAllGroupsDisabled:i=!1,"aria-label":o}=e,a=Ja(e,["className","children","isCompact","areAllGroupsDisabled","aria-label"]);const s=w.Children.map(n,c=>c.type.name!==Kn.name?c:w.cloneElement(c,i?{isDisabled:!0}:{}));return w.createElement("div",Object.assign({className:Ct(Nt.toggleGroup,r&&Nt.modifiers.compact,t),role:"group","aria-label":o},a),s)};of.displayName="ToggleGroup";const gm={name:"CogIcon",height:512,width:512,svgPath:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z",yOffset:0,xOffset:0},mm=es(gm),vm={name:"DomainIcon",height:1024,width:1024,svgPath:"M544,511.9 C561.476067,511.948945 575.664266,525.962873 575.994253,543.371439 L576,543.9 L576,991.9 C575.951055,1009.37607 561.937127,1023.56427 544.528561,1023.89425 L544,1023.9 L352,1023.9 C334.523933,1023.85105 320.335734,1009.83713 320.005747,992.428561 L320,991.9 L320,543.9 C320.048945,526.423933 334.062873,512.235734 351.471439,511.905747 L352,511.9 L544,511.9 Z M704,576 L704,960 L640,960 L640,576 L704,576 Z M512,896 L384,896 L384,960 L512,960 L512,896 Z M960,513.1 L960,513.2 C960,665.4 884.1,799.9 768,880.9 L768,880.9 L768,799.4 C773.3,794.6 778.4,789.8 783.5,784.7 C855.624209,712.728348 896.108133,614.991161 896,513.1 L896,513.1 L960,513.1 Z M149.8,385 C100.714385,524.561202 135.973879,679.905126 240.5,784.6 C245.5,789.7 250.7,794.6 256,799.3 L256,799.3 L256,880.8 C139.9,799.8 63.9999013,665.3 63.9999013,513.1 C63.9712238,469.725105 70.236499,426.575548 82.6,385 L82.6,385 Z M512.1,704 L384,704 L384,832 L512.1,832 L512.1,704 Z M512,576 L448,576 L448,640 L512,640 L512,576 Z M864,-1.13686838e-13 C881.496381,-1.13686838e-13 895.713128,14.0417829 895.995713,31.4708215 L896,32 L896,406 C896,423.496381 881.958217,437.713128 864.529179,437.995713 L864,438 L608,438 C590.503619,438 576.286872,423.958217 576.004287,406.529179 L576,406 L576,32 C576,14.5036191 590.041783,0.286872383 607.470821,0.00428708574 L608,-1.13686838e-13 L864,-1.13686838e-13 Z M1024,64 L1024,384 L960,384 L960,64 L1024,64 Z M832,256 L640,256 L640,352 L832,352 L832,256 Z M224,-5.68434189e-14 C241.476067,0.0489452394 255.664266,14.0628726 255.994253,31.4714395 L256,32 L256,288 C255.951055,305.476067 241.937127,319.664266 224.528561,319.994253 L224,320 L32,320 C14.5239331,319.951055 0.335734448,305.937127 0.00574685353,288.528561 L0,288 L0,32 C0.0489452394,14.5239331 14.0628726,0.335734448 31.4714395,0.00574685353 L32,-5.68434189e-14 L224,-5.68434189e-14 Z M192,192 L64,192 L64,256 L192,256 L192,192 Z M512,65 L512,129 C460.642759,128.90985 409.795141,139.181409 362.5,159.2 C347.917219,165.399771 333.724426,172.47947 320,180.4 L320,180.4 L320,108.2 C380.012207,79.7623165 445.590913,65.0071076 512,65 L512,65 Z M832,64 L736,64 L736,160 L832,160 L832,64 Z M192,64 L128,64 L128,128 L192,128 L192,64 Z",yOffset:0,xOffset:0},ym=es(vm),bm={name:"TableIcon",height:512,width:512,svgPath:"M464 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM224 416H64v-96h160v96zm0-160H64v-96h160v96zm224 160H288v-96h160v96zm0-160H288v-96h160v96z",yOffset:0,xOffset:0},xm=es(bm),wm=({list:e,setValue:t})=>p.jsx(Pd,{variant:"light",className:"pf-u-py-lg",children:p.jsx(wn,{isHorizontal:!0,children:e?.map(n=>p.jsx(pm,{id:n.id,name:"provider",label:n.displayName,"data-testid":n.id,description:n.description,onChange:()=>{t(n)}},n.id))})}),ls=({name:e,type:t,onSelect:n})=>{const{t:r}=Fe("authentication"),{adminClient:i}=Kt(),[o,a]=w.useState(),[s,c]=w.useState(),[l,u]=w.useState(10),[d,f]=w.useState(0),[h,g]=w.useState(""),m=Ig();yn(async()=>{switch(t){case"client":return i.authenticationManagement.getClientAuthenticatorProviders();case"form":return i.authenticationManagement.getFormActionProviders();case"condition":return(await i.authenticationManagement.getAuthenticatorProviders()).filter(Qa);case"basic":default:return(await i.authenticationManagement.getAuthenticatorProviders()).filter(_=>!Qa(_))}},y=>c(y),[]);const v=w.useMemo(()=>m(s??[],kg("displayName")).filter(y=>y.displayName?.includes(h)||y.description?.includes(h)).slice(d,d+l+1),[s,h,d,l]);return p.jsx(bn,{variant:xn.medium,isOpen:!0,title:r("addStepTo",{name:e}),onClose:()=>n(),actions:[p.jsx(pe,{id:"modal-add","data-testid":"modal-add",onClick:()=>n(o),children:r("common:add")},"add"),p.jsx(pe,{"data-testid":"cancel",id:"modal-cancel",variant:tt.link,onClick:()=>{n()},children:r("common:cancel")},"cancel")],children:s&&p.jsx(Ng,{count:v.length||0,first:d,max:l,onNextClick:f,onPreviousClick:f,onPerPageSelect:(y,_)=>{f(y),u(_)},inputGroupName:"search",inputGroupPlaceholder:r("common:search"),inputGroupOnEnter:g,children:p.jsx(wm,{list:v.slice(0,l),setValue:a})})})},Zs=["basic-flow","form-flow"],ds=({name:e,onConfirm:t,onCancel:n})=>{const{t:r}=Fe("authentication"),{register:i,control:o,setValue:a,handleSubmit:s,formState:{errors:c}}=ur(),[l,u]=w.useState(!1),[d,f]=w.useState(!1),[h,g]=w.useState(),{adminClient:m}=Kt();return yn(()=>m.authenticationManagement.getFormProviders(),g,[]),w.useEffect(()=>{h?.length===1&&a("provider",h[0].id)},[h]),p.jsx(bn,{variant:xn.medium,title:r("addStepTo",{name:e}),onClose:n,actions:[p.jsx(pe,{"data-testid":"modal-add",type:"submit",form:"sub-flow-form",children:r("common:add")},"add"),p.jsx(pe,{"data-testid":"cancel",variant:tt.link,onClick:n,children:r("common:cancel")},"cancel")],isOpen:!0,children:p.jsxs(wn,{id:"sub-flow-form",onSubmit:s(t),isHorizontal:!0,children:[p.jsx(xt,{label:r("common:name"),fieldId:"name",helperTextInvalid:r("common:required"),validated:c.name?be.error:be.default,labelIcon:p.jsx(wt,{helpText:r("authentication-help:name"),fieldLabelId:"name"}),isRequired:!0,children:p.jsx(Un,{id:"name","data-testid":"name",validated:c.name?be.error:be.default,...i("name",{required:!0})})}),p.jsx(xt,{label:r("common:description"),fieldId:"description",labelIcon:p.jsx(wt,{helpText:r("authentication-help:description"),fieldLabelId:"description"}),children:p.jsx(Un,{id:"description","data-testid":"description",...i("description")})}),p.jsx(xt,{label:r("flowType"),fieldId:"flowType",labelIcon:p.jsx(wt,{helpText:r("authentication-help:flowType"),fieldLabelId:"authentication:flowType"}),children:p.jsx(Gs,{name:"type",defaultValue:Zs[0],control:o,render:({field:v})=>p.jsx(Ma,{menuAppendTo:"parent",toggleId:"flowType",onToggle:u,onSelect:(y,_)=>{v.onChange(_.toString()),u(!1)},selections:r(`flow-type.${v.value}`),variant:Ia.single,isOpen:l,children:Zs.map(y=>p.jsx(ka,{value:y,selected:y===v.value,children:r(`flow-type.${y}`)},y))})})}),h&&h.length>1&&p.jsx(xt,{label:r("flowType"),labelIcon:p.jsx(wt,{helpText:r("authentication-help:flowType"),fieldLabelId:"authentication:flowType"}),fieldId:"flowType",children:p.jsx(Gs,{name:"provider",defaultValue:"",control:o,render:({field:v})=>p.jsx(Ma,{menuAppendTo:"parent",toggleId:"provider",onToggle:f,onSelect:(y,_)=>{v.onChange(_.toString()),f(!1)},selections:v.value,variant:Ia.single,isOpen:d,children:h.map(y=>p.jsx(ka,{value:y.id,selected:y.displayName===v.value,children:y.displayName},y.id))})})})]})})};const _m=["addExecution","addSubFlow"],Em=({flow:e,onAddExecution:t,onAddFlow:n})=>{const{t:r}=Fe("authentication"),[i,o]=w.useState();return p.jsxs(p.Fragment,{children:[i==="addExecution"&&p.jsx(ls,{name:e.alias,type:e.providerId==="client-flow"?"client":"basic",onSelect:a=>{a&&t(a),o(void 0)}}),i==="addSubFlow"&&p.jsx(ds,{name:e.alias,onCancel:()=>o(void 0),onConfirm:a=>{n(a),o(void 0)}}),p.jsx(Mg,{message:r("emptyExecution"),instructions:r("emptyExecutionInstructions")}),p.jsx("div",{className:"keycloak__empty-execution-state__block",children:_m.map(a=>p.jsxs(Xs,{className:"keycloak__empty-execution-state__help",children:[p.jsxs(Ws,{flex:{default:"flex_1"},children:[p.jsx(hg,{headingLevel:"h2",size:pg.md,children:r(`${a}Title`)}),p.jsx("p",{children:r(`authentication-help:${a}`)})]}),p.jsx(Xs,{alignSelf:{default:"alignSelfCenter"},children:p.jsx(Ws,{children:p.jsx(pe,{"data-testid":a,variant:"tertiary",onClick:()=>o(a),children:r(a)})})})]},a))})]})};const Sm=()=>{const{t:e}=Fe("authentication");return p.jsx($d,{"aria-labelledby":"headerName",id:"header",children:p.jsxs(jd,{children:[p.jsx(Fd,{className:"keycloak__authentication__header-drag-button","aria-label":e("common:disabled")}),p.jsx(Dd,{className:"keycloak__authentication__header",dataListCells:[p.jsx(Dt,{id:"headerName",children:e("steps")},"step"),p.jsx(Dt,{children:e("requirement")},"requirement"),p.jsx(Dt,{},"config")]})]})})};const Cm=({id:e,title:t})=>p.jsx(Tg,{"data-testid":t,className:"keycloak__authentication__title",isFlat:!0,children:p.jsx(Ag,{"data-id":e,id:`title-id-${e}`,children:t})}),Nm=({flow:e,onChange:t})=>{const{t:n}=Fe("authentication"),[r,i]=w.useState(!1),o=e.requirementChoices.map((a,s)=>p.jsx(ka,{value:a,children:n(`requirements.${a}`)},s));return p.jsxs(p.Fragment,{children:[e.requirementChoices&&e.requirementChoices.length>1&&p.jsx(Ma,{className:"keycloak__authentication__requirement-dropdown",variant:Ia.single,onToggle:i,onSelect:(a,s)=>{e.requirement=s.toString(),t(e),i(!1)},selections:[e.requirement],isOpen:r,children:o}),(!e.requirementChoices||e.requirementChoices.length<=1)&&p.jsx(p.Fragment,{children:n(`requirements.${e.requirement}`)})]})},Mm=({execution:e})=>{const{t}=Fe("authentication"),{adminClient:n}=Kt(),{addAlert:r,addError:i}=ts(),[o,a]=w.useState(!1),[s,c]=w.useState(),[l,u]=w.useState(),d=ur(),{register:f,setValue:h,handleSubmit:g,formState:{errors:m}}=d,v=_=>{gg(_||{},h)};yn(async()=>{const _=await n.authenticationManagement.getConfigDescription({providerId:e.providerId});let C;return e.authenticationConfig&&(C=await n.authenticationManagement.getConfig({id:e.authenticationConfig})),{configDescription:_,config:C}},({configDescription:_,config:C})=>{u(_),c(C)},[]),w.useEffect(()=>{s&&v(s)},[s]);const y=async _=>{const C=mg(_);try{if(s){const x={id:s.id,alias:s.alias,config:C.config};await n.authenticationManagement.updateConfig(x),c({...x})}else{const x={id:e.id,alias:C.alias,config:C.config},{id:M}=await n.authenticationManagement.createConfig(x);c({...x.config,id:M,alias:x.alias})}r(t("configSaveSuccess"),st.success),a(!1)}catch(x){i("authentication:configSaveError",x)}};return p.jsxs(p.Fragment,{children:[p.jsx(lr,{content:t("common:settings"),children:p.jsx(pe,{variant:"plain","aria-label":t("common:settings"),onClick:()=>a(!0),children:p.jsx(mm,{})})}),l&&p.jsx(bn,{variant:xn.small,isOpen:o,title:t("executionConfig",{name:l.name}),onClose:()=>a(!1),children:p.jsxs(wn,{id:"execution-config-form",onSubmit:g(y),children:[p.jsx(xt,{label:t("alias"),fieldId:"alias",helperTextInvalid:t("common:required"),validated:m.alias?be.error:be.default,isRequired:!0,labelIcon:p.jsx(wt,{helpText:t("authentication-help:alias"),fieldLabelId:"authentication:alias"}),children:p.jsx(Un,{isReadOnly:!!s,id:"alias","data-testid":"alias",validated:m.alias?be.error:be.default,...f("alias",{required:!0})})}),p.jsx(qd,{...d,children:p.jsx(Lg,{properties:l.properties||[]})}),p.jsxs(Pg,{children:[p.jsx(pe,{"data-testid":"save",variant:"primary",type:"submit",children:t("common:save")}),p.jsx(pe,{"data-testid":"cancel",variant:tt.link,onClick:()=>{a(!1)},children:t("common:cancel")}),s&&p.jsxs(pe,{className:"pf-u-ml-4xl","data-testid":"clear",variant:tt.link,onClick:async()=>{await n.authenticationManagement.delConfig({id:s.id}),c(void 0),a(!1)},children:[t("common:clear")," ",p.jsx(Od,{})]})]})]})})]})},Im=({execution:e,onAddExecution:t,onAddFlow:n})=>{const{t:r}=Fe("authentication"),{adminClient:i}=Kt(),[o,a]=w.useState(!1),[s,c]=w.useState(),[l,u]=w.useState();return yn(()=>i.authenticationManagement.getFlow({flowId:e.flowId}),({providerId:d})=>u(d),[]),p.jsx(lr,{content:r("common:add"),children:p.jsxs(p.Fragment,{children:[p.jsx(vg,{isPlain:!0,position:"right","data-testid":`${e.displayName}-edit-dropdown`,isOpen:o,toggle:p.jsx(yg,{onToggle:a,"aria-label":r("common:add"),children:p.jsx(zd,{})}),dropdownItems:[p.jsx(_t,{onClick:()=>c(l==="form-flow"?"form":"basic"),children:r("addStep")},"addStep"),p.jsx(_t,{onClick:()=>c("condition"),children:r("addCondition")},"addCondition"),p.jsx(_t,{onClick:()=>c("subFlow"),children:r("addSubFlow")},"addSubFlow")],onSelect:()=>a(!1)}),s&&s!=="subFlow"&&p.jsx(ls,{name:e.displayName,type:s,onSelect:d=>{d&&t(e,d),c(void 0)}}),s==="subFlow"&&p.jsx(ds,{name:e.displayName,onCancel:()=>c(void 0),onConfirm:d=>{n(e,d),c(void 0)}})]})})},km=({execution:e,onRowChange:t})=>{const{t:n}=Fe("authentication"),{register:r,reset:i,handleSubmit:o,formState:{errors:a,isValid:s}}=ur({mode:"onChange",defaultValues:e}),[c,l]=Ra();w.useEffect(()=>i(e),[e]);const u=d=>{t({...e,...d}),l()};return p.jsxs(p.Fragment,{children:[p.jsx(lr,{content:n("common:edit"),children:p.jsx(pe,{variant:"plain","data-testid":`${e.id}-edit`,"aria-label":n("common:edit"),onClick:l,children:p.jsx($g,{})})}),c&&p.jsx(bn,{title:n("editFlow"),onClose:l,variant:xn.small,actions:[p.jsx(pe,{"data-testid":"confirm",type:"submit",form:"edit-flow-form",isDisabled:!s,children:n("edit")},"confirm"),p.jsx(pe,{"data-testid":"cancel",variant:tt.link,onClick:l,children:n("common:cancel")},"cancel")],isOpen:!0,children:p.jsxs(wn,{id:"edit-flow-form",onSubmit:o(u),isHorizontal:!0,children:[p.jsx(xt,{label:n("common:name"),fieldId:"name",helperTextInvalid:n("common:required"),validated:a.displayName?be.error:be.default,labelIcon:p.jsx(wt,{helpText:n("authentication-help:name"),fieldLabelId:"name"}),isRequired:!0,children:p.jsx(Un,{id:"name","data-testid":"displayName",validated:a.displayName?be.error:be.default,...r("displayName",{required:!0}),isRequired:!0})}),p.jsx(xt,{label:n("common:description"),fieldId:"kc-description",labelIcon:p.jsx(wt,{helpText:n("authentication-help:description"),fieldLabelId:"description"}),validated:a.description?be.error:be.default,helperTextInvalid:a.description?.message,children:p.jsx(qg,{id:"kc-description","data-testid":"description",validated:a.description?be.error:be.default,...r("description",{maxLength:{value:255,message:n("common:maxLength",{length:255})}})})})]})})]})};const af=({builtIn:e,execution:t,onRowClick:n,onRowChange:r,onAddExecution:i,onAddFlow:o,onDelete:a})=>{const{t:s}=Fe("authentication"),c=!!t.executionList?.length;return p.jsxs(p.Fragment,{children:[p.jsx($d,{className:"keycloak__authentication__flow-item",id:t.id,isExpanded:!t.isCollapsed,"aria-labelledby":`title-id-${t.id}`,children:p.jsxs(jd,{className:"keycloak__authentication__flow-row","aria-level":t.level+1,role:"heading","aria-labelledby":t.id,children:[p.jsx(Vg,{children:p.jsx(Fd,{"aria-label":s("common-help:dragHelp")})}),c&&p.jsx(rf,{onClick:()=>n(t),isExpanded:!t.isCollapsed,id:`toggle1-${t.id}`,"aria-controls":t.executionList[0].id}),p.jsx(Dd,{dataListCells:[p.jsxs(Dt,{children:[!t.authenticationFlow&&p.jsx(Cm,{id:t.id,title:t.displayName},t.id),t.authenticationFlow&&p.jsxs(p.Fragment,{children:[t.displayName," ",p.jsx("br",{})," ",p.jsx(Gg,{component:Ug.small,children:t.description})]})]},`${t.id}-name`),p.jsx(Dt,{children:p.jsx(Nm,{flow:t,onChange:r})},`${t.id}-requirement`),p.jsxs(Dt,{children:[t.configurable&&p.jsx(Mm,{execution:t}),t.authenticationFlow&&!e&&p.jsxs(p.Fragment,{children:[p.jsx(Im,{execution:t,onAddExecution:i,onAddFlow:o}),p.jsx(km,{execution:t,onRowChange:r})]}),!e&&p.jsx(lr,{content:s("common:delete"),children:p.jsx(pe,{variant:"plain","data-testid":`${t.displayName}-delete`,"aria-label":s("common:delete"),onClick:()=>a(t),children:p.jsx(Od,{})})})]},`${t.id}-config`)]})]})}),!t.isCollapsed&&c&&t.executionList?.map(l=>p.jsx(af,{builtIn:e,execution:l,onRowClick:n,onRowChange:r,onAddExecution:i,onAddFlow:o,onDelete:a},l.id))]})};class sf{oldIndex;newIndex;constructor(t,n){this.oldIndex=t,this.newIndex=n}}class Qs extends sf{parent;constructor(t,n,r){super(t,n),this.parent=r}}class fs{list;expandableList;constructor(t){this.list=t;const n={executionList:[],isCollapsed:!1};this.transformToExpandableList(0,-1,n),this.expandableList=n.executionList}transformToExpandableList(t,n,r){for(let i=t;i<this.list.length;i++){const o=this.list[i],a=o.level||0;if(a<=n)return i-1;const s=this.list[i+1]?.level||0;if(a<s){const l={...o,executionList:[],isCollapsed:!1};i=this.transformToExpandableList(i+1,a,l),r.executionList?.push(l)}else r.executionList?.push(o)}return this.list.length}order(t){let n=[];for(const r of t||this.expandableList)n.push(r),r.executionList&&!r.isCollapsed&&(n=n.concat(this.order(r.executionList)));return n}findExecution(t,n){let r=(n||this.expandableList).find(i=>i.id===t);if(!r){for(const i of n||this.expandableList)if(i.executionList&&(r=this.findExecution(t,i.executionList),r))return r}return r}getParentNodes(t){for(let n=0;n<this.list.length;n++){const r=this.list[n];if(n+1<this.list.length&&this.list[n+1].level>r.level&&r.level+1===t)return r}}getChange(t,n){const r=this.order(),i=n.findIndex(s=>s===t.id),o=r[r.findIndex(s=>s.id===t.id)],a=r[i];if(a.level!==o.level){if(a.level>0){const s=this.getParentNodes(a.level);return new Qs(s?.executionList?.length||0,a.index,s)}return new Qs(this.expandableList.length,a.index)}return new sf(o.index,a.index)}clone(){const t=new fs([]);return t.list=this.list,t.expandableList=this.expandableList,t}}function ve(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ve(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const Js=e=>{let t;const n=new Set,r=(c,l)=>{const u=typeof c=="function"?c(t):c;if(!Object.is(u,t)){const d=t;t=l??typeof u!="object"?u:Object.assign({},t,u),n.forEach(f=>f(t,d))}},i=()=>t,s={setState:r,getState:i,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"production")!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}};return t=e(r,i,s),s},Rm=e=>e?Js(e):Js;var Aa={},Tm={get exports(){return Aa},set exports(e){Aa=e}},cf={},La={},Am={get exports(){return La},set exports(e){La=e}},uf={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vt=w;function Lm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Pm=typeof Object.is=="function"?Object.is:Lm,qm=Vt.useState,$m=Vt.useEffect,jm=Vt.useLayoutEffect,Fm=Vt.useDebugValue;function Dm(e,t){var n=t(),r=qm({inst:{value:n,getSnapshot:t}}),i=r[0].inst,o=r[1];return jm(function(){i.value=n,i.getSnapshot=t,Ar(i)&&o({inst:i})},[e,n,t]),$m(function(){return Ar(i)&&o({inst:i}),e(function(){Ar(i)&&o({inst:i})})},[e]),Fm(n),n}function Ar(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Pm(e,n)}catch{return!0}}function Om(e,t){return t()}var zm=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Om:Dm;uf.useSyncExternalStore=Vt.useSyncExternalStore!==void 0?Vt.useSyncExternalStore:zm;(function(e){e.exports=uf})(Am);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hr=w,Bm=La;function Hm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Vm=typeof Object.is=="function"?Object.is:Hm,Gm=Bm.useSyncExternalStore,Um=hr.useRef,Ym=hr.useEffect,Km=hr.useMemo,Xm=hr.useDebugValue;cf.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var o=Um(null);if(o.current===null){var a={hasValue:!1,value:null};o.current=a}else a=o.current;o=Km(function(){function c(h){if(!l){if(l=!0,u=h,h=r(h),i!==void 0&&a.hasValue){var g=a.value;if(i(g,h))return d=g}return d=h}if(g=d,Vm(u,h))return g;var m=r(h);return i!==void 0&&i(g,m)?g:(u=h,d=m)}var l=!1,u,d,f=n===void 0?null:n;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,n,r,i]);var s=Gm(e,o[0],o[1]);return Ym(function(){a.hasValue=!0,a.value=s},[s]),Xm(s),s};(function(e){e.exports=cf})(Tm);const Wm=bg(Aa),{useSyncExternalStoreWithSelector:Zm}=Wm;function Qm(e,t=e.getState,n){const r=Zm(e.subscribe,e.getState,e.getServerState||e.getState,t,n);return w.useDebugValue(r),r}function _e(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,i]of e)if(!Object.is(i,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}var Jm={value:()=>{}};function pr(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Bn(n)}function Bn(e){this._=e}function ev(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Bn.prototype=pr.prototype={constructor:Bn,on:function(e,t){var n=this._,r=ev(e+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(e=r[o]).type)&&(i=tv(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(i=(e=r[o]).type)n[i]=ec(n[i],e.name,t);else if(t==null)for(i in n)n[i]=ec(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Bn(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function tv(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function ec(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Jm,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Pa="http://www.w3.org/1999/xhtml";const tc={svg:"http://www.w3.org/2000/svg",xhtml:Pa,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function gr(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),tc.hasOwnProperty(t)?{space:tc[t],local:e}:e}function nv(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Pa&&t.documentElement.namespaceURI===Pa?t.createElement(e):t.createElementNS(n,e)}}function rv(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function lf(e){var t=gr(e);return(t.local?rv:nv)(t)}function iv(){}function hs(e){return e==null?iv:function(){return this.querySelector(e)}}function ov(e){typeof e!="function"&&(e=hs(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=new Array(a),c,l,u=0;u<a;++u)(c=o[u])&&(l=e.call(c,c.__data__,u,o))&&("__data__"in c&&(l.__data__=c.__data__),s[u]=l);return new ke(r,this._parents)}function av(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function sv(){return[]}function df(e){return e==null?sv:function(){return this.querySelectorAll(e)}}function cv(e){return function(){return av(e.apply(this,arguments))}}function uv(e){typeof e=="function"?e=cv(e):e=df(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a=t[o],s=a.length,c,l=0;l<s;++l)(c=a[l])&&(r.push(e.call(c,c.__data__,l,a)),i.push(c));return new ke(r,i)}function ff(e){return function(){return this.matches(e)}}function hf(e){return function(t){return t.matches(e)}}var lv=Array.prototype.find;function dv(e){return function(){return lv.call(this.children,e)}}function fv(){return this.firstElementChild}function hv(e){return this.select(e==null?fv:dv(typeof e=="function"?e:hf(e)))}var pv=Array.prototype.filter;function gv(){return Array.from(this.children)}function mv(e){return function(){return pv.call(this.children,e)}}function vv(e){return this.selectAll(e==null?gv:mv(typeof e=="function"?e:hf(e)))}function yv(e){typeof e!="function"&&(e=ff(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],c,l=0;l<a;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new ke(r,this._parents)}function pf(e){return new Array(e.length)}function bv(){return new ke(this._enter||this._groups.map(pf),this._parents)}function Xn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Xn.prototype={constructor:Xn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function xv(e){return function(){return e}}function wv(e,t,n,r,i,o){for(var a=0,s,c=t.length,l=o.length;a<l;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new Xn(e,o[a]);for(;a<c;++a)(s=t[a])&&(i[a]=s)}function _v(e,t,n,r,i,o,a){var s,c,l=new Map,u=t.length,d=o.length,f=new Array(u),h;for(s=0;s<u;++s)(c=t[s])&&(f[s]=h=a.call(c,c.__data__,s,t)+"",l.has(h)?i[s]=c:l.set(h,c));for(s=0;s<d;++s)h=a.call(e,o[s],s,o)+"",(c=l.get(h))?(r[s]=c,c.__data__=o[s],l.delete(h)):n[s]=new Xn(e,o[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(f[s])===c&&(i[s]=c)}function Ev(e){return e.__data__}function Sv(e,t){if(!arguments.length)return Array.from(this,Ev);var n=t?_v:wv,r=this._parents,i=this._groups;typeof e!="function"&&(e=xv(e));for(var o=i.length,a=new Array(o),s=new Array(o),c=new Array(o),l=0;l<o;++l){var u=r[l],d=i[l],f=d.length,h=Cv(e.call(u,u&&u.__data__,l,r)),g=h.length,m=s[l]=new Array(g),v=a[l]=new Array(g),y=c[l]=new Array(f);n(u,d,m,v,y,h,t);for(var _=0,C=0,x,M;_<g;++_)if(x=m[_]){for(_>=C&&(C=_+1);!(M=v[C])&&++C<g;);x._next=M||null}}return a=new ke(a,r),a._enter=s,a._exit=c,a}function Cv(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Nv(){return new ke(this._exit||this._groups.map(pf),this._parents)}function Mv(e,t,n){var r=this.enter(),i=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Iv(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),c=0;c<a;++c)for(var l=n[c],u=r[c],d=l.length,f=s[c]=new Array(d),h,g=0;g<d;++g)(h=l[g]||u[g])&&(f[g]=h);for(;c<i;++c)s[c]=n[c];return new ke(s,this._parents)}function kv(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function Rv(e){e||(e=Tv);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,c=i[o]=new Array(s),l,u=0;u<s;++u)(l=a[u])&&(c[u]=l);c.sort(t)}return new ke(i,this._parents).order()}function Tv(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Av(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Lv(){return Array.from(this)}function Pv(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function qv(){let e=0;for(const t of this)++e;return e}function $v(){return!this.node()}function jv(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&e.call(s,s.__data__,o,i);return this}function Fv(e){return function(){this.removeAttribute(e)}}function Dv(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ov(e,t){return function(){this.setAttribute(e,t)}}function zv(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Bv(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Hv(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Vv(e,t){var n=gr(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Dv:Fv:typeof t=="function"?n.local?Hv:Bv:n.local?zv:Ov)(n,t))}function gf(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Gv(e){return function(){this.style.removeProperty(e)}}function Uv(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Yv(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Kv(e,t,n){return arguments.length>1?this.each((t==null?Gv:typeof t=="function"?Yv:Uv)(e,t,n??"")):Gt(this.node(),e)}function Gt(e,t){return e.style.getPropertyValue(t)||gf(e).getComputedStyle(e,null).getPropertyValue(t)}function Xv(e){return function(){delete this[e]}}function Wv(e,t){return function(){this[e]=t}}function Zv(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Qv(e,t){return arguments.length>1?this.each((t==null?Xv:typeof t=="function"?Zv:Wv)(e,t)):this.node()[e]}function mf(e){return e.trim().split(/^|\s+/)}function ps(e){return e.classList||new vf(e)}function vf(e){this._node=e,this._names=mf(e.getAttribute("class")||"")}vf.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function yf(e,t){for(var n=ps(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function bf(e,t){for(var n=ps(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Jv(e){return function(){yf(this,e)}}function e0(e){return function(){bf(this,e)}}function t0(e,t){return function(){(t.apply(this,arguments)?yf:bf)(this,e)}}function n0(e,t){var n=mf(e+"");if(arguments.length<2){for(var r=ps(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?t0:t?Jv:e0)(n,t))}function r0(){this.textContent=""}function i0(e){return function(){this.textContent=e}}function o0(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function a0(e){return arguments.length?this.each(e==null?r0:(typeof e=="function"?o0:i0)(e)):this.node().textContent}function s0(){this.innerHTML=""}function c0(e){return function(){this.innerHTML=e}}function u0(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function l0(e){return arguments.length?this.each(e==null?s0:(typeof e=="function"?u0:c0)(e)):this.node().innerHTML}function d0(){this.nextSibling&&this.parentNode.appendChild(this)}function f0(){return this.each(d0)}function h0(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function p0(){return this.each(h0)}function g0(e){var t=typeof e=="function"?e:lf(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function m0(){return null}function v0(e,t){var n=typeof e=="function"?e:lf(e),r=t==null?m0:typeof t=="function"?t:hs(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function y0(){var e=this.parentNode;e&&e.removeChild(this)}function b0(){return this.each(y0)}function x0(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function w0(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function _0(e){return this.select(e?w0:x0)}function E0(e){return arguments.length?this.property("__data__",e):this.node().__data__}function S0(e){return function(t){e.call(this,t,this.__data__)}}function C0(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function N0(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function M0(e,t,n){return function(){var r=this.__on,i,o=S0(t);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function I0(e,t,n){var r=C0(e+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(i=0,u=s[c];i<o;++i)if((a=r[i]).type===u.type&&a.name===u.name)return u.value}return}for(s=t?M0:N0,i=0;i<o;++i)this.each(s(r[i],t,n));return this}function xf(e,t,n){var r=gf(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function k0(e,t){return function(){return xf(this,e,t)}}function R0(e,t){return function(){return xf(this,e,t.apply(this,arguments))}}function T0(e,t){return this.each((typeof t=="function"?R0:k0)(e,t))}function*A0(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var wf=[null];function ke(e,t){this._groups=e,this._parents=t}function Mn(){return new ke([[document.documentElement]],wf)}function L0(){return this}ke.prototype=Mn.prototype={constructor:ke,select:ov,selectAll:uv,selectChild:hv,selectChildren:vv,filter:yv,data:Sv,enter:bv,exit:Nv,join:Mv,merge:Iv,selection:L0,order:kv,sort:Rv,call:Av,nodes:Lv,node:Pv,size:qv,empty:$v,each:jv,attr:Vv,style:Kv,property:Qv,classed:n0,text:a0,html:l0,raise:f0,lower:p0,append:g0,insert:v0,remove:b0,clone:_0,datum:E0,on:I0,dispatch:T0,[Symbol.iterator]:A0};function Ae(e){return typeof e=="string"?new ke([[document.querySelector(e)]],[document.documentElement]):new ke([[e]],wf)}function P0(e){let t;for(;t=e.sourceEvent;)e=t;return e}function qe(e,t){if(e=P0(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const q0={passive:!1},dn={capture:!0,passive:!1};function Lr(e){e.stopImmediatePropagation()}function Ot(e){e.preventDefault(),e.stopImmediatePropagation()}function _f(e){var t=e.document.documentElement,n=Ae(e).on("dragstart.drag",Ot,dn);"onselectstart"in t?n.on("selectstart.drag",Ot,dn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Ef(e,t){var n=e.document.documentElement,r=Ae(e).on("dragstart.drag",null);t&&(r.on("click.drag",Ot,dn),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Tn=e=>()=>e;function qa(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:o,x:a,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}qa.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function $0(e){return!e.ctrlKey&&!e.button}function j0(){return this.parentNode}function F0(e,t){return t??{x:e.x,y:e.y}}function D0(){return navigator.maxTouchPoints||"ontouchstart"in this}function O0(){var e=$0,t=j0,n=F0,r=D0,i={},o=pr("start","drag","end"),a=0,s,c,l,u,d=0;function f(x){x.on("mousedown.drag",h).filter(r).on("touchstart.drag",v).on("touchmove.drag",y,q0).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(x,M){if(!(u||!e.call(this,x,M))){var N=C(this,t.call(this,x,M),x,M,"mouse");N&&(Ae(x.view).on("mousemove.drag",g,dn).on("mouseup.drag",m,dn),_f(x.view),Lr(x),l=!1,s=x.clientX,c=x.clientY,N("start",x))}}function g(x){if(Ot(x),!l){var M=x.clientX-s,N=x.clientY-c;l=M*M+N*N>d}i.mouse("drag",x)}function m(x){Ae(x.view).on("mousemove.drag mouseup.drag",null),Ef(x.view,l),Ot(x),i.mouse("end",x)}function v(x,M){if(e.call(this,x,M)){var N=x.changedTouches,L=t.call(this,x,M),$=N.length,P,O;for(P=0;P<$;++P)(O=C(this,L,x,M,N[P].identifier,N[P]))&&(Lr(x),O("start",x,N[P]))}}function y(x){var M=x.changedTouches,N=M.length,L,$;for(L=0;L<N;++L)($=i[M[L].identifier])&&(Ot(x),$("drag",x,M[L]))}function _(x){var M=x.changedTouches,N=M.length,L,$;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),L=0;L<N;++L)($=i[M[L].identifier])&&(Lr(x),$("end",x,M[L]))}function C(x,M,N,L,$,P){var O=o.copy(),j=qe(P||N,M),F,R,b;if((b=n.call(x,new qa("beforestart",{sourceEvent:N,target:f,identifier:$,active:a,x:j[0],y:j[1],dx:0,dy:0,dispatch:O}),L))!=null)return F=b.x-j[0]||0,R=b.y-j[1]||0,function k(S,E,I){var T=j,A;switch(S){case"start":i[$]=k,A=a++;break;case"end":delete i[$],--a;case"drag":j=qe(I||E,M),A=a;break}O.call(S,x,new qa(S,{sourceEvent:E,subject:b,target:f,identifier:$,active:A,x:j[0]+F,y:j[1]+R,dx:j[0]-T[0],dy:j[1]-T[1],dispatch:O}),L)}}return f.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Tn(!!x),f):e},f.container=function(x){return arguments.length?(t=typeof x=="function"?x:Tn(x),f):t},f.subject=function(x){return arguments.length?(n=typeof x=="function"?x:Tn(x),f):n},f.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:Tn(!!x),f):r},f.on=function(){var x=o.on.apply(o,arguments);return x===o?f:x},f.clickDistance=function(x){return arguments.length?(d=(x=+x)*x,f):Math.sqrt(d)},f}function gs(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Sf(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function In(){}var fn=.7,Wn=1/fn,zt="\\s*([+-]?\\d+)\\s*",hn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ge="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",z0=/^#([0-9a-f]{3,8})$/,B0=new RegExp(`^rgb\\(${zt},${zt},${zt}\\)$`),H0=new RegExp(`^rgb\\(${Ge},${Ge},${Ge}\\)$`),V0=new RegExp(`^rgba\\(${zt},${zt},${zt},${hn}\\)$`),G0=new RegExp(`^rgba\\(${Ge},${Ge},${Ge},${hn}\\)$`),U0=new RegExp(`^hsl\\(${hn},${Ge},${Ge}\\)$`),Y0=new RegExp(`^hsla\\(${hn},${Ge},${Ge},${hn}\\)$`),nc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};gs(In,pn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:rc,formatHex:rc,formatHex8:K0,formatHsl:X0,formatRgb:ic,toString:ic});function rc(){return this.rgb().formatHex()}function K0(){return this.rgb().formatHex8()}function X0(){return Cf(this).formatHsl()}function ic(){return this.rgb().formatRgb()}function pn(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=z0.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?oc(t):n===3?new Se(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?An(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?An(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=B0.exec(e))?new Se(t[1],t[2],t[3],1):(t=H0.exec(e))?new Se(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=V0.exec(e))?An(t[1],t[2],t[3],t[4]):(t=G0.exec(e))?An(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=U0.exec(e))?cc(t[1],t[2]/100,t[3]/100,1):(t=Y0.exec(e))?cc(t[1],t[2]/100,t[3]/100,t[4]):nc.hasOwnProperty(e)?oc(nc[e]):e==="transparent"?new Se(NaN,NaN,NaN,0):null}function oc(e){return new Se(e>>16&255,e>>8&255,e&255,1)}function An(e,t,n,r){return r<=0&&(e=t=n=NaN),new Se(e,t,n,r)}function W0(e){return e instanceof In||(e=pn(e)),e?(e=e.rgb(),new Se(e.r,e.g,e.b,e.opacity)):new Se}function $a(e,t,n,r){return arguments.length===1?W0(e):new Se(e,t,n,r??1)}function Se(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}gs(Se,$a,Sf(In,{brighter(e){return e=e==null?Wn:Math.pow(Wn,e),new Se(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?fn:Math.pow(fn,e),new Se(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Se(Mt(this.r),Mt(this.g),Mt(this.b),Zn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ac,formatHex:ac,formatHex8:Z0,formatRgb:sc,toString:sc}));function ac(){return`#${Et(this.r)}${Et(this.g)}${Et(this.b)}`}function Z0(){return`#${Et(this.r)}${Et(this.g)}${Et(this.b)}${Et((isNaN(this.opacity)?1:this.opacity)*255)}`}function sc(){const e=Zn(this.opacity);return`${e===1?"rgb(":"rgba("}${Mt(this.r)}, ${Mt(this.g)}, ${Mt(this.b)}${e===1?")":`, ${e})`}`}function Zn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Mt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Et(e){return e=Mt(e),(e<16?"0":"")+e.toString(16)}function cc(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new $e(e,t,n,r)}function Cf(e){if(e instanceof $e)return new $e(e.h,e.s,e.l,e.opacity);if(e instanceof In||(e=pn(e)),!e)return new $e;if(e instanceof $e)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,c=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=c<.5?o+i:2-o-i,a*=60):s=c>0&&c<1?0:a,new $e(a,s,c,e.opacity)}function Q0(e,t,n,r){return arguments.length===1?Cf(e):new $e(e,t,n,r??1)}function $e(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}gs($e,Q0,Sf(In,{brighter(e){return e=e==null?Wn:Math.pow(Wn,e),new $e(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?fn:Math.pow(fn,e),new $e(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Se(Pr(e>=240?e-240:e+120,i,r),Pr(e,i,r),Pr(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new $e(uc(this.h),Ln(this.s),Ln(this.l),Zn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Zn(this.opacity);return`${e===1?"hsl(":"hsla("}${uc(this.h)}, ${Ln(this.s)*100}%, ${Ln(this.l)*100}%${e===1?")":`, ${e})`}`}}));function uc(e){return e=(e||0)%360,e<0?e+360:e}function Ln(e){return Math.max(0,Math.min(1,e||0))}function Pr(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Nf=e=>()=>e;function J0(e,t){return function(n){return e+n*t}}function ey(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function ty(e){return(e=+e)==1?Mf:function(t,n){return n-t?ey(t,n,e):Nf(isNaN(t)?n:t)}}function Mf(e,t){var n=t-e;return n?J0(e,n):Nf(isNaN(e)?t:e)}const lc=function e(t){var n=ty(t);function r(i,o){var a=n((i=$a(i)).r,(o=$a(o)).r),s=n(i.g,o.g),c=n(i.b,o.b),l=Mf(i.opacity,o.opacity);return function(u){return i.r=a(u),i.g=s(u),i.b=c(u),i.opacity=l(u),i+""}}return r.gamma=e,r}(1);function ct(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var ja=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qr=new RegExp(ja.source,"g");function ny(e){return function(){return e}}function ry(e){return function(t){return e(t)+""}}function iy(e,t){var n=ja.lastIndex=qr.lastIndex=0,r,i,o,a=-1,s=[],c=[];for(e=e+"",t=t+"";(r=ja.exec(e))&&(i=qr.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,c.push({i:a,x:ct(r,i)})),n=qr.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?c[0]?ry(c[0].x):ny(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)s[(d=c[u]).i]=d.x(l);return s.join("")})}var dc=180/Math.PI,Fa={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function If(e,t,n,r,i,o){var a,s,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*dc,skewX:Math.atan(c)*dc,scaleX:a,scaleY:s}}var Pn;function oy(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Fa:If(t.a,t.b,t.c,t.d,t.e,t.f)}function ay(e){return e==null||(Pn||(Pn=document.createElementNS("http://www.w3.org/2000/svg","g")),Pn.setAttribute("transform",e),!(e=Pn.transform.baseVal.consolidate()))?Fa:(e=e.matrix,If(e.a,e.b,e.c,e.d,e.e,e.f))}function kf(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,u,d,f,h,g){if(l!==d||u!==f){var m=h.push("translate(",null,t,null,n);g.push({i:m-4,x:ct(l,d)},{i:m-2,x:ct(u,f)})}else(d||f)&&h.push("translate("+d+t+f+n)}function a(l,u,d,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:d.push(i(d)+"rotate(",null,r)-2,x:ct(l,u)})):u&&d.push(i(d)+"rotate("+u+r)}function s(l,u,d,f){l!==u?f.push({i:d.push(i(d)+"skewX(",null,r)-2,x:ct(l,u)}):u&&d.push(i(d)+"skewX("+u+r)}function c(l,u,d,f,h,g){if(l!==d||u!==f){var m=h.push(i(h)+"scale(",null,",",null,")");g.push({i:m-4,x:ct(l,d)},{i:m-2,x:ct(u,f)})}else(d!==1||f!==1)&&h.push(i(h)+"scale("+d+","+f+")")}return function(l,u){var d=[],f=[];return l=e(l),u=e(u),o(l.translateX,l.translateY,u.translateX,u.translateY,d,f),a(l.rotate,u.rotate,d,f),s(l.skewX,u.skewX,d,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,f),l=u=null,function(h){for(var g=-1,m=f.length,v;++g<m;)d[(v=f[g]).i]=v.x(h);return d.join("")}}}var sy=kf(oy,"px, ","px)","deg)"),cy=kf(ay,", ",")",")"),uy=1e-12;function fc(e){return((e=Math.exp(e))+1/e)/2}function ly(e){return((e=Math.exp(e))-1/e)/2}function dy(e){return((e=Math.exp(2*e))-1)/(e+1)}const fy=function e(t,n,r){function i(o,a){var s=o[0],c=o[1],l=o[2],u=a[0],d=a[1],f=a[2],h=u-s,g=d-c,m=h*h+g*g,v,y;if(m<uy)y=Math.log(f/l)/t,v=function(L){return[s+L*h,c+L*g,l*Math.exp(t*L*y)]};else{var _=Math.sqrt(m),C=(f*f-l*l+r*m)/(2*l*n*_),x=(f*f-l*l-r*m)/(2*f*n*_),M=Math.log(Math.sqrt(C*C+1)-C),N=Math.log(Math.sqrt(x*x+1)-x);y=(N-M)/t,v=function(L){var $=L*y,P=fc(M),O=l/(n*_)*(P*dy(t*$+M)-ly(M));return[s+O*h,c+O*g,l*P/fc(t*$+M)]}}return v.duration=y*1e3*t/Math.SQRT2,v}return i.rho=function(o){var a=Math.max(.001,+o),s=a*a,c=s*s;return e(a,s,c)},i}(Math.SQRT2,2,4);var Ut=0,on=0,Jt=0,Rf=1e3,Qn,an,Jn=0,Rt=0,mr=0,gn=typeof performance=="object"&&performance.now?performance:Date,Tf=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ms(){return Rt||(Tf(hy),Rt=gn.now()+mr)}function hy(){Rt=0}function er(){this._call=this._time=this._next=null}er.prototype=Af.prototype={constructor:er,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?ms():+n)+(t==null?0:+t),!this._next&&an!==this&&(an?an._next=this:Qn=this,an=this),this._call=e,this._time=n,Da()},stop:function(){this._call&&(this._call=null,this._time=1/0,Da())}};function Af(e,t,n){var r=new er;return r.restart(e,t,n),r}function py(){ms(),++Ut;for(var e=Qn,t;e;)(t=Rt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ut}function hc(){Rt=(Jn=gn.now())+mr,Ut=on=0;try{py()}finally{Ut=0,my(),Rt=0}}function gy(){var e=gn.now(),t=e-Jn;t>Rf&&(mr-=t,Jn=e)}function my(){for(var e,t=Qn,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Qn=n);an=e,Da(r)}function Da(e){if(!Ut){on&&(on=clearTimeout(on));var t=e-Rt;t>24?(e<1/0&&(on=setTimeout(hc,e-gn.now()-mr)),Jt&&(Jt=clearInterval(Jt))):(Jt||(Jn=gn.now(),Jt=setInterval(gy,Rf)),Ut=1,Tf(hc))}}function pc(e,t,n){var r=new er;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var vy=pr("start","end","cancel","interrupt"),yy=[],Lf=0,gc=1,Oa=2,Hn=3,mc=4,za=5,Vn=6;function vr(e,t,n,r,i,o){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;by(e,n,{name:t,index:r,group:i,on:vy,tween:yy,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Lf})}function vs(e,t){var n=De(e,t);if(n.state>Lf)throw new Error("too late; already scheduled");return n}function Ue(e,t){var n=De(e,t);if(n.state>Hn)throw new Error("too late; already running");return n}function De(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function by(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Af(o,0,n.time);function o(l){n.state=gc,n.timer.restart(a,n.delay,n.time),n.delay<=l&&a(l-n.delay)}function a(l){var u,d,f,h;if(n.state!==gc)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Hn)return pc(a);h.state===mc?(h.state=Vn,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=Vn,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(pc(function(){n.state===Hn&&(n.state=mc,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=Oa,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Oa){for(n.state=Hn,i=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function s(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=za,1),d=-1,f=i.length;++d<f;)i[d].call(e,u);n.state===za&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Vn,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function Gn(e,t){var n=e.__transition,r,i,o=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){o=!1;continue}i=r.state>Oa&&r.state<za,r.state=Vn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}o&&delete e.__transition}}function xy(e){return this.each(function(){Gn(this,e)})}function wy(e,t){var n,r;return function(){var i=Ue(this,e),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function _y(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=Ue(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=s;break}c===l&&i.push(s)}o.tween=i}}function Ey(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=De(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((t==null?wy:_y)(n,e,t))}function ys(e,t,n){var r=e._id;return e.each(function(){var i=Ue(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return De(i,r).value[t]}}function Pf(e,t){var n;return(typeof t=="number"?ct:t instanceof pn?lc:(n=pn(t))?(t=n,lc):iy)(e,t)}function Sy(e){return function(){this.removeAttribute(e)}}function Cy(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ny(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttribute(e);return a===i?null:a===r?o:o=t(r=a,n)}}function My(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?o:o=t(r=a,n)}}function Iy(e,t,n){var r,i,o;return function(){var a,s=n(this),c;return s==null?void this.removeAttribute(e):(a=this.getAttribute(e),c=s+"",a===c?null:a===r&&c===i?o:(i=c,o=t(r=a,s)))}}function ky(e,t,n){var r,i,o;return function(){var a,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),c=s+"",a===c?null:a===r&&c===i?o:(i=c,o=t(r=a,s)))}}function Ry(e,t){var n=gr(e),r=n==="transform"?cy:Pf;return this.attrTween(e,typeof t=="function"?(n.local?ky:Iy)(n,r,ys(this,"attr."+e,t)):t==null?(n.local?Cy:Sy)(n):(n.local?My:Ny)(n,r,t))}function Ty(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Ay(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Ly(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Ay(e,o)),n}return i._value=t,i}function Py(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Ty(e,o)),n}return i._value=t,i}function qy(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=gr(e);return this.tween(n,(r.local?Ly:Py)(r,t))}function $y(e,t){return function(){vs(this,e).delay=+t.apply(this,arguments)}}function jy(e,t){return t=+t,function(){vs(this,e).delay=t}}function Fy(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?$y:jy)(t,e)):De(this.node(),t).delay}function Dy(e,t){return function(){Ue(this,e).duration=+t.apply(this,arguments)}}function Oy(e,t){return t=+t,function(){Ue(this,e).duration=t}}function zy(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Dy:Oy)(t,e)):De(this.node(),t).duration}function By(e,t){if(typeof t!="function")throw new Error;return function(){Ue(this,e).ease=t}}function Hy(e){var t=this._id;return arguments.length?this.each(By(t,e)):De(this.node(),t).ease}function Vy(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ue(this,e).ease=n}}function Gy(e){if(typeof e!="function")throw new Error;return this.each(Vy(this._id,e))}function Uy(e){typeof e!="function"&&(e=ff(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],c,l=0;l<a;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new nt(r,this._parents,this._name,this._id)}function Yy(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var c=t[s],l=n[s],u=c.length,d=a[s]=new Array(u),f,h=0;h<u;++h)(f=c[h]||l[h])&&(d[h]=f);for(;s<r;++s)a[s]=t[s];return new nt(a,this._parents,this._name,this._id)}function Ky(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Xy(e,t,n){var r,i,o=Ky(t)?vs:Ue;return function(){var a=o(this,e),s=a.on;s!==r&&(i=(r=s).copy()).on(t,n),a.on=i}}function Wy(e,t){var n=this._id;return arguments.length<2?De(this.node(),n).on.on(e):this.each(Xy(n,e,t))}function Zy(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Qy(){return this.on("end.remove",Zy(this._id))}function Jy(e){var t=this._name,n=this._id;typeof e!="function"&&(e=hs(e));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],c=s.length,l=o[a]=new Array(c),u,d,f=0;f<c;++f)(u=s[f])&&(d=e.call(u,u.__data__,f,s))&&("__data__"in u&&(d.__data__=u.__data__),l[f]=d,vr(l[f],t,n,f,l,De(u,n)));return new nt(o,this._parents,t,n)}function eb(e){var t=this._name,n=this._id;typeof e!="function"&&(e=df(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),h,g=De(u,n),m=0,v=f.length;m<v;++m)(h=f[m])&&vr(h,t,n,m,f,g);o.push(f),a.push(u)}return new nt(o,a,t,n)}var tb=Mn.prototype.constructor;function nb(){return new tb(this._groups,this._parents)}function rb(e,t){var n,r,i;return function(){var o=Gt(this,e),a=(this.style.removeProperty(e),Gt(this,e));return o===a?null:o===n&&a===r?i:i=t(n=o,r=a)}}function qf(e){return function(){this.style.removeProperty(e)}}function ib(e,t,n){var r,i=n+"",o;return function(){var a=Gt(this,e);return a===i?null:a===r?o:o=t(r=a,n)}}function ob(e,t,n){var r,i,o;return function(){var a=Gt(this,e),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(e),Gt(this,e))),a===c?null:a===r&&c===i?o:(i=c,o=t(r=a,s))}}function ab(e,t){var n,r,i,o="style."+t,a="end."+o,s;return function(){var c=Ue(this,e),l=c.on,u=c.value[o]==null?s||(s=qf(t)):void 0;(l!==n||i!==u)&&(r=(n=l).copy()).on(a,i=u),c.on=r}}function sb(e,t,n){var r=(e+="")=="transform"?sy:Pf;return t==null?this.styleTween(e,rb(e,r)).on("end.style."+e,qf(e)):typeof t=="function"?this.styleTween(e,ob(e,r,ys(this,"style."+e,t))).each(ab(this._id,e)):this.styleTween(e,ib(e,r,t),n).on("end.style."+e,null)}function cb(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function ub(e,t,n){var r,i;function o(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&cb(e,a,n)),r}return o._value=t,o}function lb(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,ub(e,t,n??""))}function db(e){return function(){this.textContent=e}}function fb(e){return function(){var t=e(this);this.textContent=t??""}}function hb(e){return this.tween("text",typeof e=="function"?fb(ys(this,"text",e)):db(e==null?"":e+""))}function pb(e){return function(t){this.textContent=e.call(this,t)}}function gb(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&pb(i)),t}return r._value=e,r}function mb(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,gb(e))}function vb(){for(var e=this._name,t=this._id,n=$f(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,c,l=0;l<s;++l)if(c=a[l]){var u=De(c,t);vr(c,e,n,l,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new nt(r,this._parents,e,n)}function yb(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},c={value:function(){--i===0&&o()}};n.each(function(){var l=Ue(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),l.on=t}),i===0&&o()})}var bb=0;function nt(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function $f(){return++bb}var Xe=Mn.prototype;nt.prototype={constructor:nt,select:Jy,selectAll:eb,selectChild:Xe.selectChild,selectChildren:Xe.selectChildren,filter:Uy,merge:Yy,selection:nb,transition:vb,call:Xe.call,nodes:Xe.nodes,node:Xe.node,size:Xe.size,empty:Xe.empty,each:Xe.each,on:Wy,attr:Ry,attrTween:qy,style:sb,styleTween:lb,text:hb,textTween:mb,remove:Qy,tween:Ey,delay:Fy,duration:zy,ease:Hy,easeVarying:Gy,end:yb,[Symbol.iterator]:Xe[Symbol.iterator]};function xb(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var wb={time:null,delay:0,duration:250,ease:xb};function _b(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Eb(e){var t,n;e instanceof nt?(t=e._id,e=e._name):(t=$f(),(n=wb).time=ms(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,c,l=0;l<s;++l)(c=a[l])&&vr(c,e,t,l,a,n||_b(c,t));return new nt(r,this._parents,e,t)}Mn.prototype.interrupt=xy;Mn.prototype.transition=Eb;const qn=e=>()=>e;function Sb(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Ze(e,t,n){this.k=e,this.x=t,this.y=n}Ze.prototype={constructor:Ze,scale:function(e){return e===1?this:new Ze(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ze(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var et=new Ze(1,0,0);Ze.prototype;function $r(e){e.stopImmediatePropagation()}function en(e){e.preventDefault(),e.stopImmediatePropagation()}function Cb(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Nb(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function vc(){return this.__zoom||et}function Mb(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Ib(){return navigator.maxTouchPoints||"ontouchstart"in this}function kb(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function jf(){var e=Cb,t=Nb,n=kb,r=Mb,i=Ib,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],s=250,c=fy,l=pr("start","zoom","end"),u,d,f,h=500,g=150,m=0,v=10;function y(b){b.property("__zoom",vc).on("wheel.zoom",$,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",O).filter(i).on("touchstart.zoom",j).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(b,k,S,E){var I=b.selection?b.selection():b;I.property("__zoom",vc),b!==I?M(b,k,S,E):I.interrupt().each(function(){N(this,arguments).event(E).start().zoom(null,typeof k=="function"?k.apply(this,arguments):k).end()})},y.scaleBy=function(b,k,S,E){y.scaleTo(b,function(){var I=this.__zoom.k,T=typeof k=="function"?k.apply(this,arguments):k;return I*T},S,E)},y.scaleTo=function(b,k,S,E){y.transform(b,function(){var I=t.apply(this,arguments),T=this.__zoom,A=S==null?x(I):typeof S=="function"?S.apply(this,arguments):S,B=T.invert(A),H=typeof k=="function"?k.apply(this,arguments):k;return n(C(_(T,H),A,B),I,a)},S,E)},y.translateBy=function(b,k,S,E){y.transform(b,function(){return n(this.__zoom.translate(typeof k=="function"?k.apply(this,arguments):k,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),a)},null,E)},y.translateTo=function(b,k,S,E,I){y.transform(b,function(){var T=t.apply(this,arguments),A=this.__zoom,B=E==null?x(T):typeof E=="function"?E.apply(this,arguments):E;return n(et.translate(B[0],B[1]).scale(A.k).translate(typeof k=="function"?-k.apply(this,arguments):-k,typeof S=="function"?-S.apply(this,arguments):-S),T,a)},E,I)};function _(b,k){return k=Math.max(o[0],Math.min(o[1],k)),k===b.k?b:new Ze(k,b.x,b.y)}function C(b,k,S){var E=k[0]-S[0]*b.k,I=k[1]-S[1]*b.k;return E===b.x&&I===b.y?b:new Ze(b.k,E,I)}function x(b){return[(+b[0][0]+ +b[1][0])/2,(+b[0][1]+ +b[1][1])/2]}function M(b,k,S,E){b.on("start.zoom",function(){N(this,arguments).event(E).start()}).on("interrupt.zoom end.zoom",function(){N(this,arguments).event(E).end()}).tween("zoom",function(){var I=this,T=arguments,A=N(I,T).event(E),B=t.apply(I,T),H=S==null?x(B):typeof S=="function"?S.apply(I,T):S,Y=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),U=I.__zoom,Q=typeof k=="function"?k.apply(I,T):k,J=c(U.invert(H).concat(Y/U.k),Q.invert(H).concat(Y/Q.k));return function(ee){if(ee===1)ee=Q;else{var ne=J(ee),V=Y/ne[2];ee=new Ze(V,H[0]-ne[0]*V,H[1]-ne[1]*V)}A.zoom(null,ee)}})}function N(b,k,S){return!S&&b.__zooming||new L(b,k)}function L(b,k){this.that=b,this.args=k,this.active=0,this.sourceEvent=null,this.extent=t.apply(b,k),this.taps=0}L.prototype={event:function(b){return b&&(this.sourceEvent=b),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(b,k){return this.mouse&&b!=="mouse"&&(this.mouse[1]=k.invert(this.mouse[0])),this.touch0&&b!=="touch"&&(this.touch0[1]=k.invert(this.touch0[0])),this.touch1&&b!=="touch"&&(this.touch1[1]=k.invert(this.touch1[0])),this.that.__zoom=k,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(b){var k=Ae(this.that).datum();l.call(b,this.that,new Sb(b,{sourceEvent:this.sourceEvent,target:y,type:b,transform:this.that.__zoom,dispatch:l}),k)}};function $(b,...k){if(!e.apply(this,arguments))return;var S=N(this,k).event(b),E=this.__zoom,I=Math.max(o[0],Math.min(o[1],E.k*Math.pow(2,r.apply(this,arguments)))),T=qe(b);if(S.wheel)(S.mouse[0][0]!==T[0]||S.mouse[0][1]!==T[1])&&(S.mouse[1]=E.invert(S.mouse[0]=T)),clearTimeout(S.wheel);else{if(E.k===I)return;S.mouse=[T,E.invert(T)],Gn(this),S.start()}en(b),S.wheel=setTimeout(A,g),S.zoom("mouse",n(C(_(E,I),S.mouse[0],S.mouse[1]),S.extent,a));function A(){S.wheel=null,S.end()}}function P(b,...k){if(f||!e.apply(this,arguments))return;var S=b.currentTarget,E=N(this,k,!0).event(b),I=Ae(b.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",Y,!0),T=qe(b,S),A=b.clientX,B=b.clientY;_f(b.view),$r(b),E.mouse=[T,this.__zoom.invert(T)],Gn(this),E.start();function H(U){if(en(U),!E.moved){var Q=U.clientX-A,J=U.clientY-B;E.moved=Q*Q+J*J>m}E.event(U).zoom("mouse",n(C(E.that.__zoom,E.mouse[0]=qe(U,S),E.mouse[1]),E.extent,a))}function Y(U){I.on("mousemove.zoom mouseup.zoom",null),Ef(U.view,E.moved),en(U),E.event(U).end()}}function O(b,...k){if(e.apply(this,arguments)){var S=this.__zoom,E=qe(b.changedTouches?b.changedTouches[0]:b,this),I=S.invert(E),T=S.k*(b.shiftKey?.5:2),A=n(C(_(S,T),E,I),t.apply(this,k),a);en(b),s>0?Ae(this).transition().duration(s).call(M,A,E,b):Ae(this).call(y.transform,A,E,b)}}function j(b,...k){if(e.apply(this,arguments)){var S=b.touches,E=S.length,I=N(this,k,b.changedTouches.length===E).event(b),T,A,B,H;for($r(b),A=0;A<E;++A)B=S[A],H=qe(B,this),H=[H,this.__zoom.invert(H),B.identifier],I.touch0?!I.touch1&&I.touch0[2]!==H[2]&&(I.touch1=H,I.taps=0):(I.touch0=H,T=!0,I.taps=1+!!u);u&&(u=clearTimeout(u)),T&&(I.taps<2&&(d=H[0],u=setTimeout(function(){u=null},h)),Gn(this),I.start())}}function F(b,...k){if(this.__zooming){var S=N(this,k).event(b),E=b.changedTouches,I=E.length,T,A,B,H;for(en(b),T=0;T<I;++T)A=E[T],B=qe(A,this),S.touch0&&S.touch0[2]===A.identifier?S.touch0[0]=B:S.touch1&&S.touch1[2]===A.identifier&&(S.touch1[0]=B);if(A=S.that.__zoom,S.touch1){var Y=S.touch0[0],U=S.touch0[1],Q=S.touch1[0],J=S.touch1[1],ee=(ee=Q[0]-Y[0])*ee+(ee=Q[1]-Y[1])*ee,ne=(ne=J[0]-U[0])*ne+(ne=J[1]-U[1])*ne;A=_(A,Math.sqrt(ee/ne)),B=[(Y[0]+Q[0])/2,(Y[1]+Q[1])/2],H=[(U[0]+J[0])/2,(U[1]+J[1])/2]}else if(S.touch0)B=S.touch0[0],H=S.touch0[1];else return;S.zoom("touch",n(C(A,B,H),S.extent,a))}}function R(b,...k){if(this.__zooming){var S=N(this,k).event(b),E=b.changedTouches,I=E.length,T,A;for($r(b),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),T=0;T<I;++T)A=E[T],S.touch0&&S.touch0[2]===A.identifier?delete S.touch0:S.touch1&&S.touch1[2]===A.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(A=qe(A,this),Math.hypot(d[0]-A[0],d[1]-A[1])<v)){var B=Ae(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return y.wheelDelta=function(b){return arguments.length?(r=typeof b=="function"?b:qn(+b),y):r},y.filter=function(b){return arguments.length?(e=typeof b=="function"?b:qn(!!b),y):e},y.touchable=function(b){return arguments.length?(i=typeof b=="function"?b:qn(!!b),y):i},y.extent=function(b){return arguments.length?(t=typeof b=="function"?b:qn([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),y):t},y.scaleExtent=function(b){return arguments.length?(o[0]=+b[0],o[1]=+b[1],y):[o[0],o[1]]},y.translateExtent=function(b){return arguments.length?(a[0][0]=+b[0][0],a[1][0]=+b[1][0],a[0][1]=+b[0][1],a[1][1]=+b[1][1],y):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},y.constrain=function(b){return arguments.length?(n=b,y):n},y.duration=function(b){return arguments.length?(s=+b,y):s},y.interpolate=function(b){return arguments.length?(c=b,y):c},y.on=function(){var b=l.on.apply(l,arguments);return b===l?y:b},y.clickDistance=function(b){return arguments.length?(m=(b=+b)*b,y):Math.sqrt(m)},y.tapDistance=function(b){return arguments.length?(v=+b,y):v},y}const yr=w.createContext(null),Rb=yr.Provider,gt={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`},Ff=gt.error001();function se(e,t){const n=w.useContext(yr);if(n===null)throw new Error(Ff);return Qm(n,e,t)}const ge=()=>{const e=w.useContext(yr);if(e===null)throw new Error(Ff);return w.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Tb=e=>e.userSelectionActive?"none":"all";function bs({position:e,children:t,className:n,style:r,...i}){const o=se(Tb),a=`${e}`.split("-");return p.jsx("div",{className:ve(["react-flow__panel",n,...a]),style:{...r,pointerEvents:o},...i,children:t})}function Ab({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:p.jsx(bs,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:p.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Lb=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:o={},labelBgPadding:a=[2,4],labelBgBorderRadius:s=2,children:c,className:l,...u})=>{const d=w.useRef(null),[f,h]=w.useState({x:0,y:0,width:0,height:0}),g=ve(["react-flow__edge-textwrapper",l]);return w.useEffect(()=>{if(d.current){const m=d.current.getBBox();h({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),typeof n>"u"||!n?null:p.jsxs("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:g,visibility:f.width?"visible":"hidden",...u,children:[i&&p.jsx("rect",{width:f.width+2*a[0],x:-a[0],y:-a[1],height:f.height+2*a[1],className:"react-flow__edge-textbg",style:o,rx:s,ry:s}),p.jsx("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:d,style:r,children:n}),c]})};var Pb=w.memo(Lb);const xs=e=>({width:e.offsetWidth,height:e.offsetHeight}),Yt=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),ws=(e={x:0,y:0},t)=>({x:Yt(e.x,t[0][0],t[1][0]),y:Yt(e.y,t[0][1],t[1][1])}),yc=(e,t,n)=>e<t?Yt(Math.abs(e-t),1,50)/50:e>n?-Yt(Math.abs(e-n),1,50)/50:0,Df=(e,t)=>{const n=yc(e.x,35,t.width-35)*20,r=yc(e.y,35,t.height-35)*20;return[n,r]},Of=e=>e.getRootNode?.()||window?.document,zf=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),tr=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Bf=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),bc=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),qb=(e,t)=>Bf(zf(tr(e),tr(t))),Ba=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},$b=e=>Le(e.width)&&Le(e.height)&&Le(e.x)&&Le(e.y),Le=e=>!isNaN(e)&&isFinite(e),de=Symbol.for("internals"),Hf=["Enter"," ","Escape"],jb=(e,t)=>{},Fb=e=>"nativeEvent"in e;function Ha(e){const n=(Fb(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n?.nodeName)||n?.hasAttribute("contenteditable")||!!n?.closest(".nokey")}const Vf=e=>"clientX"in e,ht=(e,t)=>{const n=Vf(e),r=n?e.clientX:e.touches?.[0].clientX,i=n?e.clientY:e.touches?.[0].clientY;return{x:r-(t?.left??0),y:i-(t?.top??0)}},kn=({path:e,labelX:t,labelY:n,label:r,labelStyle:i,labelShowBg:o,labelBgStyle:a,labelBgPadding:s,labelBgBorderRadius:c,style:l,markerEnd:u,markerStart:d,interactionWidth:f=20})=>p.jsxs(p.Fragment,{children:[p.jsx("path",{style:l,d:e,fill:"none",className:"react-flow__edge-path",markerEnd:u,markerStart:d}),f&&p.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}),r&&Le(t)&&Le(n)?p.jsx(Pb,{x:t,y:n,label:r,labelStyle:i,labelShowBg:o,labelBgStyle:a,labelBgPadding:s,labelBgBorderRadius:c}):null]});kn.displayName="BaseEdge";const Db=(e,t)=>typeof t<"u"&&t?`url(#${t})`:typeof e<"u"?`url(#react-flow__${e})`:"none";function tn(e,t,n){return n===void 0?n:r=>{const i=t().edges.find(o=>o.id===e);i&&n(r,{...i})}}function Gf({sourceX:e,sourceY:t,targetX:n,targetY:r}){const i=Math.abs(n-e)/2,o=n<e?n+i:n-i,a=Math.abs(r-t)/2,s=r<t?r+a:r-a;return[o,s,i,a]}function Uf({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:o,targetControlX:a,targetControlY:s}){const c=e*.125+i*.375+a*.375+n*.125,l=t*.125+o*.375+s*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}var Tt;(function(e){e.Strict="strict",e.Loose="loose"})(Tt||(Tt={}));var Bt;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Bt||(Bt={}));var mn;(function(e){e.Partial="partial",e.Full="full"})(mn||(mn={}));var lt;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(lt||(lt={}));var nr;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(nr||(nr={}));var z;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(z||(z={}));function xc({pos:e,x1:t,y1:n,x2:r,y2:i}){return e===z.Left||e===z.Right?[.5*(t+r),n]:[t,.5*(n+i)]}function Yf({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:r,targetY:i,targetPosition:o=z.Top}){const[a,s]=xc({pos:n,x1:e,y1:t,x2:r,y2:i}),[c,l]=xc({pos:o,x1:r,y1:i,x2:e,y2:t}),[u,d,f,h]=Uf({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:a,sourceControlY:s,targetControlX:c,targetControlY:l});return[`M${e},${t} C${a},${s} ${c},${l} ${r},${i}`,u,d,f,h]}const _s=w.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=z.Bottom,targetPosition:o=z.Top,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,interactionWidth:m})=>{const[v,y,_]=Yf({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:o});return p.jsx(kn,{path:v,labelX:y,labelY:_,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,interactionWidth:m})});_s.displayName="SimpleBezierEdge";const wc={[z.Left]:{x:-1,y:0},[z.Right]:{x:1,y:0},[z.Top]:{x:0,y:-1},[z.Bottom]:{x:0,y:1}},Ob=({source:e,sourcePosition:t=z.Bottom,target:n})=>t===z.Left||t===z.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},_c=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function zb({source:e,sourcePosition:t=z.Bottom,target:n,targetPosition:r=z.Top,center:i,offset:o}){const a=wc[t],s=wc[r],c={x:e.x+a.x*o,y:e.y+a.y*o},l={x:n.x+s.x*o,y:n.y+s.y*o},u=Ob({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",f=u[d];let h=[],g,m;const[v,y,_,C]=Gf({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[d]*s[d]===-1){g=i.x||v,m=i.y||y;const M=[{x:g,y:c.y},{x:g,y:l.y}],N=[{x:c.x,y:m},{x:l.x,y:m}];a[d]===f?h=d==="x"?M:N:h=d==="x"?N:M}else{const M=[{x:c.x,y:l.y}],N=[{x:l.x,y:c.y}];if(d==="x"?h=a.x===f?N:M:h=a.y===f?M:N,t!==r){const L=d==="x"?"y":"x",$=a[d]===s[L],P=c[L]>l[L],O=c[L]<l[L];(a[d]===1&&(!$&&P||$&&O)||a[d]!==1&&(!$&&O||$&&P))&&(h=d==="x"?M:N)}g=h[0].x,m=h[0].y}return[[e,c,...h,l,n],g,m,_,C]}function Bb(e,t,n,r){const i=Math.min(_c(e,t)/2,_c(t,n)/2,r),{x:o,y:a}=t;if(e.x===o&&o===n.x||e.y===a&&a===n.y)return`L${o} ${a}`;if(e.y===a){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${o+i*l},${a}Q ${o},${a} ${o},${a+i*u}`}const s=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${o},${a+i*c}Q ${o},${a} ${o+i*s},${a}`}function Va({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:r,targetY:i,targetPosition:o=z.Top,borderRadius:a=5,centerX:s,centerY:c,offset:l=20}){const[u,d,f,h,g]=zb({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:i},targetPosition:o,center:{x:s,y:c},offset:l});return[u.reduce((v,y,_)=>{let C="";return _>0&&_<u.length-1?C=Bb(u[_-1],y,u[_+1],a):C=`${_===0?"M":"L"}${y.x} ${y.y}`,v+=C,v},""),d,f,h,g]}const br=w.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:o,labelShowBg:a,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,sourcePosition:d=z.Bottom,targetPosition:f=z.Top,markerEnd:h,markerStart:g,pathOptions:m,interactionWidth:v})=>{const[y,_,C]=Va({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:r,targetPosition:f,borderRadius:m?.borderRadius,offset:m?.offset});return p.jsx(kn,{path:y,labelX:_,labelY:C,label:i,labelStyle:o,labelShowBg:a,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:h,markerStart:g,interactionWidth:v})});br.displayName="SmoothStepEdge";const Es=w.memo(e=>p.jsx(br,{...e,pathOptions:w.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));Es.displayName="StepEdge";function Hb({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[i,o,a,s]=Gf({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,i,o,a,s]}const Ss=w.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:o,labelShowBg:a,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:h})=>{const[g,m,v]=Hb({sourceX:e,sourceY:t,targetX:n,targetY:r});return p.jsx(kn,{path:g,labelX:m,labelY:v,label:i,labelStyle:o,labelShowBg:a,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:h})});Ss.displayName="StraightEdge";function $n(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Ec({pos:e,x1:t,y1:n,x2:r,y2:i,c:o}){switch(e){case z.Left:return[t-$n(t-r,o),n];case z.Right:return[t+$n(r-t,o),n];case z.Top:return[t,n-$n(n-i,o)];case z.Bottom:return[t,n+$n(i-n,o)]}}function Cs({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:r,targetY:i,targetPosition:o=z.Top,curvature:a=.25}){const[s,c]=Ec({pos:n,x1:e,y1:t,x2:r,y2:i,c:a}),[l,u]=Ec({pos:o,x1:r,y1:i,x2:e,y2:t,c:a}),[d,f,h,g]=Uf({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${c} ${l},${u} ${r},${i}`,d,f,h,g]}const rr=w.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=z.Bottom,targetPosition:o=z.Top,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,pathOptions:m,interactionWidth:v})=>{const[y,_,C]=Cs({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:o,curvature:m?.curvature});return p.jsx(kn,{path:y,labelX:_,labelY:C,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,interactionWidth:v})});rr.displayName="BezierEdge";const Ns=w.createContext(null),Vb=Ns.Provider;Ns.Consumer;const Gb=()=>w.useContext(Ns),Ub=e=>"id"in e&&"source"in e&&"target"in e,Yb=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,Ga=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,Kb=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Xb=(e,t)=>{if(!e.source||!e.target)return t;let n;return Ub(e)?n={...e}:n={...e,id:Yb(e)},Kb(n,t)?t:t.concat(n)},Kf=({x:e,y:t},[n,r,i],o,[a,s])=>{const c={x:(e-n)/i,y:(t-r)/i};return o?{x:a*Math.round(c.x/a),y:s*Math.round(c.y/s)}:c},Wb=({x:e,y:t},[n,r,i])=>({x:e*i+n,y:t*i+r}),It=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],i={x:e.position.x-n,y:e.position.y-r};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:i}},Ms=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,i)=>{const{x:o,y:a}=It(i,t).positionAbsolute;return zf(r,tr({x:o,y:a,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Bf(n)},Xf=(e,t,[n,r,i]=[0,0,1],o=!1,a=!1,s=[0,0])=>{const c={x:(t.x-n)/i,y:(t.y-r)/i,width:t.width/i,height:t.height/i},l=[];return e.forEach(u=>{const{width:d,height:f,selectable:h=!0,hidden:g=!1}=u;if(a&&!h||g)return!1;const{positionAbsolute:m}=It(u,s),v={x:m.x,y:m.y,width:d||0,height:f||0},y=Ba(c,v),_=typeof d>"u"||typeof f>"u"||d===null||f===null,C=o&&y>0,x=(d||0)*(f||0);(_||C||y>=x||u.dragging)&&l.push(u)}),l},Wf=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},Zf=(e,t,n,r,i,o=.1)=>{const a=t/(e.width*(1+o)),s=n/(e.height*(1+o)),c=Math.min(a,s),l=Yt(c,r,i),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,h=n/2-d*l;return[f,h,l]},bt=(e,t=0)=>e.transition().duration(t);function Sc(e,t,n,r){return(t[n]||[]).reduce((i,o)=>(`${e.id}-${o.id}-${n}`!==r&&i.push({id:o.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+o.x+o.width/2,y:(e.positionAbsolute?.y??0)+o.y+o.height/2}),i),[])}function Zb(e,t,n){let r=null,i=1/0;return n.forEach(o=>{const a=Math.sqrt(Math.pow(o.x-e.x,2)+Math.pow(o.y-e.y,2));a<=t&&a<i&&(i=a,r=o)}),r}const Qb={source:null,target:null,sourceHandle:null,targetHandle:null};function Qf(e,t,n,r,i,o,a,s){const c=o==="target",l=s.querySelector(`.react-flow__handle[data-id="${t?.nodeId}-${t?.id}-${t?.type}"]`),{x:u,y:d}=ht(e),f=s.elementFromPoint(u,d),h=f?.classList.contains("react-flow__handle")?f:l,g={handleDomNode:h,isValid:!1,connection:Qb,endHandle:null};if(h){const m=Jf(void 0,h),v=h.getAttribute("data-nodeid"),y=h.getAttribute("data-handleid"),_=h.classList.contains("connectable"),C=h.classList.contains("connectableend"),x={source:c?v:r,sourceHandle:c?y:i,target:c?r:v,targetHandle:c?i:y};g.connection=x,_&&C&&(n===Tt.Strict?c&&m==="source"||!c&&m==="target":v!==r||y!==i)&&(g.endHandle={nodeId:v,handleId:y,type:m},g.isValid=a(x))}return g}function Jb({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((i,o)=>{if(o[de]){const{handleBounds:a}=o[de];let s=[],c=[];a&&(s=Sc(o,a,"source",`${t}-${n}-${r}`),c=Sc(o,a,"target",`${t}-${n}-${r}`)),i.push(...s,...c)}return i},[])}function Jf(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function jr(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function ex(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function eh({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:i,getState:o,setState:a,isValidConnection:s,edgeUpdaterType:c,onEdgeUpdateEnd:l}){const u=Of(e.target),{connectionMode:d,domNode:f,autoPanOnConnect:h,connectionRadius:g,onConnectStart:m,panBy:v,getNodes:y,cancelConnection:_}=o();let C=0,x;const{x:M,y:N}=ht(e),L=u?.elementFromPoint(M,N),$=Jf(c,L),P=f?.getBoundingClientRect();if(!P||!$)return;let O,j=ht(e,P),F=!1,R=null,b=!1,k=null;const S=Jb({nodes:y(),nodeId:n,handleId:t,handleType:$}),E=()=>{if(!h)return;const[A,B]=Df(j,P);v({x:A,y:B}),C=requestAnimationFrame(E)};a({connectionPosition:j,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:$,connectionStartHandle:{nodeId:n,handleId:t,type:$},connectionEndHandle:null}),m?.(e,{nodeId:n,handleId:t,handleType:$});function I(A){const{transform:B}=o();j=ht(A,P),x=Zb(Kf(j,B,!1,[1,1]),g,S),F||(E(),F=!0);const H=Qf(A,x,d,n,t,i?"target":"source",s,u);if(k=H.handleDomNode,R=H.connection,b=H.isValid,a({connectionPosition:x&&b?Wb({x:x.x,y:x.y},B):j,connectionStatus:ex(!!x,b),connectionEndHandle:H.endHandle}),!x&&!b&&!k)return jr(O);R.source!==R.target&&k&&(jr(O),O=k,k.classList.add("connecting","react-flow__handle-connecting"),k.classList.toggle("valid",b),k.classList.toggle("react-flow__handle-valid",b))}function T(A){(x||k)&&R&&b&&r?.(R),o().onConnectEnd?.(A),c&&l?.(A),jr(O),_(),cancelAnimationFrame(C),F=!1,b=!1,R=null,k=null,u.removeEventListener("mousemove",I),u.removeEventListener("mouseup",T),u.removeEventListener("touchmove",I),u.removeEventListener("touchend",T)}u.addEventListener("mousemove",I),u.addEventListener("mouseup",T),u.addEventListener("touchmove",I),u.addEventListener("touchend",T)}const Cc=()=>!0,tx=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),nx=(e,t,n)=>r=>{const{connectionStartHandle:i,connectionEndHandle:o,connectionClickStartHandle:a}=r;return{connecting:i?.nodeId===e&&i?.handleId===t&&i?.type===n||o?.nodeId===e&&o?.handleId===t&&o?.type===n,clickConnecting:a?.nodeId===e&&a?.handleId===t&&a?.type===n}},th=w.forwardRef(({type:e="source",position:t=z.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:o=!0,id:a,onConnect:s,children:c,className:l,onMouseDown:u,onTouchStart:d,...f},h)=>{const g=a||null,m=e==="target",v=ge(),y=Gb(),{connectOnClick:_,noPanClassName:C}=se(tx,_e),{connecting:x,clickConnecting:M}=se(nx(y,g,e));y||v.getState().onError?.("010",gt.error010());const N=P=>{const{defaultEdgeOptions:O,onConnect:j,hasDefaultEdges:F}=v.getState(),R={...O,...P};if(F){const{edges:b,setEdges:k}=v.getState();k(Xb(R,b))}j?.(R),s?.(R)},L=P=>{if(!y)return;const O=Vf(P);i&&(O&&P.button===0||!O)&&eh({event:P,handleId:g,nodeId:y,onConnect:N,isTarget:m,getState:v.getState,setState:v.setState,isValidConnection:n||v.getState().isValidConnection||Cc}),O?u?.(P):d?.(P)},$=P=>{const{onClickConnectStart:O,onClickConnectEnd:j,connectionClickStartHandle:F,connectionMode:R,isValidConnection:b}=v.getState();if(!y||!F&&!i)return;if(!F){O?.(P,{nodeId:y,handleId:g,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:y,type:e,handleId:g}});return}const k=Of(P.target),S=n||b||Cc,{connection:E,isValid:I}=Qf(P,{nodeId:y,id:g,type:e},R,F.nodeId,F.handleId||null,F.type,S,k);I&&N(E),j?.(P),v.setState({connectionClickStartHandle:null})};return p.jsx("div",{"data-handleid":g,"data-nodeid":y,"data-handlepos":t,"data-id":`${y}-${g}-${e}`,className:ve(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",C,l,{source:!m,target:m,connectable:r,connectablestart:i,connectableend:o,connecting:M,connectionindicator:r&&(i&&!x||o&&x)}]),onMouseDown:L,onTouchStart:L,onClick:_?$:void 0,ref:h,...f,children:c})});th.displayName="Handle";var mt=w.memo(th);const nh=({data:e,isConnectable:t,targetPosition:n=z.Top,sourcePosition:r=z.Bottom})=>p.jsxs(p.Fragment,{children:[p.jsx(mt,{type:"target",position:n,isConnectable:t}),e?.label,p.jsx(mt,{type:"source",position:r,isConnectable:t})]});nh.displayName="DefaultNode";var Ua=w.memo(nh);const rh=({data:e,isConnectable:t,sourcePosition:n=z.Bottom})=>p.jsxs(p.Fragment,{children:[e?.label,p.jsx(mt,{type:"source",position:n,isConnectable:t})]});rh.displayName="InputNode";var ih=w.memo(rh);const oh=({data:e,isConnectable:t,targetPosition:n=z.Top})=>p.jsxs(p.Fragment,{children:[p.jsx(mt,{type:"target",position:n,isConnectable:t}),e?.label]});oh.displayName="OutputNode";var ah=w.memo(oh);const Is=()=>null;Is.displayName="GroupNode";const rx=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected)}),jn=e=>e.id;function ix(e,t){return _e(e.selectedNodes.map(jn),t.selectedNodes.map(jn))&&_e(e.selectedEdges.map(jn),t.selectedEdges.map(jn))}const sh=w.memo(({onSelectionChange:e})=>{const t=ge(),{selectedNodes:n,selectedEdges:r}=se(rx,ix);return w.useEffect(()=>{const i={nodes:n,edges:r};e?.(i),t.getState().onSelectionChange?.(i)},[n,r,e]),null});sh.displayName="SelectionListener";const ox=e=>!!e.onSelectionChange;function ax({onSelectionChange:e}){const t=se(ox);return e||t?p.jsx(sh,{onSelectionChange:e}):null}const sx=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Pt(e,t){w.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Z(e,t,n){w.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const cx=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:i,onConnectStart:o,onConnectEnd:a,onClickConnectStart:s,onClickConnectEnd:c,nodesDraggable:l,nodesConnectable:u,nodesFocusable:d,edgesFocusable:f,edgesUpdatable:h,elevateNodesOnSelect:g,minZoom:m,maxZoom:v,nodeExtent:y,onNodesChange:_,onEdgesChange:C,elementsSelectable:x,connectionMode:M,snapGrid:N,snapToGrid:L,translateExtent:$,connectOnClick:P,defaultEdgeOptions:O,fitView:j,fitViewOptions:F,onNodesDelete:R,onEdgesDelete:b,onNodeDrag:k,onNodeDragStart:S,onNodeDragStop:E,onSelectionDrag:I,onSelectionDragStart:T,onSelectionDragStop:A,noPanClassName:B,nodeOrigin:H,rfId:Y,autoPanOnConnect:U,autoPanOnNodeDrag:Q,onError:J,connectionRadius:ee,isValidConnection:ne})=>{const{setNodes:V,setEdges:D,setDefaultNodesAndEdges:X,setMinZoom:ie,setMaxZoom:ue,setTranslateExtent:te,setNodeExtent:G,reset:oe}=se(sx,_e),q=ge();return w.useEffect(()=>{const le=r?.map(fe=>({...fe,...O}));return X(n,le),()=>{oe()}},[]),Z("defaultEdgeOptions",O,q.setState),Z("connectionMode",M,q.setState),Z("onConnect",i,q.setState),Z("onConnectStart",o,q.setState),Z("onConnectEnd",a,q.setState),Z("onClickConnectStart",s,q.setState),Z("onClickConnectEnd",c,q.setState),Z("nodesDraggable",l,q.setState),Z("nodesConnectable",u,q.setState),Z("nodesFocusable",d,q.setState),Z("edgesFocusable",f,q.setState),Z("edgesUpdatable",h,q.setState),Z("elementsSelectable",x,q.setState),Z("elevateNodesOnSelect",g,q.setState),Z("snapToGrid",L,q.setState),Z("snapGrid",N,q.setState),Z("onNodesChange",_,q.setState),Z("onEdgesChange",C,q.setState),Z("connectOnClick",P,q.setState),Z("fitViewOnInit",j,q.setState),Z("fitViewOnInitOptions",F,q.setState),Z("onNodesDelete",R,q.setState),Z("onEdgesDelete",b,q.setState),Z("onNodeDrag",k,q.setState),Z("onNodeDragStart",S,q.setState),Z("onNodeDragStop",E,q.setState),Z("onSelectionDrag",I,q.setState),Z("onSelectionDragStart",T,q.setState),Z("onSelectionDragStop",A,q.setState),Z("noPanClassName",B,q.setState),Z("nodeOrigin",H,q.setState),Z("rfId",Y,q.setState),Z("autoPanOnConnect",U,q.setState),Z("autoPanOnNodeDrag",Q,q.setState),Z("onError",J,q.setState),Z("connectionRadius",ee,q.setState),Z("isValidConnection",ne,q.setState),Pt(e,V),Pt(t,D),Pt(m,ie),Pt(v,ue),Pt($,te),Pt(y,G),null},Nc={display:"none"},ux={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ch="react-flow__node-desc",uh="react-flow__edge-desc",lx="react-flow__aria-live",dx=e=>e.ariaLiveMessage;function fx({rfId:e}){const t=se(dx);return p.jsx("div",{id:`${lx}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:ux,children:t})}function hx({rfId:e,disableKeyboardA11y:t}){return p.jsxs(p.Fragment,{children:[p.jsxs("div",{id:`${ch}-${e}`,style:Nc,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),p.jsx("div",{id:`${uh}-${e}`,style:Nc,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&p.jsx(fx,{rfId:e})]})}const px=(e,t,n)=>n===z.Left?e-t:n===z.Right?e+t:e,gx=(e,t,n)=>n===z.Top?e-t:n===z.Bottom?e+t:e,Mc="react-flow__edgeupdater",Ic=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:o,onMouseOut:a,type:s})=>p.jsx("circle",{onMouseDown:i,onMouseEnter:o,onMouseOut:a,className:ve([Mc,`${Mc}-${s}`]),cx:px(t,r,e),cy:gx(n,r,e),r,stroke:"transparent",fill:"transparent"}),mx=()=>!0;var qt=e=>{const t=({id:n,className:r,type:i,data:o,onClick:a,onEdgeDoubleClick:s,selected:c,animated:l,label:u,labelStyle:d,labelShowBg:f,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:m,style:v,source:y,target:_,sourceX:C,sourceY:x,targetX:M,targetY:N,sourcePosition:L,targetPosition:$,elementsSelectable:P,hidden:O,sourceHandleId:j,targetHandleId:F,onContextMenu:R,onMouseEnter:b,onMouseMove:k,onMouseLeave:S,edgeUpdaterRadius:E,onEdgeUpdate:I,onEdgeUpdateStart:T,onEdgeUpdateEnd:A,markerEnd:B,markerStart:H,rfId:Y,ariaLabel:U,isFocusable:Q,isUpdatable:J,pathOptions:ee,interactionWidth:ne})=>{const V=w.useRef(null),[D,X]=w.useState(!1),[ie,ue]=w.useState(!1),te=ge(),G=w.useMemo(()=>`url(#${Ga(H,Y)})`,[H,Y]),oe=w.useMemo(()=>`url(#${Ga(B,Y)})`,[B,Y]);if(O)return null;const q=me=>{const{edges:Te,addSelectedEdges:He}=te.getState();if(P&&(te.setState({nodesSelectionActive:!1}),He([n])),a){const ye=Te.find(Ee=>Ee.id===n);a(me,ye)}},le=tn(n,te.getState,s),fe=tn(n,te.getState,R),Ye=tn(n,te.getState,b),Ne=tn(n,te.getState,k),he=tn(n,te.getState,S),ae=(me,Te)=>{if(me.button!==0)return;const{edges:He,isValidConnection:ye}=te.getState(),Ee=Te?_:y,Wt=(Te?F:j)||null,Zt=Te?"target":"source",Nr=ye||mx,Mr=Te,Qt=He.find(yt=>yt.id===n);ue(!0),T?.(me,Qt,Zt);const Ir=yt=>{ue(!1),A?.(yt,Qt,Zt)};eh({event:me,handleId:Wt,nodeId:Ee,onConnect:yt=>I?.(Qt,yt),isTarget:Mr,getState:te.getState,setState:te.setState,isValidConnection:Nr,edgeUpdaterType:Zt,onEdgeUpdateEnd:Ir})},we=me=>ae(me,!0),Me=me=>ae(me,!1),ze=()=>X(!0),Be=()=>X(!1),Re=!P&&!a,Ke=me=>{if(Hf.includes(me.key)&&P){const{unselectNodesAndEdges:Te,addSelectedEdges:He,edges:ye}=te.getState();me.key==="Escape"?(V.current?.blur(),Te({edges:[ye.find(Wt=>Wt.id===n)]})):He([n])}};return p.jsxs("g",{className:ve(["react-flow__edge",`react-flow__edge-${i}`,r,{selected:c,animated:l,inactive:Re,updating:D}]),onClick:q,onDoubleClick:le,onContextMenu:fe,onMouseEnter:Ye,onMouseMove:Ne,onMouseLeave:he,onKeyDown:Q?Ke:void 0,tabIndex:Q?0:void 0,role:Q?"button":void 0,"data-testid":`rf__edge-${n}`,"aria-label":U===null?void 0:U||`Edge from ${y} to ${_}`,"aria-describedby":Q?`${uh}-${Y}`:void 0,ref:V,children:[!ie&&p.jsx(e,{id:n,source:y,target:_,selected:c,animated:l,label:u,labelStyle:d,labelShowBg:f,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:m,data:o,style:v,sourceX:C,sourceY:x,targetX:M,targetY:N,sourcePosition:L,targetPosition:$,sourceHandleId:j,targetHandleId:F,markerStart:G,markerEnd:oe,pathOptions:ee,interactionWidth:ne}),J&&p.jsxs(p.Fragment,{children:[(J==="source"||J===!0)&&p.jsx(Ic,{position:L,centerX:C,centerY:x,radius:E,onMouseDown:we,onMouseEnter:ze,onMouseOut:Be,type:"source"}),(J==="target"||J===!0)&&p.jsx(Ic,{position:$,centerX:M,centerY:N,radius:E,onMouseDown:Me,onMouseEnter:ze,onMouseOut:Be,type:"target"})]})]})};return t.displayName="EdgeWrapper",w.memo(t)};function vx(e){const t={default:qt(e.default||rr),straight:qt(e.bezier||Ss),step:qt(e.step||Es),smoothstep:qt(e.step||br),simplebezier:qt(e.simplebezier||_s)},n={},r=Object.keys(e).filter(i=>!["default","bezier"].includes(i)).reduce((i,o)=>(i[o]=qt(e[o]||rr),i),n);return{...t,...r}}function kc(e,t,n=null){const r=(n?.x||0)+t.x,i=(n?.y||0)+t.y,o=n?.width||t.width,a=n?.height||t.height;switch(e){case z.Top:return{x:r+o/2,y:i};case z.Right:return{x:r+o,y:i+a/2};case z.Bottom:return{x:r+o/2,y:i+a};case z.Left:return{x:r,y:i+a/2}}}function Rc(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const yx=(e,t,n,r,i,o)=>{const a=kc(n,e,t),s=kc(o,r,i);return{sourceX:a.x,sourceY:a.y,targetX:s.x,targetY:s.y}};function bx({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:o,width:a,height:s,transform:c}){const l={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+i),y2:Math.max(e.y+r,t.y+o)};l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);const u=tr({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:a/c[2],height:s/c[2]}),d=Math.max(0,Math.min(u.x2,l.x2)-Math.max(u.x,l.x)),f=Math.max(0,Math.min(u.y2,l.y2)-Math.max(u.y,l.y));return Math.ceil(d*f)>0}function Tc(e){const t=e?.[de]?.handleBounds||null,n=t&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}function lh(e,t){if(!e.parentNode)return!1;const n=t.get(e.parentNode);return n?n.selected?!0:lh(n,t):!1}function Ac(e,t,n){let r=e;do{if(r?.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function xx(e,t,n,r){return Array.from(e.values()).filter(i=>(i.selected||i.id===r)&&(!i.parentNode||!lh(i,e))&&(i.draggable||t&&typeof i.draggable>"u")).map(i=>({id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:n.x-(i.positionAbsolute?.x??0),y:n.y-(i.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode,width:i.width,height:i.height}))}function dh(e,t,n,r,i=[0,0],o){let a=e.extent||r;if(e.extent==="parent")if(e.parentNode&&e.width&&e.height){const l=n.get(e.parentNode),{x:u,y:d}=It(l,i).positionAbsolute;a=l&&Le(u)&&Le(d)&&Le(l.width)&&Le(l.height)?[[u+e.width*i[0],d+e.height*i[1]],[u+l.width-e.width+e.width*i[0],d+l.height-e.height+e.height*i[1]]]:a}else o?.("005",gt.error005()),a=r;else if(e.extent&&e.parentNode){const l=n.get(e.parentNode),{x:u,y:d}=It(l,i).positionAbsolute;a=[[e.extent[0][0]+u,e.extent[0][1]+d],[e.extent[1][0]+u,e.extent[1][1]+d]]}let s={x:0,y:0};if(e.parentNode){const l=n.get(e.parentNode);s=It(l,i).positionAbsolute}const c=a?ws(t,a):t;return{position:{x:c.x-s.x,y:c.y-s.y},positionAbsolute:c}}function Fr({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(i=>({...n.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[e?r.find(i=>i.id===e):r[0],r]}const Lc=(e,t,n,r)=>{const i=t.querySelectorAll(e);if(!i||!i.length)return null;const o=Array.from(i),a=t.getBoundingClientRect(),s={x:a.width*r[0],y:a.height*r[1]};return o.map(c=>{const l=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(l.left-a.left-s.x)/n,y:(l.top-a.top-s.y)/n,...xs(c)}})};function nn(e,t,n){return n===void 0?n:r=>{const i=t().nodeInternals.get(e);n(r,{...i})}}function Ya({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:o,multiSelectionActive:a,nodeInternals:s}=t.getState(),c=s.get(e);t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&a)&&(o({nodes:[c]}),requestAnimationFrame(()=>r?.current?.blur())):i([e])}function wx(){const e=ge();return w.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:i,snapToGrid:o}=e.getState(),a=n.touches?n.touches[0].clientX:n.clientX,s=n.touches?n.touches[0].clientY:n.clientY,c={x:(a-r[0])/r[2],y:(s-r[1])/r[2]};return{xSnapped:o?i[0]*Math.round(c.x/i[0]):c.x,ySnapped:o?i[1]*Math.round(c.y/i[1]):c.y,...c}},[])}function Dr(e){return(t,n,r)=>e?.(t,r)}function fh({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:o,selectNodesOnDrag:a}){const s=ge(),[c,l]=w.useState(!1),u=w.useRef([]),d=w.useRef({x:null,y:null}),f=w.useRef(0),h=w.useRef(null),g=w.useRef({x:0,y:0}),m=w.useRef(null),v=w.useRef(!1),y=wx();return w.useEffect(()=>{if(e?.current){const _=Ae(e.current),C=({x:M,y:N})=>{const{nodeInternals:L,onNodeDrag:$,onSelectionDrag:P,updateNodePositions:O,nodeExtent:j,snapGrid:F,snapToGrid:R,nodeOrigin:b,onError:k}=s.getState();d.current={x:M,y:N};let S=!1;if(u.current=u.current.map(I=>{const T={x:M-I.distance.x,y:N-I.distance.y};R&&(T.x=F[0]*Math.round(T.x/F[0]),T.y=F[1]*Math.round(T.y/F[1]));const A=dh(I,T,L,j,b,k);return S=S||I.position.x!==A.position.x||I.position.y!==A.position.y,I.position=A.position,I.positionAbsolute=A.positionAbsolute,I}),!S)return;O(u.current,!0,!0),l(!0);const E=i?$:Dr(P);if(E&&m.current){const[I,T]=Fr({nodeId:i,dragItems:u.current,nodeInternals:L});E(m.current,I,T)}},x=()=>{if(!h.current)return;const[M,N]=Df(g.current,h.current);if(M!==0||N!==0){const{transform:L,panBy:$}=s.getState();d.current.x=(d.current.x??0)-M/L[2],d.current.y=(d.current.y??0)-N/L[2],C(d.current),$({x:M,y:N})}f.current=requestAnimationFrame(x)};if(t)_.on(".drag",null);else{const M=O0().on("start",N=>{const{nodeInternals:L,multiSelectionActive:$,domNode:P,nodesDraggable:O,unselectNodesAndEdges:j,onNodeDragStart:F,onSelectionDragStart:R}=s.getState(),b=i?F:Dr(R);!a&&!$&&i&&(L.get(i)?.selected||j()),i&&o&&a&&Ya({id:i,store:s,nodeRef:e});const k=y(N);if(d.current=k,u.current=xx(L,O,k,i),b&&u.current){const[S,E]=Fr({nodeId:i,dragItems:u.current,nodeInternals:L});b(N.sourceEvent,S,E)}h.current=P?.getBoundingClientRect()||null,g.current=ht(N.sourceEvent,h.current)}).on("drag",N=>{const L=y(N),{autoPanOnNodeDrag:$}=s.getState();!v.current&&$&&(v.current=!0,x()),(d.current.x!==L.xSnapped||d.current.y!==L.ySnapped)&&u.current&&(m.current=N.sourceEvent,g.current=ht(N.sourceEvent,h.current),C(L))}).on("end",N=>{if(l(!1),v.current=!1,cancelAnimationFrame(f.current),u.current){const{updateNodePositions:L,nodeInternals:$,onNodeDragStop:P,onSelectionDragStop:O}=s.getState(),j=i?P:Dr(O);if(L(u.current,!1,!1),j){const[F,R]=Fr({nodeId:i,dragItems:u.current,nodeInternals:$});j(N.sourceEvent,F,R)}}}).filter(N=>{const L=N.target;return!N.button&&(!n||!Ac(L,`.${n}`,e))&&(!r||Ac(L,r,e))});return _.call(M),()=>{_.on(".drag",null)}}}},[e,t,n,r,o,s,i,a,y]),c}function hh(){const e=ge();return w.useCallback(n=>{const{nodeInternals:r,nodeExtent:i,updateNodePositions:o,getNodes:a,snapToGrid:s,snapGrid:c,onError:l,nodesDraggable:u}=e.getState(),d=a().filter(_=>_.selected&&(_.draggable||u&&typeof _.draggable>"u")),f=s?c[0]:5,h=s?c[1]:5,g=n.isShiftPressed?4:1,m=n.x*f*g,v=n.y*h*g,y=d.map(_=>{if(_.positionAbsolute){const C={x:_.positionAbsolute.x+m,y:_.positionAbsolute.y+v};s&&(C.x=c[0]*Math.round(C.x/c[0]),C.y=c[1]*Math.round(C.y/c[1]));const{positionAbsolute:x,position:M}=dh(_,C,r,i,void 0,l);_.position=M,_.positionAbsolute=x}return _});o(y,!0,!1)},[])}const Ht={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var rn=e=>{const t=({id:n,type:r,data:i,xPos:o,yPos:a,xPosOrigin:s,yPosOrigin:c,selected:l,onClick:u,onMouseEnter:d,onMouseMove:f,onMouseLeave:h,onContextMenu:g,onDoubleClick:m,style:v,className:y,isDraggable:_,isSelectable:C,isConnectable:x,isFocusable:M,selectNodesOnDrag:N,sourcePosition:L,targetPosition:$,hidden:P,resizeObserver:O,dragHandle:j,zIndex:F,isParent:R,noDragClassName:b,noPanClassName:k,initialized:S,disableKeyboardA11y:E,ariaLabel:I,rfId:T})=>{const A=ge(),B=w.useRef(null),H=w.useRef(L),Y=w.useRef($),U=w.useRef(r),Q=C||_||u||d||f||h,J=hh(),ee=nn(n,A.getState,d),ne=nn(n,A.getState,f),V=nn(n,A.getState,h),D=nn(n,A.getState,g),X=nn(n,A.getState,m),ie=G=>{if(C&&(!N||!_)&&Ya({id:n,store:A,nodeRef:B}),u){const oe=A.getState().nodeInternals.get(n);u(G,{...oe})}},ue=G=>{if(!Ha(G))if(Hf.includes(G.key)&&C){const oe=G.key==="Escape";Ya({id:n,store:A,unselect:oe,nodeRef:B})}else!E&&_&&l&&Object.prototype.hasOwnProperty.call(Ht,G.key)&&(A.setState({ariaLiveMessage:`Moved selected node ${G.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~o}, y: ${~~a}`}),J({x:Ht[G.key].x,y:Ht[G.key].y,isShiftPressed:G.shiftKey}))};w.useEffect(()=>{if(B.current&&!P){const G=B.current;return O?.observe(G),()=>O?.unobserve(G)}},[P]),w.useEffect(()=>{const G=U.current!==r,oe=H.current!==L,q=Y.current!==$;B.current&&(G||oe||q)&&(G&&(U.current=r),oe&&(H.current=L),q&&(Y.current=$),A.getState().updateNodeDimensions([{id:n,nodeElement:B.current,forceUpdate:!0}]))},[n,r,L,$]);const te=fh({nodeRef:B,disabled:P||!_,noDragClassName:b,handleSelector:j,nodeId:n,isSelectable:C,selectNodesOnDrag:N});return P?null:p.jsx("div",{className:ve(["react-flow__node",`react-flow__node-${r}`,{[k]:_},y,{selected:l,selectable:C,parent:R,dragging:te}]),ref:B,style:{zIndex:F,transform:`translate(${s}px,${c}px)`,pointerEvents:Q?"all":"none",visibility:S?"visible":"hidden",...v},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:ee,onMouseMove:ne,onMouseLeave:V,onContextMenu:D,onClick:ie,onDoubleClick:X,onKeyDown:M?ue:void 0,tabIndex:M?0:void 0,role:M?"button":void 0,"aria-describedby":E?void 0:`${ch}-${T}`,"aria-label":I,children:p.jsx(Vb,{value:n,children:p.jsx(e,{id:n,data:i,type:r,xPos:o,yPos:a,selected:l,isConnectable:x,sourcePosition:L,targetPosition:$,dragging:te,dragHandle:j,zIndex:F})})})};return t.displayName="NodeWrapper",w.memo(t)};function _x(e){const t={input:rn(e.input||ih),default:rn(e.default||Ua),output:rn(e.output||ah),group:rn(e.group||Is)},n={},r=Object.keys(e).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,o)=>(i[o]=rn(e[o]||Ua),i),n);return{...t,...r}}const Ex=({x:e,y:t,width:n,height:r,origin:i})=>!n||!r?{x:e,y:t}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-n*i[0],y:t-r*i[1]},Sx=typeof document<"u"?document:null;var vn=(e=null,t={target:Sx})=>{const[n,r]=w.useState(!1),i=w.useRef(!1),o=w.useRef(new Set([])),[a,s]=w.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),u=l.reduce((d,f)=>d.concat(...f),[]);return[l,u]}return[[],[]]},[e]);return w.useEffect(()=>{if(e!==null){const c=d=>{if(i.current=d.ctrlKey||d.metaKey||d.shiftKey,!i.current&&Ha(d))return!1;const f=qc(d.code,s);o.current.add(d[f]),Pc(a,o.current,!1)&&(d.preventDefault(),r(!0))},l=d=>{if(!i.current&&Ha(d))return!1;const f=qc(d.code,s);Pc(a,o.current,!0)?(r(!1),o.current.clear()):o.current.delete(d[f]),i.current=!1},u=()=>{o.current.clear(),r(!1)};return t?.target?.addEventListener("keydown",c),t?.target?.addEventListener("keyup",l),window.addEventListener("blur",u),()=>{t?.target?.removeEventListener("keydown",c),t?.target?.removeEventListener("keyup",l),window.removeEventListener("blur",u)}}},[e,r]),n};function Pc(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(i=>t.has(i)))}function qc(e,t){return t.includes(e)?"code":"key"}function ph(e,t,n,r){if(!e.parentNode)return n;const i=t.get(e.parentNode),o=It(i,r);return ph(i,t,{x:(n.x??0)+o.x,y:(n.y??0)+o.y,z:(i[de]?.z??0)>(n.z??0)?i[de]?.z??0:n.z??0},r)}function gh(e,t,n){e.forEach(r=>{if(r.parentNode&&!e.has(r.parentNode))throw new Error(`Parent node ${r.parentNode} not found`);if(r.parentNode||n?.[r.id]){const{x:i,y:o,z:a}=ph(r,e,{...r.position,z:r[de]?.z??0},t);r.positionAbsolute={x:i,y:o},r[de].z=a,n?.[r.id]&&(r[de].isParent=!0)}})}function Or(e,t,n,r){const i=new Map,o={},a=r?1e3:0;return e.forEach(s=>{const c=(Le(s.zIndex)?s.zIndex:0)+(s.selected?a:0),l=t.get(s.id),u={width:l?.width,height:l?.height,...s,positionAbsolute:{x:s.position.x,y:s.position.y}};s.parentNode&&(u.parentNode=s.parentNode,o[s.parentNode]=!0),Object.defineProperty(u,de,{enumerable:!1,value:{handleBounds:l?.[de]?.handleBounds,z:c}}),i.set(s.id,u)}),gh(i,n,o),i}function mh(e,t={}){const{getNodes:n,width:r,height:i,minZoom:o,maxZoom:a,d3Zoom:s,d3Selection:c,fitViewOnInitDone:l,fitViewOnInit:u,nodeOrigin:d}=e(),f=t.initial&&!l&&u;if(s&&c&&(f||!t.initial)){const g=n().filter(v=>{const y=t.includeHiddenNodes?v.width&&v.height:!v.hidden;return t.nodes?.length?y&&t.nodes.some(_=>_.id===v.id):y}),m=g.every(v=>v.width&&v.height);if(g.length>0&&m){const v=Ms(g,d),[y,_,C]=Zf(v,r,i,t.minZoom??o,t.maxZoom??a,t.padding??.1),x=et.translate(y,_).scale(C);return typeof t.duration=="number"&&t.duration>0?s.transform(bt(c,t.duration),x):s.transform(c,x),!0}}return!1}function Cx(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[de]:r[de],selected:n.selected})}),new Map(t)}function Nx(e,t){return t.map(n=>{const r=e.find(i=>i.id===n.id);return r&&(n.selected=r.selected),n})}function Fn({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:i,edges:o,onNodesChange:a,onEdgesChange:s,hasDefaultNodes:c,hasDefaultEdges:l}=n();e?.length&&(c&&r({nodeInternals:Cx(e,i)}),a?.(e)),t?.length&&(l&&r({edges:Nx(t,o)}),s?.(t))}const $t=()=>{},Mx={zoomIn:$t,zoomOut:$t,zoomTo:$t,getZoom:()=>1,setViewport:$t,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:$t,fitBounds:$t,project:e=>e,viewportInitialized:!1},Ix=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),kx=()=>{const e=ge(),{d3Zoom:t,d3Selection:n}=se(Ix,_e);return w.useMemo(()=>n&&t?{zoomIn:i=>t.scaleBy(bt(n,i?.duration),1.2),zoomOut:i=>t.scaleBy(bt(n,i?.duration),1/1.2),zoomTo:(i,o)=>t.scaleTo(bt(n,o?.duration),i),getZoom:()=>e.getState().transform[2],setViewport:(i,o)=>{const[a,s,c]=e.getState().transform,l=et.translate(i.x??a,i.y??s).scale(i.zoom??c);t.transform(bt(n,o?.duration),l)},getViewport:()=>{const[i,o,a]=e.getState().transform;return{x:i,y:o,zoom:a}},fitView:i=>mh(e.getState,i),setCenter:(i,o,a)=>{const{width:s,height:c,maxZoom:l}=e.getState(),u=typeof a?.zoom<"u"?a.zoom:l,d=s/2-i*u,f=c/2-o*u,h=et.translate(d,f).scale(u);t.transform(bt(n,a?.duration),h)},fitBounds:(i,o)=>{const{width:a,height:s,minZoom:c,maxZoom:l}=e.getState(),[u,d,f]=Zf(i,a,s,c,l,o?.padding??.1),h=et.translate(u,d).scale(f);t.transform(bt(n,o?.duration),h)},project:i=>{const{transform:o,snapToGrid:a,snapGrid:s}=e.getState();return Kf(i,o,a,s)},viewportInitialized:!0}:Mx,[t,n])};function ks(){const e=kx(),t=ge(),n=w.useCallback(()=>t.getState().getNodes().map(m=>({...m})),[]),r=w.useCallback(m=>t.getState().nodeInternals.get(m),[]),i=w.useCallback(()=>{const{edges:m=[]}=t.getState();return m.map(v=>({...v}))},[]),o=w.useCallback(m=>{const{edges:v=[]}=t.getState();return v.find(y=>y.id===m)},[]),a=w.useCallback(m=>{const{getNodes:v,setNodes:y,hasDefaultNodes:_,onNodesChange:C}=t.getState(),x=v(),M=typeof m=="function"?m(x):m;if(_)y(M);else if(C){const N=M.length===0?x.map(L=>({type:"remove",id:L.id})):M.map(L=>({item:L,type:"reset"}));C(N)}},[]),s=w.useCallback(m=>{const{edges:v=[],setEdges:y,hasDefaultEdges:_,onEdgesChange:C}=t.getState(),x=typeof m=="function"?m(v):m;if(_)y(x);else if(C){const M=x.length===0?v.map(N=>({type:"remove",id:N.id})):x.map(N=>({item:N,type:"reset"}));C(M)}},[]),c=w.useCallback(m=>{const v=Array.isArray(m)?m:[m],{getNodes:y,setNodes:_,hasDefaultNodes:C,onNodesChange:x}=t.getState();if(C){const N=[...y(),...v];_(N)}else if(x){const M=v.map(N=>({item:N,type:"add"}));x(M)}},[]),l=w.useCallback(m=>{const v=Array.isArray(m)?m:[m],{edges:y=[],setEdges:_,hasDefaultEdges:C,onEdgesChange:x}=t.getState();if(C)_([...y,...v]);else if(x){const M=v.map(N=>({item:N,type:"add"}));x(M)}},[]),u=w.useCallback(()=>{const{getNodes:m,edges:v=[],transform:y}=t.getState(),[_,C,x]=y;return{nodes:m().map(M=>({...M})),edges:v.map(M=>({...M})),viewport:{x:_,y:C,zoom:x}}},[]),d=w.useCallback(({nodes:m,edges:v})=>{const{nodeInternals:y,getNodes:_,edges:C,hasDefaultNodes:x,hasDefaultEdges:M,onNodesDelete:N,onEdgesDelete:L,onNodesChange:$,onEdgesChange:P}=t.getState(),O=(m||[]).map(k=>k.id),j=(v||[]).map(k=>k.id),F=_().reduce((k,S)=>{const E=!O.includes(S.id)&&S.parentNode&&k.find(T=>T.id===S.parentNode);return(typeof S.deletable=="boolean"?S.deletable:!0)&&(O.includes(S.id)||E)&&k.push(S),k},[]),R=C.filter(k=>typeof k.deletable=="boolean"?k.deletable:!0),b=R.filter(k=>j.includes(k.id));if(F||b){const k=Wf(F,R),S=[...b,...k],E=S.reduce((I,T)=>(I.includes(T.id)||I.push(T.id),I),[]);if((M||x)&&(M&&t.setState({edges:C.filter(I=>!E.includes(I.id))}),x&&(F.forEach(I=>{y.delete(I.id)}),t.setState({nodeInternals:new Map(y)}))),E.length>0&&(L?.(S),P&&P(E.map(I=>({id:I,type:"remove"})))),F.length>0&&(N?.(F),$)){const I=F.map(T=>({id:T.id,type:"remove"}));$(I)}}},[]),f=w.useCallback(m=>{const v=$b(m),y=v?null:t.getState().nodeInternals.get(m.id);return[v?m:bc(y),y,v]},[]),h=w.useCallback((m,v=!0,y)=>{const[_,C,x]=f(m);return _?(y||t.getState().getNodes()).filter(M=>{if(!x&&(M.id===C.id||!M.positionAbsolute))return!1;const N=bc(M),L=Ba(N,_);return v&&L>0||L>=m.width*m.height}):[]},[]),g=w.useCallback((m,v,y=!0)=>{const[_]=f(m);if(!_)return!1;const C=Ba(_,v);return y&&C>0||C>=m.width*m.height},[]);return w.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:i,getEdge:o,setNodes:a,setEdges:s,addNodes:c,addEdges:l,toObject:u,deleteElements:d,getIntersectingNodes:h,isNodeIntersecting:g}),[e,n,r,i,o,a,s,c,l,u,d,h,g])}var Rx=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ge(),{deleteElements:r}=ks(),i=vn(e),o=vn(t);w.useEffect(()=>{if(i){const{edges:a,getNodes:s}=n.getState(),c=s().filter(u=>u.selected),l=a.filter(u=>u.selected);r({nodes:c,edges:l}),n.setState({nodesSelectionActive:!1})}},[i]),w.useEffect(()=>{n.setState({multiSelectionActive:o})},[o])};function Tx(e){const t=ge();w.useEffect(()=>{let n;const r=()=>{if(!e.current)return;const i=xs(e.current);(i.height===0||i.width===0)&&t.getState().onError?.("004",gt.error004()),t.setState({width:i.width||500,height:i.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const Rs={position:"absolute",width:"100%",height:"100%",top:0,left:0},Ax=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,zr=e=>({x:e.x,y:e.y,zoom:e.k}),jt=(e,t)=>e.target.closest(`.${t}`),$c=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Lx=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Px=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:i=!0,zoomOnPinch:o=!0,panOnScroll:a=!1,panOnScrollSpeed:s=.5,panOnScrollMode:c=Bt.Free,zoomOnDoubleClick:l=!0,elementsSelectable:u,panOnDrag:d=!0,defaultViewport:f,translateExtent:h,minZoom:g,maxZoom:m,zoomActivationKeyCode:v,preventScrolling:y=!0,children:_,noWheelClassName:C,noPanClassName:x})=>{const M=w.useRef(),N=ge(),L=w.useRef(!1),$=w.useRef(!1),P=w.useRef(null),O=w.useRef({x:0,y:0,zoom:0}),{d3Zoom:j,d3Selection:F,d3ZoomHandler:R,userSelectionActive:b}=se(Lx,_e),k=vn(v),S=w.useRef(0);return Tx(P),w.useEffect(()=>{if(P.current){const E=P.current.getBoundingClientRect(),I=jf().scaleExtent([g,m]).translateExtent(h),T=Ae(P.current).call(I),A=et.translate(f.x,f.y).scale(Yt(f.zoom,g,m)),B=[[0,0],[E.width,E.height]],H=I.constrain()(A,B,h);I.transform(T,H),N.setState({d3Zoom:I,d3Selection:T,d3ZoomHandler:T.on("wheel.zoom"),transform:[H.x,H.y,H.k],domNode:P.current.closest(".react-flow")})}},[]),w.useEffect(()=>{F&&j&&(a&&!k&&!b?F.on("wheel.zoom",E=>{if(jt(E,C))return!1;E.preventDefault(),E.stopImmediatePropagation();const I=F.property("__zoom").k||1;if(E.ctrlKey&&o){const H=qe(E),Y=-E.deltaY*(E.deltaMode===1?.05:E.deltaMode?1:.002)*10,U=I*Math.pow(2,Y);j.scaleTo(F,U,H);return}const T=E.deltaMode===1?20:1,A=c===Bt.Vertical?0:E.deltaX*T,B=c===Bt.Horizontal?0:E.deltaY*T;j.translateBy(F,-(A/I)*s,-(B/I)*s)},{passive:!1}):typeof R<"u"&&F.on("wheel.zoom",function(E,I){if(!y||jt(E,C))return null;E.preventDefault(),R.call(this,E,I)},{passive:!1}))},[b,a,c,F,j,R,k,o,y,C]),w.useEffect(()=>{j&&j.on("start",E=>{if(!E.sourceEvent)return null;S.current=E.sourceEvent.button;const{onViewportChangeStart:I}=N.getState();if(L.current=!0,E.sourceEvent?.type==="mousedown"&&N.setState({paneDragging:!0}),t||I){const T=zr(E.transform);O.current=T,I?.(T),t?.(E.sourceEvent,T)}})},[j,t]),w.useEffect(()=>{j&&(b&&!L.current?j.on("zoom",null):b||j.on("zoom",E=>{const{onViewportChange:I}=N.getState();if(N.setState({transform:[E.transform.x,E.transform.y,E.transform.k]}),$.current=!!(r&&$c(d,S.current??0)),e||I){const T=zr(E.transform);I?.(T),e?.(E.sourceEvent,T)}}))},[b,j,e,d,r]),w.useEffect(()=>{j&&j.on("end",E=>{if(!E.sourceEvent)return null;const{onViewportChangeEnd:I}=N.getState();if(L.current=!1,N.setState({paneDragging:!1}),r&&$c(d,S.current??0)&&!$.current&&r(E.sourceEvent),$.current=!1,(n||I)&&Ax(O.current,E.transform)){const T=zr(E.transform);O.current=T,clearTimeout(M.current),M.current=setTimeout(()=>{I?.(T),n?.(E.sourceEvent,T)},a?150:0)}})},[j,a,d,n,r]),w.useEffect(()=>{j&&j.filter(E=>{const I=k||i,T=o&&E.ctrlKey;if(E.button===1&&E.type==="mousedown"&&(jt(E,"react-flow__node")||jt(E,"react-flow__edge")))return!0;if(!d&&!I&&!a&&!l&&!o||b||!l&&E.type==="dblclick"||jt(E,C)&&E.type==="wheel"||jt(E,x)&&E.type!=="wheel"||!o&&E.ctrlKey&&E.type==="wheel"||!I&&!a&&!T&&E.type==="wheel"||!d&&(E.type==="mousedown"||E.type==="touchstart")||Array.isArray(d)&&!d.includes(E.button)&&(E.type==="mousedown"||E.type==="touchstart"))return!1;const A=Array.isArray(d)&&d.includes(E.button)||!E.button||E.button<=1;return(!E.ctrlKey||E.type==="wheel")&&A})},[b,j,i,o,a,l,d,u,k]),p.jsx("div",{className:"react-flow__renderer",ref:P,style:Rs,children:_})},qx=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function $x(){const{userSelectionActive:e,userSelectionRect:t}=se(qx,_e);return e&&t?p.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function jc(e,t){const n=e.find(r=>r.id===t.parentNode);if(n){const r=t.position.x+t.width-n.width,i=t.position.y+t.height-n.height;if(r>0||i>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,r>0&&(n.style.width+=r),i>0&&(n.style.height+=i),t.position.x<0){const o=Math.abs(t.position.x);n.position.x=n.position.x-o,n.style.width+=o,t.position.x=0}if(t.position.y<0){const o=Math.abs(t.position.y);n.position.y=n.position.y-o,n.style.height+=o,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function vh(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,i)=>{const o=e.filter(s=>s.id===i.id);if(o.length===0)return r.push(i),r;const a={...i};for(const s of o)if(s)switch(s.type){case"select":{a.selected=s.selected;break}case"position":{typeof s.position<"u"&&(a.position=s.position),typeof s.positionAbsolute<"u"&&(a.positionAbsolute=s.positionAbsolute),typeof s.dragging<"u"&&(a.dragging=s.dragging),a.expandParent&&jc(r,a);break}case"dimensions":{typeof s.dimensions<"u"&&(a.width=s.dimensions.width,a.height=s.dimensions.height),typeof s.updateStyle<"u"&&(a.style={...a.style||{},...s.dimensions}),typeof s.resizing=="boolean"&&(a.resizing=s.resizing),a.expandParent&&jc(r,a);break}case"remove":return r}return r.push(a),r},n)}function yh(e,t){return vh(e,t)}function jx(e,t){return vh(e,t)}const ut=(e,t)=>({id:e,type:"select",selected:t});function Ft(e,t){return e.reduce((n,r)=>{const i=t.includes(r.id);return!r.selected&&i?(r.selected=!0,n.push(ut(r.id,!0))):r.selected&&!i&&(r.selected=!1,n.push(ut(r.id,!1))),n},[])}const Br=(e,t)=>n=>{n.target===t.current&&e?.(n)},Fx=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),bh=w.memo(({isSelecting:e,selectionMode:t=mn.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:i,onPaneClick:o,onPaneContextMenu:a,onPaneScroll:s,onPaneMouseEnter:c,onPaneMouseMove:l,onPaneMouseLeave:u,children:d})=>{const f=w.useRef(null),h=ge(),g=w.useRef(0),m=w.useRef(0),v=w.useRef(),{userSelectionActive:y,elementsSelectable:_,dragging:C}=se(Fx,_e),x=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),g.current=0,m.current=0},M=R=>{o?.(R),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},N=R=>{if(Array.isArray(n)&&n?.includes(2)){R.preventDefault();return}a?.(R)},L=s?R=>s(R):void 0,$=R=>{const{resetSelectedElements:b,domNode:k}=h.getState();if(v.current=k?.getBoundingClientRect(),!_||!e||R.button!==0||R.target!==f.current||!v.current)return;const{x:S,y:E}=ht(R,v.current);b(),h.setState({userSelectionRect:{width:0,height:0,startX:S,startY:E,x:S,y:E}}),r?.(R)},P=R=>{const{userSelectionRect:b,nodeInternals:k,edges:S,transform:E,onNodesChange:I,onEdgesChange:T,nodeOrigin:A,getNodes:B}=h.getState();if(!e||!v.current||!b)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const H=ht(R,v.current),Y=b.startX??0,U=b.startY??0,Q={...b,x:H.x<Y?H.x:Y,y:H.y<U?H.y:U,width:Math.abs(H.x-Y),height:Math.abs(H.y-U)},J=B(),ee=Xf(k,Q,E,t===mn.Partial,!0,A),ne=Wf(ee,S).map(D=>D.id),V=ee.map(D=>D.id);if(g.current!==V.length){g.current=V.length;const D=Ft(J,V);D.length&&I?.(D)}if(m.current!==ne.length){m.current=ne.length;const D=Ft(S,ne);D.length&&T?.(D)}h.setState({userSelectionRect:Q})},O=R=>{if(R.button!==0)return;const{userSelectionRect:b}=h.getState();!y&&b&&R.target===f.current&&M?.(R),h.setState({nodesSelectionActive:g.current>0}),x(),i?.(R)},j=R=>{y&&(h.setState({nodesSelectionActive:g.current>0}),i?.(R)),x()},F=_&&(e||y);return p.jsxs("div",{className:ve(["react-flow__pane",{dragging:C,selection:e}]),onClick:F?void 0:Br(M,f),onContextMenu:Br(N,f),onWheel:Br(L,f),onMouseEnter:F?void 0:c,onMouseDown:F?$:void 0,onMouseMove:F?P:l,onMouseUp:F?O:void 0,onMouseLeave:F?j:u,ref:f,style:Rs,children:[d,p.jsx($x,{})]})});bh.displayName="Pane";const Dx=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Ms(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Ox({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ge(),{width:i,height:o,x:a,y:s,transformString:c,userSelectionActive:l}=se(Dx,_e),u=hh(),d=w.useRef(null);if(w.useEffect(()=>{n||d.current?.focus({preventScroll:!0})},[n]),fh({nodeRef:d}),l||!i||!o)return null;const f=e?g=>{const m=r.getState().getNodes().filter(v=>v.selected);e(g,m)}:void 0,h=g=>{Object.prototype.hasOwnProperty.call(Ht,g.key)&&u({x:Ht[g.key].x,y:Ht[g.key].y,isShiftPressed:g.shiftKey})};return p.jsx("div",{className:ve(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c},children:p.jsx("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:f,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:i,height:o,top:s,left:a}})})}var zx=w.memo(Ox);const Bx=e=>e.nodesSelectionActive,xh=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:o,onPaneScroll:a,deleteKeyCode:s,onMove:c,onMoveStart:l,onMoveEnd:u,selectionKeyCode:d,selectionOnDrag:f,selectionMode:h,onSelectionStart:g,onSelectionEnd:m,multiSelectionKeyCode:v,panActivationKeyCode:y,zoomActivationKeyCode:_,elementsSelectable:C,zoomOnScroll:x,zoomOnPinch:M,panOnScroll:N,panOnScrollSpeed:L,panOnScrollMode:$,zoomOnDoubleClick:P,panOnDrag:O,defaultViewport:j,translateExtent:F,minZoom:R,maxZoom:b,preventScrolling:k,onSelectionContextMenu:S,noWheelClassName:E,noPanClassName:I,disableKeyboardA11y:T})=>{const A=se(Bx),B=vn(d),Y=vn(y)||O,U=B||f&&Y!==!0;return Rx({deleteKeyCode:s,multiSelectionKeyCode:v}),p.jsx(Px,{onMove:c,onMoveStart:l,onMoveEnd:u,onPaneContextMenu:o,elementsSelectable:C,zoomOnScroll:x,zoomOnPinch:M,panOnScroll:N,panOnScrollSpeed:L,panOnScrollMode:$,zoomOnDoubleClick:P,panOnDrag:!B&&Y,defaultViewport:j,translateExtent:F,minZoom:R,maxZoom:b,zoomActivationKeyCode:_,preventScrolling:k,noWheelClassName:E,noPanClassName:I,children:p.jsxs(bh,{onSelectionStart:g,onSelectionEnd:m,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:o,onPaneScroll:a,panOnDrag:Y,isSelecting:!!U,selectionMode:h,children:[e,A&&p.jsx(zx,{onSelectionContextMenu:S,noPanClassName:I,disableKeyboardA11y:T})]})})};xh.displayName="FlowRenderer";var Hx=w.memo(xh);function Vx(e){return se(w.useCallback(n=>e?Xf(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}const Gx=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),wh=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,updateNodeDimensions:o,onError:a}=se(Gx,_e),s=Vx(e.onlyRenderVisibleElements),c=w.useRef(),l=w.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(d=>{const f=d.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));o(f)});return c.current=u,u},[]);return w.useEffect(()=>()=>{c?.current?.disconnect()},[]),p.jsx("div",{className:"react-flow__nodes",style:Rs,children:s.map(u=>{let d=u.type||"default";e.nodeTypes[d]||(a?.("003",gt.error003(d)),d="default");const f=e.nodeTypes[d]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),g=!!(u.selectable||i&&typeof u.selectable>"u"),m=!!(u.connectable||n&&typeof u.connectable>"u"),v=!!(u.focusable||r&&typeof u.focusable>"u"),y=e.nodeExtent?ws(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,_=y?.x??0,C=y?.y??0,x=Ex({x:_,y:C,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return p.jsx(f,{id:u.id,className:u.className,style:u.style,type:d,data:u.data,sourcePosition:u.sourcePosition||z.Bottom,targetPosition:u.targetPosition||z.Top,hidden:u.hidden,xPos:_,yPos:C,xPosOrigin:x.x,yPosOrigin:x.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:g,isConnectable:m,isFocusable:v,resizeObserver:l,dragHandle:u.dragHandle,zIndex:u[de]?.z??0,isParent:!!u[de]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel},u.id)})})};wh.displayName="NodeRenderer";var Ux=w.memo(wh);const Yx=[{level:0,isMaxLevel:!0,edges:[]}];function Kx(e,t,n=!1){let r=-1;const i=e.reduce((a,s)=>{const c=Le(s.zIndex);let l=c?s.zIndex:0;return n&&(l=c?s.zIndex:Math.max(t.get(s.source)?.[de]?.z||0,t.get(s.target)?.[de]?.z||0)),a[l]?a[l].push(s):a[l]=[s],r=l>r?l:r,a},{}),o=Object.entries(i).map(([a,s])=>{const c=+a;return{edges:s,level:c,isMaxLevel:c===r}});return o.length===0?Yx:o}function Xx(e,t,n){const r=se(w.useCallback(i=>e?i.edges.filter(o=>{const a=t.get(o.source),s=t.get(o.target);return a?.width&&a?.height&&s?.width&&s?.height&&bx({sourcePos:a.positionAbsolute||{x:0,y:0},targetPos:s.positionAbsolute||{x:0,y:0},sourceWidth:a.width,sourceHeight:a.height,targetWidth:s.width,targetHeight:s.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[e,t]));return Kx(r,t,n)}const Wx=({color:e="none",strokeWidth:t=1})=>p.jsx("polyline",{stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,fill:"none",points:"-5,-4 0,0 -5,4"}),Zx=({color:e="none",strokeWidth:t=1})=>p.jsx("polyline",{stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,fill:e,points:"-5,-4 0,0 -5,4 -5,-4"}),Fc={[nr.Arrow]:Wx,[nr.ArrowClosed]:Zx};function Qx(e){const t=ge();return w.useMemo(()=>Object.prototype.hasOwnProperty.call(Fc,e)?Fc[e]:(t.getState().onError?.("009",gt.error009(e)),null),[e])}const Jx=({id:e,type:t,color:n,width:r=12.5,height:i=12.5,markerUnits:o="strokeWidth",strokeWidth:a,orient:s="auto-start-reverse"})=>{const c=Qx(t);return c?p.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:s,refX:"0",refY:"0",children:p.jsx(c,{color:n,strokeWidth:a})}):null},ew=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((i,o)=>([o.markerStart,o.markerEnd].forEach(a=>{if(a&&typeof a=="object"){const s=Ga(a,t);r.includes(s)||(i.push({id:s,color:a.color||e,...a}),r.push(s))}}),i),[]).sort((i,o)=>i.id.localeCompare(o.id))},_h=({defaultColor:e,rfId:t})=>{const n=se(w.useCallback(ew({defaultColor:e,rfId:t}),[e,t]),(r,i)=>!(r.length!==i.length||r.some((o,a)=>o.id!==i[a].id)));return p.jsx("defs",{children:n.map(r=>p.jsx(Jx,{id:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient},r.id))})};_h.displayName="MarkerDefinitions";var tw=w.memo(_h);const nw=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Eh=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:i,noPanClassName:o,onEdgeUpdate:a,onEdgeContextMenu:s,onEdgeMouseEnter:c,onEdgeMouseMove:l,onEdgeMouseLeave:u,onEdgeClick:d,edgeUpdaterRadius:f,onEdgeDoubleClick:h,onEdgeUpdateStart:g,onEdgeUpdateEnd:m,children:v})=>{const{edgesFocusable:y,edgesUpdatable:_,elementsSelectable:C,width:x,height:M,connectionMode:N,nodeInternals:L,onError:$}=se(nw,_e),P=Xx(t,L,n);return x?p.jsxs(p.Fragment,{children:[P.map(({level:O,edges:j,isMaxLevel:F})=>p.jsxs("svg",{style:{zIndex:O},width:x,height:M,className:"react-flow__edges react-flow__container",children:[F&&p.jsx(tw,{defaultColor:e,rfId:r}),p.jsx("g",{children:j.map(R=>{const[b,k,S]=Tc(L.get(R.source)),[E,I,T]=Tc(L.get(R.target));if(!S||!T)return null;let A=R.type||"default";i[A]||($?.("011",gt.error011(A)),A="default");const B=i[A]||i.default,H=N===Tt.Strict?I.target:(I.target??[]).concat(I.source??[]),Y=Rc(k.source,R.sourceHandle),U=Rc(H,R.targetHandle),Q=Y?.position||z.Bottom,J=U?.position||z.Top,ee=!!(R.focusable||y&&typeof R.focusable>"u"),ne=typeof a<"u"&&(R.updatable||_&&typeof R.updatable>"u");if(!Y||!U)return $?.("008",gt.error008(Y,R)),null;const{sourceX:V,sourceY:D,targetX:X,targetY:ie}=yx(b,Y,Q,E,U,J);return p.jsx(B,{id:R.id,className:ve([R.className,o]),type:A,data:R.data,selected:!!R.selected,animated:!!R.animated,hidden:!!R.hidden,label:R.label,labelStyle:R.labelStyle,labelShowBg:R.labelShowBg,labelBgStyle:R.labelBgStyle,labelBgPadding:R.labelBgPadding,labelBgBorderRadius:R.labelBgBorderRadius,style:R.style,source:R.source,target:R.target,sourceHandleId:R.sourceHandle,targetHandleId:R.targetHandle,markerEnd:R.markerEnd,markerStart:R.markerStart,sourceX:V,sourceY:D,targetX:X,targetY:ie,sourcePosition:Q,targetPosition:J,elementsSelectable:C,onEdgeUpdate:a,onContextMenu:s,onMouseEnter:c,onMouseMove:l,onMouseLeave:u,onClick:d,edgeUpdaterRadius:f,onEdgeDoubleClick:h,onEdgeUpdateStart:g,onEdgeUpdateEnd:m,rfId:r,ariaLabel:R.ariaLabel,isFocusable:ee,isUpdatable:ne,pathOptions:"pathOptions"in R?R.pathOptions:void 0,interactionWidth:R.interactionWidth},R.id)})})]},O)),v]}):null};Eh.displayName="EdgeRenderer";var rw=w.memo(Eh);const iw=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function ow({children:e}){const t=se(iw);return p.jsx("div",{className:"react-flow__viewport react-flow__container",style:{transform:t},children:e})}function aw(e){const t=ks(),n=w.useRef(!1);w.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const sw={[z.Left]:z.Right,[z.Right]:z.Left,[z.Top]:z.Bottom,[z.Bottom]:z.Top},Sh=({nodeId:e,handleType:t,style:n,type:r=lt.Bezier,CustomComponent:i,connectionStatus:o})=>{const{fromNode:a,handleId:s,toX:c,toY:l,connectionMode:u}=se(w.useCallback(N=>({fromNode:N.nodeInternals.get(e),handleId:N.connectionHandleId,toX:(N.connectionPosition.x-N.transform[0])/N.transform[2],toY:(N.connectionPosition.y-N.transform[1])/N.transform[2],connectionMode:N.connectionMode}),[e]),_e),d=a?.[de]?.handleBounds;let f=d?.[t];if(u===Tt.Loose&&(f=f||d?.[t==="source"?"target":"source"]),!a||!f)return null;const h=s?f.find(N=>N.id===s):f[0],g=h?h.x+h.width/2:(a.width??0)/2,m=h?h.y+h.height/2:a.height??0,v=(a.positionAbsolute?.x??0)+g,y=(a.positionAbsolute?.y??0)+m,_=h?.position,C=_?sw[_]:null;if(!_||!C)return null;if(i)return p.jsx(i,{connectionLineType:r,connectionLineStyle:n,fromNode:a,fromHandle:h,fromX:v,fromY:y,toX:c,toY:l,fromPosition:_,toPosition:C,connectionStatus:o});let x="";const M={sourceX:v,sourceY:y,sourcePosition:_,targetX:c,targetY:l,targetPosition:C};return r===lt.Bezier?[x]=Cs(M):r===lt.Step?[x]=Va({...M,borderRadius:0}):r===lt.SmoothStep?[x]=Va(M):r===lt.SimpleBezier?[x]=Yf(M):x=`M${v},${y} ${c},${l}`,p.jsx("path",{d:x,fill:"none",className:"react-flow__connection-path",style:n})};Sh.displayName="ConnectionLine";const cw=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function uw({containerStyle:e,style:t,type:n,component:r}){const{nodeId:i,handleType:o,nodesConnectable:a,width:s,height:c,connectionStatus:l}=se(cw,_e);return!(i&&o&&s&&a)?null:p.jsx("svg",{style:e,width:s,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container",children:p.jsx("g",{className:ve(["react-flow__connection",l]),children:p.jsx(Sh,{nodeId:i,handleType:o,style:t,type:n,CustomComponent:r,connectionStatus:l})})})}const Ch=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:i,onInit:o,onNodeClick:a,onEdgeClick:s,onNodeDoubleClick:c,onEdgeDoubleClick:l,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:h,onSelectionContextMenu:g,onSelectionStart:m,onSelectionEnd:v,connectionLineType:y,connectionLineStyle:_,connectionLineComponent:C,connectionLineContainerStyle:x,selectionKeyCode:M,selectionOnDrag:N,selectionMode:L,multiSelectionKeyCode:$,panActivationKeyCode:P,zoomActivationKeyCode:O,deleteKeyCode:j,onlyRenderVisibleElements:F,elementsSelectable:R,selectNodesOnDrag:b,defaultViewport:k,translateExtent:S,minZoom:E,maxZoom:I,preventScrolling:T,defaultMarkerColor:A,zoomOnScroll:B,zoomOnPinch:H,panOnScroll:Y,panOnScrollSpeed:U,panOnScrollMode:Q,zoomOnDoubleClick:J,panOnDrag:ee,onPaneClick:ne,onPaneMouseEnter:V,onPaneMouseMove:D,onPaneMouseLeave:X,onPaneScroll:ie,onPaneContextMenu:ue,onEdgeUpdate:te,onEdgeContextMenu:G,onEdgeMouseEnter:oe,onEdgeMouseMove:q,onEdgeMouseLeave:le,edgeUpdaterRadius:fe,onEdgeUpdateStart:Ye,onEdgeUpdateEnd:Ne,noDragClassName:he,noWheelClassName:ae,noPanClassName:we,elevateEdgesOnSelect:Me,disableKeyboardA11y:ze,nodeOrigin:Be,nodeExtent:Re,rfId:Ke})=>(aw(o),p.jsx(Hx,{onPaneClick:ne,onPaneMouseEnter:V,onPaneMouseMove:D,onPaneMouseLeave:X,onPaneContextMenu:ue,onPaneScroll:ie,deleteKeyCode:j,selectionKeyCode:M,selectionOnDrag:N,selectionMode:L,onSelectionStart:m,onSelectionEnd:v,multiSelectionKeyCode:$,panActivationKeyCode:P,zoomActivationKeyCode:O,elementsSelectable:R,onMove:n,onMoveStart:r,onMoveEnd:i,zoomOnScroll:B,zoomOnPinch:H,zoomOnDoubleClick:J,panOnScroll:Y,panOnScrollSpeed:U,panOnScrollMode:Q,panOnDrag:ee,defaultViewport:k,translateExtent:S,minZoom:E,maxZoom:I,onSelectionContextMenu:g,preventScrolling:T,noDragClassName:he,noWheelClassName:ae,noPanClassName:we,disableKeyboardA11y:ze,children:p.jsxs(ow,{children:[p.jsx(rw,{edgeTypes:t,onEdgeClick:s,onEdgeDoubleClick:l,onEdgeUpdate:te,onlyRenderVisibleElements:F,onEdgeContextMenu:G,onEdgeMouseEnter:oe,onEdgeMouseMove:q,onEdgeMouseLeave:le,onEdgeUpdateStart:Ye,onEdgeUpdateEnd:Ne,edgeUpdaterRadius:fe,defaultMarkerColor:A,noPanClassName:we,elevateEdgesOnSelect:!!Me,disableKeyboardA11y:ze,rfId:Ke,children:p.jsx(uw,{style:_,type:y,component:C,containerStyle:x})}),p.jsx("div",{className:"react-flow__edgelabel-renderer"}),p.jsx(Ux,{nodeTypes:e,onNodeClick:a,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:h,selectNodesOnDrag:b,onlyRenderVisibleElements:F,noPanClassName:we,noDragClassName:he,disableKeyboardA11y:ze,nodeOrigin:Be,nodeExtent:Re,rfId:Ke})]})}));Ch.displayName="GraphView";var lw=w.memo(Ch);const Ka=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ot={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Ka,nodeExtent:Ka,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Tt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:jb,isValidConnection:void 0},dw=()=>Rm((e,t)=>({...ot,setNodes:n=>{const{nodeInternals:r,nodeOrigin:i,elevateNodesOnSelect:o}=t();e({nodeInternals:Or(n,r,i,o)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(i=>({...r,...i}))})},setDefaultNodesAndEdges:(n,r)=>{const i=typeof n<"u",o=typeof r<"u",a=i?Or(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:a,edges:o?r:[],hasDefaultNodes:i,hasDefaultEdges:o})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:i,fitViewOnInit:o,fitViewOnInitDone:a,fitViewOnInitOptions:s,domNode:c,nodeOrigin:l}=t(),u=c?.querySelector(".react-flow__viewport");if(!u)return;const d=window.getComputedStyle(u),{m22:f}=new window.DOMMatrixReadOnly(d.transform),h=n.reduce((m,v)=>{const y=i.get(v.id);if(y){const _=xs(v.nodeElement);!!(_.width&&_.height&&(y.width!==_.width||y.height!==_.height||v.forceUpdate))&&(i.set(y.id,{...y,[de]:{...y[de],handleBounds:{source:Lc(".source",v.nodeElement,f,l),target:Lc(".target",v.nodeElement,f,l)}},..._}),m.push({id:y.id,type:"dimensions",dimensions:_}))}return m},[]);gh(i,l);const g=a||o&&!a&&mh(t,{initial:!0,...s});e({nodeInternals:new Map(i),fitViewOnInitDone:g}),h?.length>0&&r?.(h)},updateNodePositions:(n,r=!0,i=!1)=>{const{triggerNodeChanges:o}=t(),a=n.map(s=>{const c={id:s.id,type:"position",dragging:i};return r&&(c.positionAbsolute=s.positionAbsolute,c.position=s.position),c});o(a)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:i,hasDefaultNodes:o,nodeOrigin:a,getNodes:s,elevateNodesOnSelect:c}=t();if(n?.length){if(o){const l=yh(n,s()),u=Or(l,i,a,c);e({nodeInternals:u})}r?.(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:i,getNodes:o}=t();let a,s=null;r?a=n.map(c=>ut(c,!0)):(a=Ft(o(),n),s=Ft(i,[])),Fn({changedNodes:a,changedEdges:s,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:i,getNodes:o}=t();let a,s=null;r?a=n.map(c=>ut(c,!0)):(a=Ft(i,n),s=Ft(o(),[])),Fn({changedNodes:s,changedEdges:a,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:i,getNodes:o}=t(),a=n||o(),s=r||i,c=a.map(u=>(u.selected=!1,ut(u.id,!1))),l=s.map(u=>ut(u.id,!1));Fn({changedNodes:c,changedEdges:l,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:i}=t();r?.scaleExtent([n,i]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:i}=t();r?.scaleExtent([i,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),o=r().filter(s=>s.selected).map(s=>ut(s.id,!1)),a=n.filter(s=>s.selected).map(s=>ut(s.id,!1));Fn({changedNodes:o,changedEdges:a,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(i=>{i.positionAbsolute=ws(i.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:i,height:o,d3Zoom:a,d3Selection:s,translateExtent:c}=t();if(!a||!s||!n.x&&!n.y)return;const l=et.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),u=[[0,0],[i,o]],d=a?.constrain()(l,u,c);a.transform(s,d)},cancelConnection:()=>e({connectionNodeId:ot.connectionNodeId,connectionHandleId:ot.connectionHandleId,connectionHandleType:ot.connectionHandleType,connectionStatus:ot.connectionStatus,connectionStartHandle:ot.connectionStartHandle,connectionEndHandle:ot.connectionEndHandle}),reset:()=>e({...ot})})),Nh=({children:e})=>{const t=w.useRef(null);return t.current||(t.current=dw()),p.jsx(Rb,{value:t.current,children:e})};Nh.displayName="ReactFlowProvider";const Mh=({children:e})=>w.useContext(yr)?p.jsx(p.Fragment,{children:e}):p.jsx(Nh,{children:e});Mh.displayName="ReactFlowWrapper";function Dc(e,t){return w.useRef(null),w.useMemo(()=>t(e),[e])}const fw={input:ih,default:Ua,output:ah,group:Is},hw={default:rr,straight:Ss,step:Es,smoothstep:br,simplebezier:_s},pw=[0,0],gw=[15,15],mw={x:0,y:0,zoom:1},vw={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Ih=w.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:o=fw,edgeTypes:a=hw,onNodeClick:s,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:h,onConnectStart:g,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:y,onNodeMouseEnter:_,onNodeMouseMove:C,onNodeMouseLeave:x,onNodeContextMenu:M,onNodeDoubleClick:N,onNodeDragStart:L,onNodeDrag:$,onNodeDragStop:P,onNodesDelete:O,onEdgesDelete:j,onSelectionChange:F,onSelectionDragStart:R,onSelectionDrag:b,onSelectionDragStop:k,onSelectionContextMenu:S,onSelectionStart:E,onSelectionEnd:I,connectionMode:T=Tt.Strict,connectionLineType:A=lt.Bezier,connectionLineStyle:B,connectionLineComponent:H,connectionLineContainerStyle:Y,deleteKeyCode:U="Backspace",selectionKeyCode:Q="Shift",selectionOnDrag:J=!1,selectionMode:ee=mn.Full,panActivationKeyCode:ne="Space",multiSelectionKeyCode:V="Meta",zoomActivationKeyCode:D="Meta",snapToGrid:X=!1,snapGrid:ie=gw,onlyRenderVisibleElements:ue=!1,selectNodesOnDrag:te=!0,nodesDraggable:G,nodesConnectable:oe,nodesFocusable:q,nodeOrigin:le=pw,edgesFocusable:fe,edgesUpdatable:Ye,elementsSelectable:Ne,defaultViewport:he=mw,minZoom:ae=.5,maxZoom:we=2,translateExtent:Me=Ka,preventScrolling:ze=!0,nodeExtent:Be,defaultMarkerColor:Re="#b1b1b7",zoomOnScroll:Ke=!0,zoomOnPinch:me=!0,panOnScroll:Te=!1,panOnScrollSpeed:He=.5,panOnScrollMode:ye=Bt.Free,zoomOnDoubleClick:Ee=!0,panOnDrag:Wt=!0,onPaneClick:Zt,onPaneMouseEnter:Nr,onPaneMouseMove:Mr,onPaneMouseLeave:Qt,onPaneScroll:Ir,onPaneContextMenu:zs,children:yt,onEdgeUpdate:qp,onEdgeContextMenu:$p,onEdgeDoubleClick:jp,onEdgeMouseEnter:Fp,onEdgeMouseMove:Dp,onEdgeMouseLeave:Op,onEdgeUpdateStart:zp,onEdgeUpdateEnd:Bp,edgeUpdaterRadius:Hp=10,onNodesChange:Vp,onEdgesChange:Gp,noDragClassName:Up="nodrag",noWheelClassName:Yp="nowheel",noPanClassName:Bs="nopan",fitView:Kp=!1,fitViewOptions:Xp,connectOnClick:Wp=!0,attributionPosition:Zp,proOptions:Qp,defaultEdgeOptions:Jp,elevateNodesOnSelect:eg=!0,elevateEdgesOnSelect:tg=!1,disableKeyboardA11y:Hs=!1,autoPanOnConnect:ng=!0,autoPanOnNodeDrag:rg=!0,connectionRadius:ig=20,isValidConnection:og,onError:ag,style:sg,id:Vs,...cg},ug)=>{const lg=Dc(o,_x),dg=Dc(a,vx),kr=Vs||"1";return p.jsx("div",{...cg,style:{...sg,...vw},ref:ug,className:ve(["react-flow",i]),"data-testid":"rf__wrapper",id:Vs,children:p.jsxs(Mh,{children:[p.jsx(lw,{onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:_,onNodeMouseMove:C,onNodeMouseLeave:x,onNodeContextMenu:M,onNodeDoubleClick:N,nodeTypes:lg,edgeTypes:dg,connectionLineType:A,connectionLineStyle:B,connectionLineComponent:H,connectionLineContainerStyle:Y,selectionKeyCode:Q,selectionOnDrag:J,selectionMode:ee,deleteKeyCode:U,multiSelectionKeyCode:V,panActivationKeyCode:ne,zoomActivationKeyCode:D,onlyRenderVisibleElements:ue,selectNodesOnDrag:te,defaultViewport:he,translateExtent:Me,minZoom:ae,maxZoom:we,preventScrolling:ze,zoomOnScroll:Ke,zoomOnPinch:me,zoomOnDoubleClick:Ee,panOnScroll:Te,panOnScrollSpeed:He,panOnScrollMode:ye,panOnDrag:Wt,onPaneClick:Zt,onPaneMouseEnter:Nr,onPaneMouseMove:Mr,onPaneMouseLeave:Qt,onPaneScroll:Ir,onPaneContextMenu:zs,onSelectionContextMenu:S,onSelectionStart:E,onSelectionEnd:I,onEdgeUpdate:qp,onEdgeContextMenu:$p,onEdgeDoubleClick:jp,onEdgeMouseEnter:Fp,onEdgeMouseMove:Dp,onEdgeMouseLeave:Op,onEdgeUpdateStart:zp,onEdgeUpdateEnd:Bp,edgeUpdaterRadius:Hp,defaultMarkerColor:Re,noDragClassName:Up,noWheelClassName:Yp,noPanClassName:Bs,elevateEdgesOnSelect:tg,rfId:kr,disableKeyboardA11y:Hs,nodeOrigin:le,nodeExtent:Be}),p.jsx(cx,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:g,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:y,nodesDraggable:G,nodesConnectable:oe,nodesFocusable:q,edgesFocusable:fe,edgesUpdatable:Ye,elementsSelectable:Ne,elevateNodesOnSelect:eg,minZoom:ae,maxZoom:we,nodeExtent:Be,onNodesChange:Vp,onEdgesChange:Gp,snapToGrid:X,snapGrid:ie,connectionMode:T,translateExtent:Me,connectOnClick:Wp,defaultEdgeOptions:Jp,fitView:Kp,fitViewOptions:Xp,onNodesDelete:O,onEdgesDelete:j,onNodeDragStart:L,onNodeDrag:$,onNodeDragStop:P,onSelectionDrag:b,onSelectionDragStart:R,onSelectionDragStop:k,noPanClassName:Bs,nodeOrigin:le,rfId:kr,autoPanOnConnect:ng,autoPanOnNodeDrag:rg,onError:ag,connectionRadius:ig,isValidConnection:og}),p.jsx(ax,{onSelectionChange:F}),yt,p.jsx(Ab,{proOptions:Qp,position:Zp}),p.jsx(hx,{rfId:kr,disableKeyboardA11y:Hs})]})})});Ih.displayName="ReactFlow";function kh(e){return t=>{const[n,r]=w.useState(t),i=w.useCallback(o=>r(a=>e(o,a)),[]);return[n,r,i]}}const yw=kh(yh),bw=kh(jx),Rh=({id:e,x:t,y:n,width:r,height:i,style:o,color:a,strokeColor:s,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,onClick:f})=>{const{background:h,backgroundColor:g}=o||{},m=a||h||g;return p.jsx("rect",{className:ve(["react-flow__minimap-node",l]),x:t,y:n,rx:u,ry:u,width:r,height:i,fill:m,stroke:s,strokeWidth:c,shapeRendering:d,onClick:f?v=>f(v,e):void 0})};Rh.displayName="MiniMapNode";var xw=w.memo(Rh);const ww=200,_w=150,Ew=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{nodes:t.filter(r=>!r.hidden&&r.width&&r.height),viewBB:n,boundingRect:t.length>0?qb(Ms(t,e.nodeOrigin),n):n,rfId:e.rfId,nodeOrigin:e.nodeOrigin}},Hr=e=>e instanceof Function?e:()=>e,Sw="react-flow__minimap-desc";function Th({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:i="",nodeBorderRadius:o=5,nodeStrokeWidth:a=2,nodeComponent:s=xw,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:l="none",maskStrokeWidth:u=1,position:d="bottom-right",onClick:f,onNodeClick:h,pannable:g=!1,zoomable:m=!1,ariaLabel:v="React Flow mini map",inversePan:y=!1,zoomStep:_=10}){const C=ge(),x=w.useRef(null),{boundingRect:M,viewBB:N,nodes:L,rfId:$,nodeOrigin:P}=se(Ew,_e),O=e?.width??ww,j=e?.height??_w,F=Hr(r),R=Hr(n),b=Hr(i),k=M.width/O,S=M.height/j,E=Math.max(k,S),I=E*O,T=E*j,A=5*E,B=M.x-(I-M.width)/2-A,H=M.y-(T-M.height)/2-A,Y=I+A*2,U=T+A*2,Q=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision",J=`${Sw}-${$}`,ee=w.useRef(0);ee.current=E,w.useEffect(()=>{if(x.current){const D=Ae(x.current),X=te=>{const{transform:G,d3Selection:oe,d3Zoom:q}=C.getState();if(te.sourceEvent.type!=="wheel"||!oe||!q)return;const le=-te.sourceEvent.deltaY*(te.sourceEvent.deltaMode===1?.05:te.sourceEvent.deltaMode?1:.002)*_,fe=G[2]*Math.pow(2,le);q.scaleTo(oe,fe)},ie=te=>{const{transform:G,d3Selection:oe,d3Zoom:q,translateExtent:le,width:fe,height:Ye}=C.getState();if(te.sourceEvent.type!=="mousemove"||!oe||!q)return;const Ne=ee.current*Math.max(1,G[2])*(y?-1:1),he={x:G[0]-te.sourceEvent.movementX*Ne,y:G[1]-te.sourceEvent.movementY*Ne},ae=[[0,0],[fe,Ye]],we=et.translate(he.x,he.y).scale(G[2]),Me=q.constrain()(we,ae,le);q.transform(oe,Me)},ue=jf().on("zoom",g?ie:null).on("zoom.wheel",m?X:null);return D.call(ue),()=>{D.on("zoom",null)}}},[g,m,y,_]);const ne=f?D=>{const X=qe(D);f(D,{x:X[0],y:X[1]})}:void 0,V=h?(D,X)=>{const ie=C.getState().nodeInternals.get(X);h(D,ie)}:void 0;return p.jsx(bs,{position:d,style:e,className:ve(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:p.jsxs("svg",{width:O,height:j,viewBox:`${B} ${H} ${Y} ${U}`,role:"img","aria-labelledby":J,ref:x,onClick:ne,children:[v&&p.jsx("title",{id:J,children:v}),L.map(D=>{const{x:X,y:ie}=It(D,P).positionAbsolute;return p.jsx(s,{x:X,y:ie,width:D.width,height:D.height,style:D.style,className:b(D),color:F(D),borderRadius:o,strokeColor:R(D),strokeWidth:a,shapeRendering:Q,onClick:V,id:D.id},D.id)}),p.jsx("path",{className:"react-flow__minimap-mask",d:`M${B-A},${H-A}h${Y+A*2}v${U+A*2}h${-Y-A*2}z
        M${N.x},${N.y}h${N.width}v${N.height}h${-N.width}z`,fill:c,fillRule:"evenodd",stroke:l,strokeWidth:u,pointerEvents:"none"})]})})}Th.displayName="MiniMap";var Cw=w.memo(Th);function Nw(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:p.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Mw(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:p.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Iw(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:p.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function kw(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:p.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Rw(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:p.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}const sn=({children:e,className:t,...n})=>p.jsx("button",{type:"button",className:ve(["react-flow__controls-button",t]),...n,children:e});sn.displayName="ControlButton";const Tw=e=>e.nodesDraggable&&e.nodesConnectable&&e.elementsSelectable,Ah=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:o,onZoomOut:a,onFitView:s,onInteractiveChange:c,className:l,children:u,position:d="bottom-left"})=>{const f=ge(),[h,g]=w.useState(!1),m=se(Tw),{zoomIn:v,zoomOut:y,fitView:_}=ks();if(w.useEffect(()=>{g(!0)},[]),!h)return null;const C=()=>{v(),o?.()},x=()=>{y(),a?.()},M=()=>{_(i),s?.()},N=()=>{f.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c?.(!m)};return p.jsxs(bs,{className:ve(["react-flow__controls",l]),position:d,style:e,"data-testid":"rf__controls",children:[t&&p.jsxs(p.Fragment,{children:[p.jsx(sn,{onClick:C,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",children:p.jsx(Nw,{})}),p.jsx(sn,{onClick:x,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",children:p.jsx(Mw,{})})]}),n&&p.jsx(sn,{className:"react-flow__controls-fitview",onClick:M,title:"fit view","aria-label":"fit view",children:p.jsx(Iw,{})}),r&&p.jsx(sn,{className:"react-flow__controls-interactive",onClick:N,title:"toggle interactivity","aria-label":"toggle interactivity",children:m?p.jsx(Rw,{}):p.jsx(kw,{})}),u]})};Ah.displayName="Controls";var Aw=w.memo(Ah),je;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(je||(je={}));function Lw({color:e,dimensions:t,lineWidth:n}){return p.jsx("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Pw({color:e,radius:t}){return p.jsx("circle",{cx:t,cy:t,r:t,fill:e})}const qw={[je.Dots]:"#91919a",[je.Lines]:"#eee",[je.Cross]:"#e2e2e2"},$w={[je.Dots]:1,[je.Lines]:1,[je.Cross]:6},jw=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Lh({id:e,variant:t=je.Dots,gap:n=20,size:r,lineWidth:i=1,offset:o=2,color:a,style:s,className:c}){const l=w.useRef(null),{transform:u,patternId:d}=se(jw,_e),f=a||qw[t],h=r||$w[t],g=t===je.Dots,m=t===je.Cross,v=Array.isArray(n)?n:[n,n],y=[v[0]*u[2]||1,v[1]*u[2]||1],_=h*u[2],C=m?[_,_]:y,x=g?[_/o,_/o]:[C[0]/o,C[1]/o];return p.jsxs("svg",{className:ve(["react-flow__background",c]),style:{...s,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:l,"data-testid":"rf__background",children:[p.jsx("pattern",{id:d+e,x:u[0]%y[0],y:u[1]%y[1],width:y[0],height:y[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${x[0]},-${x[1]})`,children:g?p.jsx(Pw,{color:f,radius:_/o}):p.jsx(Lw,{dimensions:C,color:f,lineWidth:i})}),p.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${d+e})`})]})}Lh.displayName="Background";var Fw=w.memo(Lh);function Dw(e,t){const n=w.useRef(!1);w.useEffect(()=>{if(n.current)return e();n.current=!0},t)}var Vr,Oc;function Ts(){if(Oc)return Vr;Oc=1;function e(t,n){for(var r=-1,i=t==null?0:t.length;++r<i&&n(t[r],r,t)!==!1;);return t}return Vr=e,Vr}var Gr,zc;function Ow(){if(zc)return Gr;zc=1;var e=dr,t=At();function n(r,i){return r&&e(i,t(i),r)}return Gr=n,Gr}var Ur,Bc;function zw(){if(Bc)return Ur;Bc=1;var e=dr,t=En;function n(r,i){return r&&e(i,t(i),r)}return Ur=n,Ur}var Yr,Hc;function Bw(){if(Hc)return Yr;Hc=1;var e=dr,t=Bd;function n(r,i){return e(r,t(r),i)}return Yr=n,Yr}var Kr,Vc;function Ph(){if(Vc)return Kr;Vc=1;var e=Hd(),t=Yd,n=Bd,r=jg,i=Object.getOwnPropertySymbols,o=i?function(a){for(var s=[];a;)e(s,n(a)),a=t(a);return s}:r;return Kr=o,Kr}var Xr,Gc;function Hw(){if(Gc)return Xr;Gc=1;var e=dr,t=Ph();function n(r,i){return e(r,t(r),i)}return Xr=n,Xr}var Wr,Uc;function Vw(){if(Uc)return Wr;Uc=1;var e=Fg,t=Ph(),n=En;function r(i){return e(i,n,t)}return Wr=r,Wr}var Zr,Yc;function Gw(){if(Yc)return Zr;Yc=1;var e=Object.prototype,t=e.hasOwnProperty;function n(r){var i=r.length,o=new r.constructor(i);return i&&typeof r[0]=="string"&&t.call(r,"index")&&(o.index=r.index,o.input=r.input),o}return Zr=n,Zr}var Qr,Kc;function Uw(){if(Kc)return Qr;Kc=1;var e=Kd;function t(n,r){var i=r?e(n.buffer):n.buffer;return new n.constructor(i,n.byteOffset,n.byteLength)}return Qr=t,Qr}var Jr,Xc;function Yw(){if(Xc)return Jr;Xc=1;var e=/\w*$/;function t(n){var r=new n.constructor(n.source,e.exec(n));return r.lastIndex=n.lastIndex,r}return Jr=t,Jr}var ei,Wc;function Kw(){if(Wc)return ei;Wc=1;var e=rs,t=e?e.prototype:void 0,n=t?t.valueOf:void 0;function r(i){return n?Object(n.call(i)):{}}return ei=r,ei}var ti,Zc;function Xw(){if(Zc)return ti;Zc=1;var e=Kd,t=Uw(),n=Yw(),r=Kw(),i=Yg,o="[object Boolean]",a="[object Date]",s="[object Map]",c="[object Number]",l="[object RegExp]",u="[object Set]",d="[object String]",f="[object Symbol]",h="[object ArrayBuffer]",g="[object DataView]",m="[object Float32Array]",v="[object Float64Array]",y="[object Int8Array]",_="[object Int16Array]",C="[object Int32Array]",x="[object Uint8Array]",M="[object Uint8ClampedArray]",N="[object Uint16Array]",L="[object Uint32Array]";function $(P,O,j){var F=P.constructor;switch(O){case h:return e(P);case o:case a:return new F(+P);case g:return t(P,j);case m:case v:case y:case _:case C:case x:case M:case N:case L:return i(P,j);case s:return new F;case c:case d:return new F(P);case l:return n(P);case u:return new F;case f:return r(P)}}return ti=$,ti}var ni,Qc;function Ww(){if(Qc)return ni;Qc=1;var e=_n,t=fr,n="[object Map]";function r(i){return t(i)&&e(i)==n}return ni=r,ni}var ri,Jc;function Zw(){if(Jc)return ri;Jc=1;var e=Ww(),t=is,n=Xd,r=n&&n.isMap,i=r?t(r):e;return ri=i,ri}var ii,eu;function Qw(){if(eu)return ii;eu=1;var e=_n,t=fr,n="[object Set]";function r(i){return t(i)&&e(i)==n}return ii=r,ii}var oi,tu;function Jw(){if(tu)return oi;tu=1;var e=Qw(),t=is,n=Xd,r=n&&n.isSet,i=r?t(r):e;return oi=i,oi}var ai,nu;function qh(){if(nu)return ai;nu=1;var e=Wd,t=Ts(),n=os(),r=Ow(),i=zw(),o=Kg,a=Xg,s=Bw(),c=Hw(),l=Dg,u=Vw(),d=_n,f=Gw(),h=Xw(),g=Wg,m=xe,v=as,y=Zw(),_=Sn,C=Jw(),x=At(),M=En,N=1,L=2,$=4,P="[object Arguments]",O="[object Array]",j="[object Boolean]",F="[object Date]",R="[object Error]",b="[object Function]",k="[object GeneratorFunction]",S="[object Map]",E="[object Number]",I="[object Object]",T="[object RegExp]",A="[object Set]",B="[object String]",H="[object Symbol]",Y="[object WeakMap]",U="[object ArrayBuffer]",Q="[object DataView]",J="[object Float32Array]",ee="[object Float64Array]",ne="[object Int8Array]",V="[object Int16Array]",D="[object Int32Array]",X="[object Uint8Array]",ie="[object Uint8ClampedArray]",ue="[object Uint16Array]",te="[object Uint32Array]",G={};G[P]=G[O]=G[U]=G[Q]=G[j]=G[F]=G[J]=G[ee]=G[ne]=G[V]=G[D]=G[S]=G[E]=G[I]=G[T]=G[A]=G[B]=G[H]=G[X]=G[ie]=G[ue]=G[te]=!0,G[R]=G[b]=G[Y]=!1;function oe(q,le,fe,Ye,Ne,he){var ae,we=le&N,Me=le&L,ze=le&$;if(fe&&(ae=Ne?fe(q,Ye,Ne,he):fe(q)),ae!==void 0)return ae;if(!_(q))return q;var Be=m(q);if(Be){if(ae=f(q),!we)return a(q,ae)}else{var Re=d(q),Ke=Re==b||Re==k;if(v(q))return o(q,we);if(Re==I||Re==P||Ke&&!Ne){if(ae=Me||Ke?{}:g(q),!we)return Me?c(q,i(ae,q)):s(q,r(ae,q))}else{if(!G[Re])return Ne?q:{};ae=h(q,Re,we)}}he||(he=new e);var me=he.get(q);if(me)return me;he.set(q,ae),C(q)?q.forEach(function(ye){ae.add(oe(ye,le,fe,ye,q,he))}):y(q)&&q.forEach(function(ye,Ee){ae.set(Ee,oe(ye,le,fe,Ee,q,he))});var Te=ze?Me?u:l:Me?M:x,He=Be?void 0:Te(q);return t(He||q,function(ye,Ee){He&&(Ee=ye,ye=q[Ee]),n(ae,Ee,oe(ye,le,fe,Ee,q,he))}),ae}return ai=oe,ai}var si,ru;function e1(){if(ru)return si;ru=1;var e=qh(),t=4;function n(r){return e(r,t)}return si=n,si}var ir={},t1={get exports(){return ir},set exports(e){ir=e}},ci,iu;function As(){if(iu)return ci;iu=1;var e=Zd,t=At();function n(r,i){return r&&e(r,i,t)}return ci=n,ci}var ui,ou;function n1(){if(ou)return ui;ou=1;var e=Cn;function t(n,r){return function(i,o){if(i==null)return i;if(!e(i))return n(i,o);for(var a=i.length,s=r?a:-1,c=Object(i);(r?s--:++s<a)&&o(c[s],s,c)!==!1;);return i}}return ui=t,ui}var li,au;function xr(){if(au)return li;au=1;var e=As(),t=n1(),n=t(e);return li=n,li}var di,su;function $h(){if(su)return di;su=1;var e=Nn;function t(n){return typeof n=="function"?n:e}return di=t,di}var fi,cu;function jh(){if(cu)return fi;cu=1;var e=Ts(),t=xr(),n=$h(),r=xe;function i(o,a){var s=r(o)?e:t;return s(o,n(a))}return fi=i,fi}var uu;function Fh(){return uu||(uu=1,function(e){e.exports=jh()}(t1)),ir}var hi,lu;function r1(){if(lu)return hi;lu=1;var e=xr();function t(n,r){var i=[];return e(n,function(o,a,s){r(o,a,s)&&i.push(o)}),i}return hi=t,hi}var pi,du;function i1(){if(du)return pi;du=1;var e=Wd,t=Vd,n=1,r=2;function i(o,a,s,c){var l=s.length,u=l,d=!c;if(o==null)return!u;for(o=Object(o);l--;){var f=s[l];if(d&&f[2]?f[1]!==o[f[0]]:!(f[0]in o))return!1}for(;++l<u;){f=s[l];var h=f[0],g=o[h],m=f[1];if(d&&f[2]){if(g===void 0&&!(h in o))return!1}else{var v=new e;if(c)var y=c(g,m,h,o,a,v);if(!(y===void 0?t(m,g,n|r,c,v):y))return!1}}return!0}return pi=i,pi}var gi,fu;function Dh(){if(fu)return gi;fu=1;var e=Sn;function t(n){return n===n&&!e(n)}return gi=t,gi}var mi,hu;function o1(){if(hu)return mi;hu=1;var e=Dh(),t=At();function n(r){for(var i=t(r),o=i.length;o--;){var a=i[o],s=r[a];i[o]=[a,s,e(s)]}return i}return mi=n,mi}var vi,pu;function Oh(){if(pu)return vi;pu=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return vi=e,vi}var yi,gu;function a1(){if(gu)return yi;gu=1;var e=i1(),t=o1(),n=Oh();function r(i){var o=t(i);return o.length==1&&o[0][2]?n(o[0][0],o[0][1]):function(a){return a===i||e(a,i,o)}}return yi=r,yi}var bi,mu;function Xt(){if(mu)return bi;mu=1;var e=Qd,t=fr,n="[object Symbol]";function r(i){return typeof i=="symbol"||t(i)&&e(i)==n}return bi=r,bi}var xi,vu;function Ls(){if(vu)return xi;vu=1;var e=xe,t=Xt(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function i(o,a){if(e(o))return!1;var s=typeof o;return s=="number"||s=="symbol"||s=="boolean"||o==null||t(o)?!0:r.test(o)||!n.test(o)||a!=null&&o in Object(a)}return xi=i,xi}var wi,yu;function s1(){if(yu)return wi;yu=1;var e=Zg,t="Expected a function";function n(r,i){if(typeof r!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var o=function(){var a=arguments,s=i?i.apply(this,a):a[0],c=o.cache;if(c.has(s))return c.get(s);var l=r.apply(this,a);return o.cache=c.set(s,l)||c,l};return o.cache=new(n.Cache||e),o}return n.Cache=e,wi=n,wi}var _i,bu;function c1(){if(bu)return _i;bu=1;var e=s1(),t=500;function n(r){var i=e(r,function(a){return o.size===t&&o.clear(),a}),o=i.cache;return i}return _i=n,_i}var Ei,xu;function u1(){if(xu)return Ei;xu=1;var e=c1(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(i){var o=[];return i.charCodeAt(0)===46&&o.push(""),i.replace(t,function(a,s,c,l){o.push(c?l.replace(n,"$1"):s||a)}),o});return Ei=r,Ei}var Si,wu;function wr(){if(wu)return Si;wu=1;function e(t,n){for(var r=-1,i=t==null?0:t.length,o=Array(i);++r<i;)o[r]=n(t[r],r,t);return o}return Si=e,Si}var Ci,_u;function l1(){if(_u)return Ci;_u=1;var e=rs,t=wr(),n=xe,r=Xt(),i=1/0,o=e?e.prototype:void 0,a=o?o.toString:void 0;function s(c){if(typeof c=="string")return c;if(n(c))return t(c,s)+"";if(r(c))return a?a.call(c):"";var l=c+"";return l=="0"&&1/c==-i?"-0":l}return Ci=s,Ci}var Ni,Eu;function zh(){if(Eu)return Ni;Eu=1;var e=l1();function t(n){return n==null?"":e(n)}return Ni=t,Ni}var Mi,Su;function _r(){if(Su)return Mi;Su=1;var e=xe,t=Ls(),n=u1(),r=zh();function i(o,a){return e(o)?o:t(o,a)?[o]:n(r(o))}return Mi=i,Mi}var Ii,Cu;function Rn(){if(Cu)return Ii;Cu=1;var e=Xt(),t=1/0;function n(r){if(typeof r=="string"||e(r))return r;var i=r+"";return i=="0"&&1/r==-t?"-0":i}return Ii=n,Ii}var ki,Nu;function Er(){if(Nu)return ki;Nu=1;var e=_r(),t=Rn();function n(r,i){i=e(i,r);for(var o=0,a=i.length;r!=null&&o<a;)r=r[t(i[o++])];return o&&o==a?r:void 0}return ki=n,ki}var Ri,Mu;function d1(){if(Mu)return Ri;Mu=1;var e=Er();function t(n,r,i){var o=n==null?void 0:e(n,r);return o===void 0?i:o}return Ri=t,Ri}var Ti,Iu;function f1(){if(Iu)return Ti;Iu=1;function e(t,n){return t!=null&&n in Object(t)}return Ti=e,Ti}var Ai,ku;function Bh(){if(ku)return Ai;ku=1;var e=_r(),t=ss,n=xe,r=Jd,i=Qg,o=Rn();function a(s,c,l){c=e(c,s);for(var u=-1,d=c.length,f=!1;++u<d;){var h=o(c[u]);if(!(f=s!=null&&l(s,h)))break;s=s[h]}return f||++u!=d?f:(d=s==null?0:s.length,!!d&&i(d)&&r(h,d)&&(n(s)||t(s)))}return Ai=a,Ai}var Li,Ru;function Hh(){if(Ru)return Li;Ru=1;var e=f1(),t=Bh();function n(r,i){return r!=null&&t(r,i,e)}return Li=n,Li}var Pi,Tu;function h1(){if(Tu)return Pi;Tu=1;var e=Vd,t=d1(),n=Hh(),r=Ls(),i=Dh(),o=Oh(),a=Rn(),s=1,c=2;function l(u,d){return r(u)&&i(d)?o(a(u),d):function(f){var h=t(f,u);return h===void 0&&h===d?n(f,u):e(d,h,s|c)}}return Pi=l,Pi}var qi,Au;function Vh(){if(Au)return qi;Au=1;function e(t){return function(n){return n?.[t]}}return qi=e,qi}var $i,Lu;function p1(){if(Lu)return $i;Lu=1;var e=Er();function t(n){return function(r){return e(r,n)}}return $i=t,$i}var ji,Pu;function g1(){if(Pu)return ji;Pu=1;var e=Vh(),t=p1(),n=Ls(),r=Rn();function i(o){return n(o)?e(r(o)):t(o)}return ji=i,ji}var Fi,qu;function it(){if(qu)return Fi;qu=1;var e=a1(),t=h1(),n=Nn,r=xe,i=g1();function o(a){return typeof a=="function"?a:a==null?n:typeof a=="object"?r(a)?t(a[0],a[1]):e(a):i(a)}return Fi=o,Fi}var Di,$u;function Gh(){if($u)return Di;$u=1;var e=Og(),t=r1(),n=it(),r=xe;function i(o,a){var s=r(o)?e:t;return s(o,n(a,3))}return Di=i,Di}var Oi,ju;function m1(){if(ju)return Oi;ju=1;var e=Object.prototype,t=e.hasOwnProperty;function n(r,i){return r!=null&&t.call(r,i)}return Oi=n,Oi}var zi,Fu;function Uh(){if(Fu)return zi;Fu=1;var e=m1(),t=Bh();function n(r,i){return r!=null&&t(r,i,e)}return zi=n,zi}var Bi,Du;function v1(){if(Du)return Bi;Du=1;var e=Gd(),t=_n,n=ss,r=xe,i=Cn,o=as,a=Jg,s=ef,c="[object Map]",l="[object Set]",u=Object.prototype,d=u.hasOwnProperty;function f(h){if(h==null)return!0;if(i(h)&&(r(h)||typeof h=="string"||typeof h.splice=="function"||o(h)||s(h)||n(h)))return!h.length;var g=t(h);if(g==c||g==l)return!h.size;if(a(h))return!e(h).length;for(var m in h)if(d.call(h,m))return!1;return!0}return Bi=f,Bi}var Hi,Ou;function Yh(){if(Ou)return Hi;Ou=1;function e(t){return t===void 0}return Hi=e,Hi}var Vi,zu;function Kh(){if(zu)return Vi;zu=1;var e=xr(),t=Cn;function n(r,i){var o=-1,a=t(r)?Array(r.length):[];return e(r,function(s,c,l){a[++o]=i(s,c,l)}),a}return Vi=n,Vi}var Gi,Bu;function Xh(){if(Bu)return Gi;Bu=1;var e=wr(),t=it(),n=Kh(),r=xe;function i(o,a){var s=r(o)?e:n;return s(o,t(a,3))}return Gi=i,Gi}var Ui,Hu;function y1(){if(Hu)return Ui;Hu=1;function e(t,n,r,i){var o=-1,a=t==null?0:t.length;for(i&&a&&(r=t[++o]);++o<a;)r=n(r,t[o],o,t);return r}return Ui=e,Ui}var Yi,Vu;function b1(){if(Vu)return Yi;Vu=1;function e(t,n,r,i,o){return o(t,function(a,s,c){r=i?(i=!1,a):n(r,a,s,c)}),r}return Yi=e,Yi}var Ki,Gu;function Wh(){if(Gu)return Ki;Gu=1;var e=y1(),t=xr(),n=it(),r=b1(),i=xe;function o(a,s,c){var l=i(a)?e:r,u=arguments.length<3;return l(a,n(s,4),c,u,t)}return Ki=o,Ki}var Xi,Uu;function x1(){if(Uu)return Xi;Uu=1;var e=Qd,t=xe,n=fr,r="[object String]";function i(o){return typeof o=="string"||!t(o)&&n(o)&&e(o)==r}return Xi=i,Xi}var Wi,Yu;function w1(){if(Yu)return Wi;Yu=1;var e=Vh(),t=e("length");return Wi=t,Wi}var Zi,Ku;function _1(){if(Ku)return Zi;Ku=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+n+r,o="\\ufe0e\\ufe0f",a="\\u200d",s=RegExp("["+a+e+i+o+"]");function c(l){return s.test(l)}return Zi=c,Zi}var Qi,Xu;function E1(){if(Xu)return Qi;Xu=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+n+r,o="\\ufe0e\\ufe0f",a="["+e+"]",s="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",l="(?:"+s+"|"+c+")",u="[^"+e+"]",d="(?:\\ud83c[\\udde6-\\uddff]){2}",f="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",g=l+"?",m="["+o+"]?",v="(?:"+h+"(?:"+[u,d,f].join("|")+")"+m+g+")*",y=m+g+v,_="(?:"+[u+s+"?",s,d,f,a].join("|")+")",C=RegExp(c+"(?="+c+")|"+_+y,"g");function x(M){for(var N=C.lastIndex=0;C.test(M);)++N;return N}return Qi=x,Qi}var Ji,Wu;function S1(){if(Wu)return Ji;Wu=1;var e=w1(),t=_1(),n=E1();function r(i){return t(i)?n(i):e(i)}return Ji=r,Ji}var eo,Zu;function C1(){if(Zu)return eo;Zu=1;var e=Gd(),t=_n,n=Cn,r=x1(),i=S1(),o="[object Map]",a="[object Set]";function s(c){if(c==null)return 0;if(n(c))return r(c)?i(c):c.length;var l=t(c);return l==o||l==a?c.size:e(c).length}return eo=s,eo}var to,Qu;function N1(){if(Qu)return to;Qu=1;var e=Ts(),t=em,n=As(),r=it(),i=Yd,o=xe,a=as,s=tf,c=Sn,l=ef;function u(d,f,h){var g=o(d),m=g||a(d)||l(d);if(f=r(f,4),h==null){var v=d&&d.constructor;m?h=g?new v:[]:c(d)?h=s(v)?t(i(d)):{}:h={}}return(m?e:n)(d,function(y,_,C){return f(h,y,_,C)}),h}return to=u,to}var no,Ju;function M1(){if(Ju)return no;Ju=1;var e=rs,t=ss,n=xe,r=e?e.isConcatSpreadable:void 0;function i(o){return n(o)||t(o)||!!(r&&o&&o[r])}return no=i,no}var ro,el;function Ps(){if(el)return ro;el=1;var e=Hd(),t=M1();function n(r,i,o,a,s){var c=-1,l=r.length;for(o||(o=t),s||(s=[]);++c<l;){var u=r[c];i>0&&o(u)?i>1?n(u,i-1,o,a,s):e(s,u):a||(s[s.length]=u)}return s}return ro=n,ro}var io,tl;function Zh(){if(tl)return io;tl=1;function e(t,n,r,i){for(var o=t.length,a=r+(i?1:-1);i?a--:++a<o;)if(n(t[a],a,t))return a;return-1}return io=e,io}var oo,nl;function I1(){if(nl)return oo;nl=1;function e(t){return t!==t}return oo=e,oo}var ao,rl;function k1(){if(rl)return ao;rl=1;function e(t,n,r){for(var i=r-1,o=t.length;++i<o;)if(t[i]===n)return i;return-1}return ao=e,ao}var so,il;function R1(){if(il)return so;il=1;var e=Zh(),t=I1(),n=k1();function r(i,o,a){return o===o?n(i,o,a):e(i,t,a)}return so=r,so}var co,ol;function T1(){if(ol)return co;ol=1;var e=R1();function t(n,r){var i=n==null?0:n.length;return!!i&&e(n,r,0)>-1}return co=t,co}var uo,al;function A1(){if(al)return uo;al=1;function e(t,n,r){for(var i=-1,o=t==null?0:t.length;++i<o;)if(r(n,t[i]))return!0;return!1}return uo=e,uo}var lo,sl;function L1(){if(sl)return lo;sl=1;function e(){}return lo=e,lo}var fo,cl;function P1(){if(cl)return fo;cl=1;var e=zg,t=L1(),n=Ud,r=1/0,i=e&&1/n(new e([,-0]))[1]==r?function(o){return new e(o)}:t;return fo=i,fo}var ho,ul;function q1(){if(ul)return ho;ul=1;var e=Bg,t=T1(),n=A1(),r=Hg,i=P1(),o=Ud,a=200;function s(c,l,u){var d=-1,f=t,h=c.length,g=!0,m=[],v=m;if(u)g=!1,f=n;else if(h>=a){var y=l?null:i(c);if(y)return o(y);g=!1,f=r,v=new e}else v=l?[]:m;e:for(;++d<h;){var _=c[d],C=l?l(_):_;if(_=u||_!==0?_:0,g&&C===C){for(var x=v.length;x--;)if(v[x]===C)continue e;l&&v.push(C),m.push(_)}else f(v,C,u)||(v!==m&&v.push(C),m.push(_))}return m}return ho=s,ho}var po,ll;function $1(){if(ll)return po;ll=1;var e=Ps(),t=cs,n=q1(),r=tm,i=t(function(o){return n(e(o,1,r,!0))});return po=i,po}var go,dl;function j1(){if(dl)return go;dl=1;var e=wr();function t(n,r){return e(r,function(i){return n[i]})}return go=t,go}var mo,fl;function Qh(){if(fl)return mo;fl=1;var e=j1(),t=At();function n(r){return r==null?[]:e(r,t(r))}return mo=n,mo}var vo,hl;function Pe(){if(hl)return vo;hl=1;var e;if(typeof ns=="function")try{e={clone:e1(),constant:nf(),each:Fh(),filter:Gh(),has:Uh(),isArray:xe,isEmpty:v1(),isFunction:tf,isUndefined:Yh(),keys:At(),map:Xh(),reduce:Wh(),size:C1(),transform:N1(),union:$1(),values:Qh()}}catch{}return e||(e=window._),vo=e,vo}var yo,pl;function qs(){if(pl)return yo;pl=1;var e=Pe();yo=i;var t="\0",n="\0",r="";function i(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[n]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(u){return this._label=u,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(d){return e.isEmpty(u._in[d])})},i.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(d){return e.isEmpty(u._out[d])})},i.prototype.setNodes=function(u,d){var f=arguments,h=this;return e.each(u,function(g){f.length>1?h.setNode(g,d):h.setNode(g)}),this},i.prototype.setNode=function(u,d){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=d),this):(this._nodes[u]=arguments.length>1?d:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=n,this._children[u]={},this._children[n][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},i.prototype.node=function(u){return this._nodes[u]},i.prototype.hasNode=function(u){return e.has(this._nodes,u)},i.prototype.removeNode=function(u){var d=this;if(e.has(this._nodes,u)){var f=function(h){d.removeEdge(d._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){d.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),f),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),f),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},i.prototype.setParent=function(u,d){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(d))d=n;else{d+="";for(var f=d;!e.isUndefined(f);f=this.parent(f))if(f===u)throw new Error("Setting "+d+" as parent of "+u+" would create a cycle");this.setNode(d)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=d,this._children[d][u]=!0,this},i.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},i.prototype.parent=function(u){if(this._isCompound){var d=this._parent[u];if(d!==n)return d}},i.prototype.children=function(u){if(e.isUndefined(u)&&(u=n),this._isCompound){var d=this._children[u];if(d)return e.keys(d)}else{if(u===n)return this.nodes();if(this.hasNode(u))return[]}},i.prototype.predecessors=function(u){var d=this._preds[u];if(d)return e.keys(d)},i.prototype.successors=function(u){var d=this._sucs[u];if(d)return e.keys(d)},i.prototype.neighbors=function(u){var d=this.predecessors(u);if(d)return e.union(d,this.successors(u))},i.prototype.isLeaf=function(u){var d;return this.isDirected()?d=this.successors(u):d=this.neighbors(u),d.length===0},i.prototype.filterNodes=function(u){var d=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});d.setGraph(this.graph());var f=this;e.each(this._nodes,function(m,v){u(v)&&d.setNode(v,m)}),e.each(this._edgeObjs,function(m){d.hasNode(m.v)&&d.hasNode(m.w)&&d.setEdge(m,f.edge(m))});var h={};function g(m){var v=f.parent(m);return v===void 0||d.hasNode(v)?(h[m]=v,v):v in h?h[v]:g(v)}return this._isCompound&&e.each(d.nodes(),function(m){d.setParent(m,g(m))}),d},i.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(u,d){var f=this,h=arguments;return e.reduce(u,function(g,m){return h.length>1?f.setEdge(g,m,d):f.setEdge(g,m),m}),this},i.prototype.setEdge=function(){var u,d,f,h,g=!1,m=arguments[0];typeof m=="object"&&m!==null&&"v"in m?(u=m.v,d=m.w,f=m.name,arguments.length===2&&(h=arguments[1],g=!0)):(u=m,d=arguments[1],f=arguments[3],arguments.length>2&&(h=arguments[2],g=!0)),u=""+u,d=""+d,e.isUndefined(f)||(f=""+f);var v=s(this._isDirected,u,d,f);if(e.has(this._edgeLabels,v))return g&&(this._edgeLabels[v]=h),this;if(!e.isUndefined(f)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(d),this._edgeLabels[v]=g?h:this._defaultEdgeLabelFn(u,d,f);var y=c(this._isDirected,u,d,f);return u=y.v,d=y.w,Object.freeze(y),this._edgeObjs[v]=y,o(this._preds[d],u),o(this._sucs[u],d),this._in[d][v]=y,this._out[u][v]=y,this._edgeCount++,this},i.prototype.edge=function(u,d,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):s(this._isDirected,u,d,f);return this._edgeLabels[h]},i.prototype.hasEdge=function(u,d,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):s(this._isDirected,u,d,f);return e.has(this._edgeLabels,h)},i.prototype.removeEdge=function(u,d,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):s(this._isDirected,u,d,f),g=this._edgeObjs[h];return g&&(u=g.v,d=g.w,delete this._edgeLabels[h],delete this._edgeObjs[h],a(this._preds[d],u),a(this._sucs[u],d),delete this._in[d][h],delete this._out[u][h],this._edgeCount--),this},i.prototype.inEdges=function(u,d){var f=this._in[u];if(f){var h=e.values(f);return d?e.filter(h,function(g){return g.v===d}):h}},i.prototype.outEdges=function(u,d){var f=this._out[u];if(f){var h=e.values(f);return d?e.filter(h,function(g){return g.w===d}):h}},i.prototype.nodeEdges=function(u,d){var f=this.inEdges(u,d);if(f)return f.concat(this.outEdges(u,d))};function o(u,d){u[d]?u[d]++:u[d]=1}function a(u,d){--u[d]||delete u[d]}function s(u,d,f,h){var g=""+d,m=""+f;if(!u&&g>m){var v=g;g=m,m=v}return g+r+m+r+(e.isUndefined(h)?t:h)}function c(u,d,f,h){var g=""+d,m=""+f;if(!u&&g>m){var v=g;g=m,m=v}var y={v:g,w:m};return h&&(y.name=h),y}function l(u,d){return s(u,d.v,d.w,d.name)}return yo}var bo,gl;function F1(){return gl||(gl=1,bo="2.1.8"),bo}var xo,ml;function D1(){return ml||(ml=1,xo={Graph:qs(),version:F1()}),xo}var wo,vl;function O1(){if(vl)return wo;vl=1;var e=Pe(),t=qs();wo={write:n,read:o};function n(a){var s={options:{directed:a.isDirected(),multigraph:a.isMultigraph(),compound:a.isCompound()},nodes:r(a),edges:i(a)};return e.isUndefined(a.graph())||(s.value=e.clone(a.graph())),s}function r(a){return e.map(a.nodes(),function(s){var c=a.node(s),l=a.parent(s),u={v:s};return e.isUndefined(c)||(u.value=c),e.isUndefined(l)||(u.parent=l),u})}function i(a){return e.map(a.edges(),function(s){var c=a.edge(s),l={v:s.v,w:s.w};return e.isUndefined(s.name)||(l.name=s.name),e.isUndefined(c)||(l.value=c),l})}function o(a){var s=new t(a.options).setGraph(a.value);return e.each(a.nodes,function(c){s.setNode(c.v,c.value),c.parent&&s.setParent(c.v,c.parent)}),e.each(a.edges,function(c){s.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),s}return wo}var _o,yl;function z1(){if(yl)return _o;yl=1;var e=Pe();_o=t;function t(n){var r={},i=[],o;function a(s){e.has(r,s)||(r[s]=!0,o.push(s),e.each(n.successors(s),a),e.each(n.predecessors(s),a))}return e.each(n.nodes(),function(s){o=[],a(s),o.length&&i.push(o)}),i}return _o}var Eo,bl;function Jh(){if(bl)return Eo;bl=1;var e=Pe();Eo=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(n){return n.key})},t.prototype.has=function(n){return e.has(this._keyIndices,n)},t.prototype.priority=function(n){var r=this._keyIndices[n];if(r!==void 0)return this._arr[r].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(n,r){var i=this._keyIndices;if(n=String(n),!e.has(i,n)){var o=this._arr,a=o.length;return i[n]=a,o.push({key:n,priority:r}),this._decrease(a),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key},t.prototype.decrease=function(n,r){var i=this._keyIndices[n];if(r>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[i].priority+" New: "+r);this._arr[i].priority=r,this._decrease(i)},t.prototype._heapify=function(n){var r=this._arr,i=2*n,o=i+1,a=n;i<r.length&&(a=r[i].priority<r[a].priority?i:a,o<r.length&&(a=r[o].priority<r[a].priority?o:a),a!==n&&(this._swap(n,a),this._heapify(a)))},t.prototype._decrease=function(n){for(var r=this._arr,i=r[n].priority,o;n!==0&&(o=n>>1,!(r[o].priority<i));)this._swap(n,o),n=o},t.prototype._swap=function(n,r){var i=this._arr,o=this._keyIndices,a=i[n],s=i[r];i[n]=s,i[r]=a,o[s.key]=n,o[a.key]=r},Eo}var So,xl;function ep(){if(xl)return So;xl=1;var e=Pe(),t=Jh();So=r;var n=e.constant(1);function r(o,a,s,c){return i(o,String(a),s||n,c||function(l){return o.outEdges(l)})}function i(o,a,s,c){var l={},u=new t,d,f,h=function(g){var m=g.v!==d?g.v:g.w,v=l[m],y=s(g),_=f.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+g+" Weight: "+y);_<v.distance&&(v.distance=_,v.predecessor=d,u.decrease(m,_))};for(o.nodes().forEach(function(g){var m=g===a?0:Number.POSITIVE_INFINITY;l[g]={distance:m},u.add(g,m)});u.size()>0&&(d=u.removeMin(),f=l[d],f.distance!==Number.POSITIVE_INFINITY);)c(d).forEach(h);return l}return So}var Co,wl;function B1(){if(wl)return Co;wl=1;var e=ep(),t=Pe();Co=n;function n(r,i,o){return t.transform(r.nodes(),function(a,s){a[s]=e(r,s,i,o)},{})}return Co}var No,_l;function tp(){if(_l)return No;_l=1;var e=Pe();No=t;function t(n){var r=0,i=[],o={},a=[];function s(c){var l=o[c]={onStack:!0,lowlink:r,index:r++};if(i.push(c),n.successors(c).forEach(function(f){e.has(o,f)?o[f].onStack&&(l.lowlink=Math.min(l.lowlink,o[f].index)):(s(f),l.lowlink=Math.min(l.lowlink,o[f].lowlink))}),l.lowlink===l.index){var u=[],d;do d=i.pop(),o[d].onStack=!1,u.push(d);while(c!==d);a.push(u)}}return n.nodes().forEach(function(c){e.has(o,c)||s(c)}),a}return No}var Mo,El;function H1(){if(El)return Mo;El=1;var e=Pe(),t=tp();Mo=n;function n(r){return e.filter(t(r),function(i){return i.length>1||i.length===1&&r.hasEdge(i[0],i[0])})}return Mo}var Io,Sl;function V1(){if(Sl)return Io;Sl=1;var e=Pe();Io=n;var t=e.constant(1);function n(i,o,a){return r(i,o||t,a||function(s){return i.outEdges(s)})}function r(i,o,a){var s={},c=i.nodes();return c.forEach(function(l){s[l]={},s[l][l]={distance:0},c.forEach(function(u){l!==u&&(s[l][u]={distance:Number.POSITIVE_INFINITY})}),a(l).forEach(function(u){var d=u.v===l?u.w:u.v,f=o(u);s[l][d]={distance:f,predecessor:l}})}),c.forEach(function(l){var u=s[l];c.forEach(function(d){var f=s[d];c.forEach(function(h){var g=f[l],m=u[h],v=f[h],y=g.distance+m.distance;y<v.distance&&(v.distance=y,v.predecessor=m.predecessor)})})}),s}return Io}var ko,Cl;function np(){if(Cl)return ko;Cl=1;var e=Pe();ko=t,t.CycleException=n;function t(r){var i={},o={},a=[];function s(c){if(e.has(o,c))throw new n;e.has(i,c)||(o[c]=!0,i[c]=!0,e.each(r.predecessors(c),s),delete o[c],a.push(c))}if(e.each(r.sinks(),s),e.size(i)!==r.nodeCount())throw new n;return a}function n(){}return n.prototype=new Error,ko}var Ro,Nl;function G1(){if(Nl)return Ro;Nl=1;var e=np();Ro=t;function t(n){try{e(n)}catch(r){if(r instanceof e.CycleException)return!1;throw r}return!0}return Ro}var To,Ml;function rp(){if(Ml)return To;Ml=1;var e=Pe();To=t;function t(r,i,o){e.isArray(i)||(i=[i]);var a=(r.isDirected()?r.successors:r.neighbors).bind(r),s=[],c={};return e.each(i,function(l){if(!r.hasNode(l))throw new Error("Graph does not have node: "+l);n(r,l,o==="post",c,a,s)}),s}function n(r,i,o,a,s,c){e.has(a,i)||(a[i]=!0,o||c.push(i),e.each(s(i),function(l){n(r,l,o,a,s,c)}),o&&c.push(i))}return To}var Ao,Il;function U1(){if(Il)return Ao;Il=1;var e=rp();Ao=t;function t(n,r){return e(n,r,"post")}return Ao}var Lo,kl;function Y1(){if(kl)return Lo;kl=1;var e=rp();Lo=t;function t(n,r){return e(n,r,"pre")}return Lo}var Po,Rl;function K1(){if(Rl)return Po;Rl=1;var e=Pe(),t=qs(),n=Jh();Po=r;function r(i,o){var a=new t,s={},c=new n,l;function u(f){var h=f.v===l?f.w:f.v,g=c.priority(h);if(g!==void 0){var m=o(f);m<g&&(s[h]=l,c.decrease(h,m))}}if(i.nodeCount()===0)return a;e.each(i.nodes(),function(f){c.add(f,Number.POSITIVE_INFINITY),a.setNode(f)}),c.decrease(i.nodes()[0],0);for(var d=!1;c.size()>0;){if(l=c.removeMin(),e.has(s,l))a.setEdge(l,s[l]);else{if(d)throw new Error("Input graph is not connected: "+i);d=!0}i.nodeEdges(l).forEach(u)}return a}return Po}var qo,Tl;function X1(){return Tl||(Tl=1,qo={components:z1(),dijkstra:ep(),dijkstraAll:B1(),findCycles:H1(),floydWarshall:V1(),isAcyclic:G1(),postorder:U1(),preorder:Y1(),prim:K1(),tarjan:tp(),topsort:np()}),qo}var $o,Al;function W1(){if(Al)return $o;Al=1;var e=D1();return $o={Graph:e.Graph,json:O1(),alg:X1(),version:e.version},$o}var or;if(typeof ns=="function")try{or=W1()}catch{}or||(or=window.graphlib);var Oe=or,jo,Ll;function Z1(){if(Ll)return jo;Ll=1;var e=qh(),t=1,n=4;function r(i){return e(i,t|n)}return jo=r,jo}var Fo,Pl;function Q1(){if(Pl)return Fo;Pl=1;var e=cs,t=nm,n=us,r=En,i=Object.prototype,o=i.hasOwnProperty,a=e(function(s,c){s=Object(s);var l=-1,u=c.length,d=u>2?c[2]:void 0;for(d&&n(c[0],c[1],d)&&(u=1);++l<u;)for(var f=c[l],h=r(f),g=-1,m=h.length;++g<m;){var v=h[g],y=s[v];(y===void 0||t(y,i[v])&&!o.call(s,v))&&(s[v]=f[v])}return s});return Fo=a,Fo}var Do,ql;function J1(){if(ql)return Do;ql=1;var e=it(),t=Cn,n=At();function r(i){return function(o,a,s){var c=Object(o);if(!t(o)){var l=e(a,3);o=n(o),a=function(d){return l(c[d],d,c)}}var u=i(o,a,s);return u>-1?c[l?o[u]:u]:void 0}}return Do=r,Do}var Oo,$l;function e_(){if($l)return Oo;$l=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return Oo=t,Oo}var zo,jl;function t_(){if(jl)return zo;jl=1;var e=e_(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return zo=n,zo}var Bo,Fl;function n_(){if(Fl)return Bo;Fl=1;var e=t_(),t=Sn,n=Xt(),r=0/0,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,s=parseInt;function c(l){if(typeof l=="number")return l;if(n(l))return r;if(t(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=t(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=e(l);var d=o.test(l);return d||a.test(l)?s(l.slice(2),d?2:8):i.test(l)?r:+l}return Bo=c,Bo}var Ho,Dl;function ip(){if(Dl)return Ho;Dl=1;var e=n_(),t=1/0,n=17976931348623157e292;function r(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-t){var o=i<0?-1:1;return o*n}return i===i?i:0}return Ho=r,Ho}var Vo,Ol;function r_(){if(Ol)return Vo;Ol=1;var e=ip();function t(n){var r=e(n),i=r%1;return r===r?i?r-i:r:0}return Vo=t,Vo}var Go,zl;function i_(){if(zl)return Go;zl=1;var e=Zh(),t=it(),n=r_(),r=Math.max;function i(o,a,s){var c=o==null?0:o.length;if(!c)return-1;var l=s==null?0:n(s);return l<0&&(l=r(c+l,0)),e(o,t(a,3),l)}return Go=i,Go}var Uo,Bl;function o_(){if(Bl)return Uo;Bl=1;var e=J1(),t=i_(),n=e(t);return Uo=n,Uo}var Yo,Hl;function op(){if(Hl)return Yo;Hl=1;var e=Ps();function t(n){var r=n==null?0:n.length;return r?e(n,1):[]}return Yo=t,Yo}var Ko,Vl;function a_(){if(Vl)return Ko;Vl=1;var e=Zd,t=$h(),n=En;function r(i,o){return i==null?i:e(i,t(o),n)}return Ko=r,Ko}var Xo,Gl;function s_(){if(Gl)return Xo;Gl=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return Xo=e,Xo}var Wo,Ul;function c_(){if(Ul)return Wo;Ul=1;var e=rm,t=As(),n=it();function r(i,o){var a={};return o=n(o,3),t(i,function(s,c,l){e(a,c,o(s,c,l))}),a}return Wo=r,Wo}var Zo,Yl;function $s(){if(Yl)return Zo;Yl=1;var e=Xt();function t(n,r,i){for(var o=-1,a=n.length;++o<a;){var s=n[o],c=r(s);if(c!=null&&(l===void 0?c===c&&!e(c):i(c,l)))var l=c,u=s}return u}return Zo=t,Zo}var Qo,Kl;function u_(){if(Kl)return Qo;Kl=1;function e(t,n){return t>n}return Qo=e,Qo}var Jo,Xl;function l_(){if(Xl)return Jo;Xl=1;var e=$s(),t=u_(),n=Nn;function r(i){return i&&i.length?e(i,n,t):void 0}return Jo=r,Jo}var ea,Wl;function d_(){if(Wl)return ea;Wl=1;var e=om,t=im,n=t(function(r,i,o){e(r,i,o)});return ea=n,ea}var ta,Zl;function ap(){if(Zl)return ta;Zl=1;function e(t,n){return t<n}return ta=e,ta}var na,Ql;function f_(){if(Ql)return na;Ql=1;var e=$s(),t=ap(),n=Nn;function r(i){return i&&i.length?e(i,n,t):void 0}return na=r,na}var ra,Jl;function h_(){if(Jl)return ra;Jl=1;var e=$s(),t=it(),n=ap();function r(i,o){return i&&i.length?e(i,t(o,2),n):void 0}return ra=r,ra}var ia,ed;function p_(){if(ed)return ia;ed=1;var e=am,t=function(){return e.Date.now()};return ia=t,ia}var oa,td;function g_(){if(td)return oa;td=1;var e=os(),t=_r(),n=Jd,r=Sn,i=Rn();function o(a,s,c,l){if(!r(a))return a;s=t(s,a);for(var u=-1,d=s.length,f=d-1,h=a;h!=null&&++u<d;){var g=i(s[u]),m=c;if(g==="__proto__"||g==="constructor"||g==="prototype")return a;if(u!=f){var v=h[g];m=l?l(v,g,h):void 0,m===void 0&&(m=r(v)?v:n(s[u+1])?[]:{})}e(h,g,m),h=h[g]}return a}return oa=o,oa}var aa,nd;function m_(){if(nd)return aa;nd=1;var e=Er(),t=g_(),n=_r();function r(i,o,a){for(var s=-1,c=o.length,l={};++s<c;){var u=o[s],d=e(i,u);a(d,u)&&t(l,n(u,i),d)}return l}return aa=r,aa}var sa,rd;function v_(){if(rd)return sa;rd=1;var e=m_(),t=Hh();function n(r,i){return e(r,i,function(o,a){return t(r,a)})}return sa=n,sa}var ca,id;function y_(){if(id)return ca;id=1;var e=op(),t=sm,n=cm;function r(i){return n(t(i,void 0,e),i+"")}return ca=r,ca}var ua,od;function b_(){if(od)return ua;od=1;var e=v_(),t=y_(),n=t(function(r,i){return r==null?{}:e(r,i)});return ua=n,ua}var la,ad;function x_(){if(ad)return la;ad=1;var e=Math.ceil,t=Math.max;function n(r,i,o,a){for(var s=-1,c=t(e((i-r)/(o||1)),0),l=Array(c);c--;)l[a?c:++s]=r,r+=o;return l}return la=n,la}var da,sd;function w_(){if(sd)return da;sd=1;var e=x_(),t=us,n=ip();function r(i){return function(o,a,s){return s&&typeof s!="number"&&t(o,a,s)&&(a=s=void 0),o=n(o),a===void 0?(a=o,o=0):a=n(a),s=s===void 0?o<a?1:-1:n(s),e(o,a,s,i)}}return da=r,da}var fa,cd;function __(){if(cd)return fa;cd=1;var e=w_(),t=e();return fa=t,fa}var ha,ud;function E_(){if(ud)return ha;ud=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return ha=e,ha}var pa,ld;function S_(){if(ld)return pa;ld=1;var e=Xt();function t(n,r){if(n!==r){var i=n!==void 0,o=n===null,a=n===n,s=e(n),c=r!==void 0,l=r===null,u=r===r,d=e(r);if(!l&&!d&&!s&&n>r||s&&c&&u&&!l&&!d||o&&c&&u||!i&&u||!a)return 1;if(!o&&!s&&!d&&n<r||d&&i&&a&&!o&&!s||l&&i&&a||!c&&a||!u)return-1}return 0}return pa=t,pa}var ga,dd;function C_(){if(dd)return ga;dd=1;var e=S_();function t(n,r,i){for(var o=-1,a=n.criteria,s=r.criteria,c=a.length,l=i.length;++o<c;){var u=e(a[o],s[o]);if(u){if(o>=l)return u;var d=i[o];return u*(d=="desc"?-1:1)}}return n.index-r.index}return ga=t,ga}var ma,fd;function N_(){if(fd)return ma;fd=1;var e=wr(),t=Er(),n=it(),r=Kh(),i=E_(),o=is,a=C_(),s=Nn,c=xe;function l(u,d,f){d.length?d=e(d,function(m){return c(m)?function(v){return t(v,m.length===1?m[0]:m)}:m}):d=[s];var h=-1;d=e(d,o(n));var g=r(u,function(m,v,y){var _=e(d,function(C){return C(m)});return{criteria:_,index:++h,value:m}});return i(g,function(m,v){return a(m,v,f)})}return ma=l,ma}var va,hd;function M_(){if(hd)return va;hd=1;var e=Ps(),t=N_(),n=cs,r=us,i=n(function(o,a){if(o==null)return[];var s=a.length;return s>1&&r(o,a[0],a[1])?a=[]:s>2&&r(a[0],a[1],a[2])&&(a=[a[0]]),t(o,e(a,1),[])});return va=i,va}var ya,pd;function I_(){if(pd)return ya;pd=1;var e=zh(),t=0;function n(r){var i=++t;return e(r)+i}return ya=n,ya}var ba,gd;function k_(){if(gd)return ba;gd=1;function e(t,n,r){for(var i=-1,o=t.length,a=n.length,s={};++i<o;){var c=i<a?n[i]:void 0;r(s,t[i],c)}return s}return ba=e,ba}var xa,md;function R_(){if(md)return xa;md=1;var e=os(),t=k_();function n(r,i){return t(r||[],i||[],e)}return xa=n,xa}var ar;if(typeof ns=="function")try{ar={cloneDeep:Z1(),constant:nf(),defaults:Q1(),each:Fh(),filter:Gh(),find:o_(),flatten:op(),forEach:jh(),forIn:a_(),has:Uh(),isUndefined:Yh(),last:s_(),map:Xh(),mapValues:c_(),max:l_(),merge:d_(),min:f_(),minBy:h_(),now:p_(),pick:b_(),range:__(),reduce:Wh(),sortBy:M_(),uniqueId:I_(),values:Qh(),zipObject:R_()}}catch{}ar||(ar=window._);var ce=ar,T_=Sr;function Sr(){var e={};e._next=e._prev=e,this._sentinel=e}Sr.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return sp(t),t};Sr.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&sp(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};Sr.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,A_)),n=n._prev;return"["+e.join(", ")+"]"};function sp(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function A_(e,t){if(e!=="_next"&&e!=="_prev")return t}var Qe=ce,L_=Oe.Graph,P_=T_,q_=j_,$_=Qe.constant(1);function j_(e,t){if(e.nodeCount()<=1)return[];var n=D_(e,t||$_),r=F_(n.graph,n.buckets,n.zeroIdx);return Qe.flatten(Qe.map(r,function(i){return e.outEdges(i.v,i.w)}),!0)}function F_(e,t,n){for(var r=[],i=t[t.length-1],o=t[0],a;e.nodeCount();){for(;a=o.dequeue();)wa(e,t,n,a);for(;a=i.dequeue();)wa(e,t,n,a);if(e.nodeCount()){for(var s=t.length-2;s>0;--s)if(a=t[s].dequeue(),a){r=r.concat(wa(e,t,n,a,!0));break}}}return r}function wa(e,t,n,r,i){var o=i?[]:void 0;return Qe.forEach(e.inEdges(r.v),function(a){var s=e.edge(a),c=e.node(a.v);i&&o.push({v:a.v,w:a.w}),c.out-=s,Xa(t,n,c)}),Qe.forEach(e.outEdges(r.v),function(a){var s=e.edge(a),c=a.w,l=e.node(c);l.in-=s,Xa(t,n,l)}),e.removeNode(r.v),o}function D_(e,t){var n=new L_,r=0,i=0;Qe.forEach(e.nodes(),function(s){n.setNode(s,{v:s,in:0,out:0})}),Qe.forEach(e.edges(),function(s){var c=n.edge(s.v,s.w)||0,l=t(s),u=c+l;n.setEdge(s.v,s.w,u),i=Math.max(i,n.node(s.v).out+=l),r=Math.max(r,n.node(s.w).in+=l)});var o=Qe.range(i+r+3).map(function(){return new P_}),a=r+1;return Qe.forEach(n.nodes(),function(s){Xa(o,a,n.node(s))}),{graph:n,buckets:o,zeroIdx:a}}function Xa(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var St=ce,O_=q_,z_={run:B_,undo:V_};function B_(e){var t=e.graph().acyclicer==="greedy"?O_(e,n(e)):H_(e);St.forEach(t,function(r){var i=e.edge(r);e.removeEdge(r),i.forwardName=r.name,i.reversed=!0,e.setEdge(r.w,r.v,i,St.uniqueId("rev"))});function n(r){return function(i){return r.edge(i).weight}}}function H_(e){var t=[],n={},r={};function i(o){St.has(r,o)||(r[o]=!0,n[o]=!0,St.forEach(e.outEdges(o),function(a){St.has(n,a.w)?t.push(a):i(a.w)}),delete n[o])}return St.forEach(e.nodes(),i),t}function V_(e){St.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}var re=ce,cp=Oe.Graph,Ce={addDummyNode:up,simplify:G_,asNonCompoundGraph:U_,successorWeights:Y_,predecessorWeights:K_,intersectRect:X_,buildLayerMatrix:W_,normalizeRanks:Z_,removeEmptyRanks:Q_,addBorderNode:J_,maxRank:lp,partition:eE,time:tE,notime:nE};function up(e,t,n,r){var i;do i=re.uniqueId(r);while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function G_(e){var t=new cp().setGraph(e.graph());return re.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),re.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t}function U_(e){var t=new cp({multigraph:e.isMultigraph()}).setGraph(e.graph());return re.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),re.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t}function Y_(e){var t=re.map(e.nodes(),function(n){var r={};return re.forEach(e.outEdges(n),function(i){r[i.w]=(r[i.w]||0)+e.edge(i).weight}),r});return re.zipObject(e.nodes(),t)}function K_(e){var t=re.map(e.nodes(),function(n){var r={};return re.forEach(e.inEdges(n),function(i){r[i.v]=(r[i.v]||0)+e.edge(i).weight}),r});return re.zipObject(e.nodes(),t)}function X_(e,t){var n=e.x,r=e.y,i=t.x-n,o=t.y-r,a=e.width/2,s=e.height/2;if(!i&&!o)throw new Error("Not possible to find intersection inside of the rectangle");var c,l;return Math.abs(o)*a>Math.abs(i)*s?(o<0&&(s=-s),c=s*i/o,l=s):(i<0&&(a=-a),c=a,l=a*o/i),{x:n+c,y:r+l}}function W_(e){var t=re.map(re.range(lp(e)+1),function(){return[]});return re.forEach(e.nodes(),function(n){var r=e.node(n),i=r.rank;re.isUndefined(i)||(t[i][r.order]=n)}),t}function Z_(e){var t=re.min(re.map(e.nodes(),function(n){return e.node(n).rank}));re.forEach(e.nodes(),function(n){var r=e.node(n);re.has(r,"rank")&&(r.rank-=t)})}function Q_(e){var t=re.min(re.map(e.nodes(),function(o){return e.node(o).rank})),n=[];re.forEach(e.nodes(),function(o){var a=e.node(o).rank-t;n[a]||(n[a]=[]),n[a].push(o)});var r=0,i=e.graph().nodeRankFactor;re.forEach(n,function(o,a){re.isUndefined(o)&&a%i!==0?--r:r&&re.forEach(o,function(s){e.node(s).rank+=r})})}function J_(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),up(e,"border",i,t)}function lp(e){return re.max(re.map(e.nodes(),function(t){var n=e.node(t).rank;if(!re.isUndefined(n))return n}))}function eE(e,t){var n={lhs:[],rhs:[]};return re.forEach(e,function(r){t(r)?n.lhs.push(r):n.rhs.push(r)}),n}function tE(e,t){var n=re.now();try{return t()}finally{console.log(e+" time: "+(re.now()-n)+"ms")}}function nE(e,t){return t()}var dp=ce,rE=Ce,iE={run:oE,undo:sE};function oE(e){e.graph().dummyChains=[],dp.forEach(e.edges(),function(t){aE(e,t)})}function aE(e,t){var n=t.v,r=e.node(n).rank,i=t.w,o=e.node(i).rank,a=t.name,s=e.edge(t),c=s.labelRank;if(o!==r+1){e.removeEdge(t);var l,u,d;for(d=0,++r;r<o;++d,++r)s.points=[],u={width:0,height:0,edgeLabel:s,edgeObj:t,rank:r},l=rE.addDummyNode(e,"edge",u,"_d"),r===c&&(u.width=s.width,u.height=s.height,u.dummy="edge-label",u.labelpos=s.labelpos),e.setEdge(n,l,{weight:s.weight},a),d===0&&e.graph().dummyChains.push(l),n=l;e.setEdge(n,i,{weight:s.weight},a)}}function sE(e){dp.forEach(e.graph().dummyChains,function(t){var n=e.node(t),r=n.edgeLabel,i;for(e.setEdge(n.edgeObj,r);n.dummy;)i=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=i,n=e.node(t)})}var Dn=ce,Cr={longestPath:cE,slack:uE};function cE(e){var t={};function n(r){var i=e.node(r);if(Dn.has(t,r))return i.rank;t[r]=!0;var o=Dn.min(Dn.map(e.outEdges(r),function(a){return n(a.w)-e.edge(a).minlen}));return(o===Number.POSITIVE_INFINITY||o===void 0||o===null)&&(o=0),i.rank=o}Dn.forEach(e.sources(),n)}function uE(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var sr=ce,lE=Oe.Graph,cr=Cr.slack,fp=dE;function dE(e){var t=new lE({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var i,o;fE(t,e)<r;)i=hE(t,e),o=t.hasNode(i.v)?cr(e,i):-cr(e,i),pE(t,e,o);return t}function fE(e,t){function n(r){sr.forEach(t.nodeEdges(r),function(i){var o=i.v,a=r===o?i.w:o;!e.hasNode(a)&&!cr(t,i)&&(e.setNode(a,{}),e.setEdge(r,a,{}),n(a))})}return sr.forEach(e.nodes(),n),e.nodeCount()}function hE(e,t){return sr.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return cr(t,n)})}function pE(e,t,n){sr.forEach(e.nodes(),function(r){t.node(r).rank+=n})}var rt=ce,gE=fp,mE=Cr.slack,vE=Cr.longestPath,yE=Oe.alg.preorder,bE=Oe.alg.postorder,xE=Ce.simplify,wE=Lt;Lt.initLowLimValues=Fs;Lt.initCutValues=js;Lt.calcCutValue=hp;Lt.leaveEdge=gp;Lt.enterEdge=mp;Lt.exchangeEdges=vp;function Lt(e){e=xE(e),vE(e);var t=gE(e);Fs(t),js(t,e);for(var n,r;n=gp(t);)r=mp(t,e,n),vp(t,e,n,r)}function js(e,t){var n=bE(e,e.nodes());n=n.slice(0,n.length-1),rt.forEach(n,function(r){_E(e,t,r)})}function _E(e,t,n){var r=e.node(n),i=r.parent;e.edge(n,i).cutvalue=hp(e,t,n)}function hp(e,t,n){var r=e.node(n),i=r.parent,o=!0,a=t.edge(n,i),s=0;return a||(o=!1,a=t.edge(i,n)),s=a.weight,rt.forEach(t.nodeEdges(n),function(c){var l=c.v===n,u=l?c.w:c.v;if(u!==i){var d=l===o,f=t.edge(c).weight;if(s+=d?f:-f,SE(e,n,u)){var h=e.edge(n,u).cutvalue;s+=d?-h:h}}}),s}function Fs(e,t){arguments.length<2&&(t=e.nodes()[0]),pp(e,{},1,t)}function pp(e,t,n,r,i){var o=n,a=e.node(r);return t[r]=!0,rt.forEach(e.neighbors(r),function(s){rt.has(t,s)||(n=pp(e,t,n,s,r))}),a.low=o,a.lim=n++,i?a.parent=i:delete a.parent,n}function gp(e){return rt.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function mp(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var o=e.node(r),a=e.node(i),s=o,c=!1;o.lim>a.lim&&(s=a,c=!0);var l=rt.filter(t.edges(),function(u){return c===vd(e,e.node(u.v),s)&&c!==vd(e,e.node(u.w),s)});return rt.minBy(l,function(u){return mE(t,u)})}function vp(e,t,n,r){var i=n.v,o=n.w;e.removeEdge(i,o),e.setEdge(r.v,r.w,{}),Fs(e),js(e,t),EE(e,t)}function EE(e,t){var n=rt.find(e.nodes(),function(i){return!t.node(i).parent}),r=yE(e,n);r=r.slice(1),rt.forEach(r,function(i){var o=e.node(i).parent,a=t.edge(i,o),s=!1;a||(a=t.edge(o,i),s=!0),t.node(i).rank=t.node(o).rank+(s?a.minlen:-a.minlen)})}function SE(e,t,n){return e.hasEdge(t,n)}function vd(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}var CE=Cr,yp=CE.longestPath,NE=fp,ME=wE,IE=kE;function kE(e){switch(e.graph().ranker){case"network-simplex":yd(e);break;case"tight-tree":TE(e);break;case"longest-path":RE(e);break;default:yd(e)}}var RE=yp;function TE(e){yp(e),NE(e)}function yd(e){ME(e)}var Wa=ce,AE=LE;function LE(e){var t=qE(e);Wa.forEach(e.graph().dummyChains,function(n){for(var r=e.node(n),i=r.edgeObj,o=PE(e,t,i.v,i.w),a=o.path,s=o.lca,c=0,l=a[c],u=!0;n!==i.w;){if(r=e.node(n),u){for(;(l=a[c])!==s&&e.node(l).maxRank<r.rank;)c++;l===s&&(u=!1)}if(!u){for(;c<a.length-1&&e.node(l=a[c+1]).minRank<=r.rank;)c++;l=a[c]}e.setParent(n,l),n=e.successors(n)[0]}})}function PE(e,t,n,r){var i=[],o=[],a=Math.min(t[n].low,t[r].low),s=Math.max(t[n].lim,t[r].lim),c,l;c=n;do c=e.parent(c),i.push(c);while(c&&(t[c].low>a||s>t[c].lim));for(l=c,c=r;(c=e.parent(c))!==l;)o.push(c);return{path:i.concat(o.reverse()),lca:l}}function qE(e){var t={},n=0;function r(i){var o=n;Wa.forEach(e.children(i),r),t[i]={low:o,lim:n++}}return Wa.forEach(e.children(),r),t}var Je=ce,Za=Ce,$E={run:jE,cleanup:OE};function jE(e){var t=Za.addDummyNode(e,"root",{},"_root"),n=FE(e),r=Je.max(Je.values(n))-1,i=2*r+1;e.graph().nestingRoot=t,Je.forEach(e.edges(),function(a){e.edge(a).minlen*=i});var o=DE(e)+1;Je.forEach(e.children(),function(a){bp(e,t,i,o,r,n,a)}),e.graph().nodeRankFactor=i}function bp(e,t,n,r,i,o,a){var s=e.children(a);if(!s.length){a!==t&&e.setEdge(t,a,{weight:0,minlen:n});return}var c=Za.addBorderNode(e,"_bt"),l=Za.addBorderNode(e,"_bb"),u=e.node(a);e.setParent(c,a),u.borderTop=c,e.setParent(l,a),u.borderBottom=l,Je.forEach(s,function(d){bp(e,t,n,r,i,o,d);var f=e.node(d),h=f.borderTop?f.borderTop:d,g=f.borderBottom?f.borderBottom:d,m=f.borderTop?r:2*r,v=h!==g?1:i-o[a]+1;e.setEdge(c,h,{weight:m,minlen:v,nestingEdge:!0}),e.setEdge(g,l,{weight:m,minlen:v,nestingEdge:!0})}),e.parent(a)||e.setEdge(t,c,{weight:0,minlen:i+o[a]})}function FE(e){var t={};function n(r,i){var o=e.children(r);o&&o.length&&Je.forEach(o,function(a){n(a,i+1)}),t[r]=i}return Je.forEach(e.children(),function(r){n(r,1)}),t}function DE(e){return Je.reduce(e.edges(),function(t,n){return t+e.edge(n).weight},0)}function OE(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,Je.forEach(e.edges(),function(n){var r=e.edge(n);r.nestingEdge&&e.removeEdge(n)})}var _a=ce,zE=Ce,BE=HE;function HE(e){function t(n){var r=e.children(n),i=e.node(n);if(r.length&&_a.forEach(r,t),_a.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var o=i.minRank,a=i.maxRank+1;o<a;++o)bd(e,"borderLeft","_bl",n,i,o),bd(e,"borderRight","_br",n,i,o)}}_a.forEach(e.children(),t)}function bd(e,t,n,r,i,o){var a={width:0,height:0,rank:o,borderType:t},s=i[t][o-1],c=zE.addDummyNode(e,"border",a,n);i[t][o]=c,e.setParent(c,r),s&&e.setEdge(s,c,{weight:1})}var Ve=ce,VE={adjust:GE,undo:UE};function GE(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&xp(e)}function UE(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&YE(e),(t==="lr"||t==="rl")&&(KE(e),xp(e))}function xp(e){Ve.forEach(e.nodes(),function(t){xd(e.node(t))}),Ve.forEach(e.edges(),function(t){xd(e.edge(t))})}function xd(e){var t=e.width;e.width=e.height,e.height=t}function YE(e){Ve.forEach(e.nodes(),function(t){Ea(e.node(t))}),Ve.forEach(e.edges(),function(t){var n=e.edge(t);Ve.forEach(n.points,Ea),Ve.has(n,"y")&&Ea(n)})}function Ea(e){e.y=-e.y}function KE(e){Ve.forEach(e.nodes(),function(t){Sa(e.node(t))}),Ve.forEach(e.edges(),function(t){var n=e.edge(t);Ve.forEach(n.points,Sa),Ve.has(n,"x")&&Sa(n)})}function Sa(e){var t=e.x;e.x=e.y,e.y=t}var We=ce,XE=WE;function WE(e){var t={},n=We.filter(e.nodes(),function(s){return!e.children(s).length}),r=We.max(We.map(n,function(s){return e.node(s).rank})),i=We.map(We.range(r+1),function(){return[]});function o(s){if(!We.has(t,s)){t[s]=!0;var c=e.node(s);i[c.rank].push(s),We.forEach(e.successors(s),o)}}var a=We.sortBy(n,function(s){return e.node(s).rank});return We.forEach(a,o),i}var at=ce,ZE=QE;function QE(e,t){for(var n=0,r=1;r<t.length;++r)n+=JE(e,t[r-1],t[r]);return n}function JE(e,t,n){for(var r=at.zipObject(n,at.map(n,function(l,u){return u})),i=at.flatten(at.map(t,function(l){return at.sortBy(at.map(e.outEdges(l),function(u){return{pos:r[u.w],weight:e.edge(u).weight}}),"pos")}),!0),o=1;o<n.length;)o<<=1;var a=2*o-1;o-=1;var s=at.map(new Array(a),function(){return 0}),c=0;return at.forEach(i.forEach(function(l){var u=l.pos+o;s[u]+=l.weight;for(var d=0;u>0;)u%2&&(d+=s[u+1]),u=u-1>>1,s[u]+=l.weight;c+=l.weight*d})),c}var wd=ce,eS=tS;function tS(e,t){return wd.map(t,function(n){var r=e.inEdges(n);if(r.length){var i=wd.reduce(r,function(o,a){var s=e.edge(a),c=e.node(a.v);return{sum:o.sum+s.weight*c.order,weight:o.weight+s.weight}},{sum:0,weight:0});return{v:n,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:n}})}var Ie=ce,nS=rS;function rS(e,t){var n={};Ie.forEach(e,function(i,o){var a=n[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:o};Ie.isUndefined(i.barycenter)||(a.barycenter=i.barycenter,a.weight=i.weight)}),Ie.forEach(t.edges(),function(i){var o=n[i.v],a=n[i.w];!Ie.isUndefined(o)&&!Ie.isUndefined(a)&&(a.indegree++,o.out.push(n[i.w]))});var r=Ie.filter(n,function(i){return!i.indegree});return iS(r)}function iS(e){var t=[];function n(o){return function(a){a.merged||(Ie.isUndefined(a.barycenter)||Ie.isUndefined(o.barycenter)||a.barycenter>=o.barycenter)&&oS(o,a)}}function r(o){return function(a){a.in.push(o),--a.indegree===0&&e.push(a)}}for(;e.length;){var i=e.pop();t.push(i),Ie.forEach(i.in.reverse(),n(i)),Ie.forEach(i.out,r(i))}return Ie.map(Ie.filter(t,function(o){return!o.merged}),function(o){return Ie.pick(o,["vs","i","barycenter","weight"])})}function oS(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}var cn=ce,aS=Ce,sS=cS;function cS(e,t){var n=aS.partition(e,function(u){return cn.has(u,"barycenter")}),r=n.lhs,i=cn.sortBy(n.rhs,function(u){return-u.i}),o=[],a=0,s=0,c=0;r.sort(uS(!!t)),c=_d(o,i,c),cn.forEach(r,function(u){c+=u.vs.length,o.push(u.vs),a+=u.barycenter*u.weight,s+=u.weight,c=_d(o,i,c)});var l={vs:cn.flatten(o,!0)};return s&&(l.barycenter=a/s,l.weight=s),l}function _d(e,t,n){for(var r;t.length&&(r=cn.last(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}function uS(e){return function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}}var dt=ce,lS=eS,dS=nS,fS=sS,hS=wp;function wp(e,t,n,r){var i=e.children(t),o=e.node(t),a=o?o.borderLeft:void 0,s=o?o.borderRight:void 0,c={};a&&(i=dt.filter(i,function(g){return g!==a&&g!==s}));var l=lS(e,i);dt.forEach(l,function(g){if(e.children(g.v).length){var m=wp(e,g.v,n,r);c[g.v]=m,dt.has(m,"barycenter")&&gS(g,m)}});var u=dS(l,n);pS(u,c);var d=fS(u,r);if(a&&(d.vs=dt.flatten([a,d.vs,s],!0),e.predecessors(a).length)){var f=e.node(e.predecessors(a)[0]),h=e.node(e.predecessors(s)[0]);dt.has(d,"barycenter")||(d.barycenter=0,d.weight=0),d.barycenter=(d.barycenter*d.weight+f.order+h.order)/(d.weight+2),d.weight+=2}return d}function pS(e,t){dt.forEach(e,function(n){n.vs=dt.flatten(n.vs.map(function(r){return t[r]?t[r].vs:r}),!0)})}function gS(e,t){dt.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var un=ce,mS=Oe.Graph,vS=yS;function yS(e,t,n){var r=bS(e),i=new mS({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(o){return e.node(o)});return un.forEach(e.nodes(),function(o){var a=e.node(o),s=e.parent(o);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(i.setNode(o),i.setParent(o,s||r),un.forEach(e[n](o),function(c){var l=c.v===o?c.w:c.v,u=i.edge(l,o),d=un.isUndefined(u)?0:u.weight;i.setEdge(l,o,{weight:e.edge(c).weight+d})}),un.has(a,"minRank")&&i.setNode(o,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))}),i}function bS(e){for(var t;e.hasNode(t=un.uniqueId("_root")););return t}var xS=ce,wS=_S;function _S(e,t,n){var r={},i;xS.forEach(n,function(o){for(var a=e.parent(o),s,c;a;){if(s=e.parent(a),s?(c=r[s],r[s]=a):(c=i,i=a),c&&c!==a){t.setEdge(c,a);return}a=s}})}var pt=ce,ES=XE,SS=ZE,CS=hS,NS=vS,MS=wS,IS=Oe.Graph,Ed=Ce,kS=RS;function RS(e){var t=Ed.maxRank(e),n=Sd(e,pt.range(1,t+1),"inEdges"),r=Sd(e,pt.range(t-1,-1,-1),"outEdges"),i=ES(e);Cd(e,i);for(var o=Number.POSITIVE_INFINITY,a,s=0,c=0;c<4;++s,++c){TS(s%2?n:r,s%4>=2),i=Ed.buildLayerMatrix(e);var l=SS(e,i);l<o&&(c=0,a=pt.cloneDeep(i),o=l)}Cd(e,a)}function Sd(e,t,n){return pt.map(t,function(r){return NS(e,r,n)})}function TS(e,t){var n=new IS;pt.forEach(e,function(r){var i=r.graph().root,o=CS(r,i,n,t);pt.forEach(o.vs,function(a,s){r.node(a).order=s}),MS(r,n,o.vs)})}function Cd(e,t){pt.forEach(t,function(n){pt.forEach(n,function(r,i){e.node(r).order=i})})}var K=ce,AS=Oe.Graph,LS=Ce,PS={positionX:jS,findType1Conflicts:_p,findType2Conflicts:Ep,addConflict:Ds,hasConflict:Sp,verticalAlignment:Cp,horizontalCompaction:Np,alignCoordinates:Ip,findSmallestWidthAlignment:Mp,balance:kp};function _p(e,t){var n={};function r(i,o){var a=0,s=0,c=i.length,l=K.last(o);return K.forEach(o,function(u,d){var f=qS(e,u),h=f?e.node(f).order:c;(f||u===l)&&(K.forEach(o.slice(s,d+1),function(g){K.forEach(e.predecessors(g),function(m){var v=e.node(m),y=v.order;(y<a||h<y)&&!(v.dummy&&e.node(g).dummy)&&Ds(n,m,g)})}),s=d+1,a=h)}),o}return K.reduce(t,r),n}function Ep(e,t){var n={};function r(o,a,s,c,l){var u;K.forEach(K.range(a,s),function(d){u=o[d],e.node(u).dummy&&K.forEach(e.predecessors(u),function(f){var h=e.node(f);h.dummy&&(h.order<c||h.order>l)&&Ds(n,f,u)})})}function i(o,a){var s=-1,c,l=0;return K.forEach(a,function(u,d){if(e.node(u).dummy==="border"){var f=e.predecessors(u);f.length&&(c=e.node(f[0]).order,r(a,l,d,s,c),l=d,s=c)}r(a,l,a.length,c,o.length)}),a}return K.reduce(t,i),n}function qS(e,t){if(e.node(t).dummy)return K.find(e.predecessors(t),function(n){return e.node(n).dummy})}function Ds(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function Sp(e,t,n){if(t>n){var r=t;t=n,n=r}return K.has(e[t],n)}function Cp(e,t,n,r){var i={},o={},a={};return K.forEach(t,function(s){K.forEach(s,function(c,l){i[c]=c,o[c]=c,a[c]=l})}),K.forEach(t,function(s){var c=-1;K.forEach(s,function(l){var u=r(l);if(u.length){u=K.sortBy(u,function(m){return a[m]});for(var d=(u.length-1)/2,f=Math.floor(d),h=Math.ceil(d);f<=h;++f){var g=u[f];o[l]===l&&c<a[g]&&!Sp(n,l,g)&&(o[g]=l,o[l]=i[l]=i[g],c=a[g])}}})}),{root:i,align:o}}function Np(e,t,n,r,i){var o={},a=$S(e,t,n,i),s=i?"borderLeft":"borderRight";function c(d,f){for(var h=a.nodes(),g=h.pop(),m={};g;)m[g]?d(g):(m[g]=!0,h.push(g),h=h.concat(f(g))),g=h.pop()}function l(d){o[d]=a.inEdges(d).reduce(function(f,h){return Math.max(f,o[h.v]+a.edge(h))},0)}function u(d){var f=a.outEdges(d).reduce(function(g,m){return Math.min(g,o[m.w]-a.edge(m))},Number.POSITIVE_INFINITY),h=e.node(d);f!==Number.POSITIVE_INFINITY&&h.borderType!==s&&(o[d]=Math.max(o[d],f))}return c(l,a.predecessors.bind(a)),c(u,a.successors.bind(a)),K.forEach(r,function(d){o[d]=o[n[d]]}),o}function $S(e,t,n,r){var i=new AS,o=e.graph(),a=FS(o.nodesep,o.edgesep,r);return K.forEach(t,function(s){var c;K.forEach(s,function(l){var u=n[l];if(i.setNode(u),c){var d=n[c],f=i.edge(d,u);i.setEdge(d,u,Math.max(a(e,l,c),f||0))}c=l})}),i}function Mp(e,t){return K.minBy(K.values(t),function(n){var r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return K.forIn(n,function(o,a){var s=DS(e,a)/2;r=Math.max(o+s,r),i=Math.min(o-s,i)}),r-i})}function Ip(e,t){var n=K.values(t),r=K.min(n),i=K.max(n);K.forEach(["u","d"],function(o){K.forEach(["l","r"],function(a){var s=o+a,c=e[s],l;if(c!==t){var u=K.values(c);l=a==="l"?r-K.min(u):i-K.max(u),l&&(e[s]=K.mapValues(c,function(d){return d+l}))}})})}function kp(e,t){return K.mapValues(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var i=K.sortBy(K.map(e,r));return(i[1]+i[2])/2})}function jS(e){var t=LS.buildLayerMatrix(e),n=K.merge(_p(e,t),Ep(e,t)),r={},i;K.forEach(["u","d"],function(a){i=a==="u"?t:K.values(t).reverse(),K.forEach(["l","r"],function(s){s==="r"&&(i=K.map(i,function(d){return K.values(d).reverse()}));var c=(a==="u"?e.predecessors:e.successors).bind(e),l=Cp(e,i,n,c),u=Np(e,i,l.root,l.align,s==="r");s==="r"&&(u=K.mapValues(u,function(d){return-d})),r[a+s]=u})});var o=Mp(e,r);return Ip(r,o),kp(r,e.graph().align)}function FS(e,t,n){return function(r,i,o){var a=r.node(i),s=r.node(o),c=0,l;if(c+=a.width/2,K.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":l=-a.width/2;break;case"r":l=a.width/2;break}if(l&&(c+=n?l:-l),l=0,c+=(a.dummy?t:e)/2,c+=(s.dummy?t:e)/2,c+=s.width/2,K.has(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":l=s.width/2;break;case"r":l=-s.width/2;break}return l&&(c+=n?l:-l),l=0,c}}function DS(e,t){return e.node(t).width}var ln=ce,Rp=Ce,OS=PS.positionX,zS=BS;function BS(e){e=Rp.asNonCompoundGraph(e),HS(e),ln.forEach(OS(e),function(t,n){e.node(n).x=t})}function HS(e){var t=Rp.buildLayerMatrix(e),n=e.graph().ranksep,r=0;ln.forEach(t,function(i){var o=ln.max(ln.map(i,function(a){return e.node(a).height}));ln.forEach(i,function(a){e.node(a).y=r+o/2}),r+=o+n})}var W=ce,Nd=z_,Md=iE,VS=IE,GS=Ce.normalizeRanks,US=AE,YS=Ce.removeEmptyRanks,Id=$E,KS=BE,kd=VE,XS=kS,WS=zS,vt=Ce,ZS=Oe.Graph,QS=JS;function JS(e,t){var n=t&&t.debugTiming?vt.time:vt.notime;n("layout",function(){var r=n("  buildLayoutGraph",function(){return lC(e)});n("  runLayout",function(){eC(r,n)}),n("  updateInputGraph",function(){tC(e,r)})})}function eC(e,t){t("    makeSpaceForEdgeLabels",function(){dC(e)}),t("    removeSelfEdges",function(){xC(e)}),t("    acyclic",function(){Nd.run(e)}),t("    nestingGraph.run",function(){Id.run(e)}),t("    rank",function(){VS(vt.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){fC(e)}),t("    removeEmptyRanks",function(){YS(e)}),t("    nestingGraph.cleanup",function(){Id.cleanup(e)}),t("    normalizeRanks",function(){GS(e)}),t("    assignRankMinMax",function(){hC(e)}),t("    removeEdgeLabelProxies",function(){pC(e)}),t("    normalize.run",function(){Md.run(e)}),t("    parentDummyChains",function(){US(e)}),t("    addBorderSegments",function(){KS(e)}),t("    order",function(){XS(e)}),t("    insertSelfEdges",function(){wC(e)}),t("    adjustCoordinateSystem",function(){kd.adjust(e)}),t("    position",function(){WS(e)}),t("    positionSelfEdges",function(){_C(e)}),t("    removeBorderNodes",function(){bC(e)}),t("    normalize.undo",function(){Md.undo(e)}),t("    fixupEdgeLabelCoords",function(){vC(e)}),t("    undoCoordinateSystem",function(){kd.undo(e)}),t("    translateGraph",function(){gC(e)}),t("    assignNodeIntersects",function(){mC(e)}),t("    reversePoints",function(){yC(e)}),t("    acyclic.undo",function(){Nd.undo(e)})}function tC(e,t){W.forEach(e.nodes(),function(n){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height))}),W.forEach(e.edges(),function(n){var r=e.edge(n),i=t.edge(n);r.points=i.points,W.has(i,"x")&&(r.x=i.x,r.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var nC=["nodesep","edgesep","ranksep","marginx","marginy"],rC={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},iC=["acyclicer","ranker","rankdir","align"],oC=["width","height"],aC={width:0,height:0},sC=["minlen","weight","width","height","labeloffset"],cC={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},uC=["labelpos"];function lC(e){var t=new ZS({multigraph:!0,compound:!0}),n=Na(e.graph());return t.setGraph(W.merge({},rC,Ca(n,nC),W.pick(n,iC))),W.forEach(e.nodes(),function(r){var i=Na(e.node(r));t.setNode(r,W.defaults(Ca(i,oC),aC)),t.setParent(r,e.parent(r))}),W.forEach(e.edges(),function(r){var i=Na(e.edge(r));t.setEdge(r,W.merge({},cC,Ca(i,sC),W.pick(i,uC)))}),t}function dC(e){var t=e.graph();t.ranksep/=2,W.forEach(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function fC(e){W.forEach(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i=e.node(t.w),o={rank:(i.rank-r.rank)/2+r.rank,e:t};vt.addDummyNode(e,"edge-proxy",o,"_ep")}})}function hC(e){var t=0;W.forEach(e.nodes(),function(n){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=W.max(t,r.maxRank))}),e.graph().maxRank=t}function pC(e){W.forEach(e.nodes(),function(t){var n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function gC(e){var t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,i=0,o=e.graph(),a=o.marginx||0,s=o.marginy||0;function c(l){var u=l.x,d=l.y,f=l.width,h=l.height;t=Math.min(t,u-f/2),n=Math.max(n,u+f/2),r=Math.min(r,d-h/2),i=Math.max(i,d+h/2)}W.forEach(e.nodes(),function(l){c(e.node(l))}),W.forEach(e.edges(),function(l){var u=e.edge(l);W.has(u,"x")&&c(u)}),t-=a,r-=s,W.forEach(e.nodes(),function(l){var u=e.node(l);u.x-=t,u.y-=r}),W.forEach(e.edges(),function(l){var u=e.edge(l);W.forEach(u.points,function(d){d.x-=t,d.y-=r}),W.has(u,"x")&&(u.x-=t),W.has(u,"y")&&(u.y-=r)}),o.width=n-t+a,o.height=i-r+s}function mC(e){W.forEach(e.edges(),function(t){var n=e.edge(t),r=e.node(t.v),i=e.node(t.w),o,a;n.points?(o=n.points[0],a=n.points[n.points.length-1]):(n.points=[],o=i,a=r),n.points.unshift(vt.intersectRect(r,o)),n.points.push(vt.intersectRect(i,a))})}function vC(e){W.forEach(e.edges(),function(t){var n=e.edge(t);if(W.has(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function yC(e){W.forEach(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}function bC(e){W.forEach(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),i=e.node(n.borderBottom),o=e.node(W.last(n.borderLeft)),a=e.node(W.last(n.borderRight));n.width=Math.abs(a.x-o.x),n.height=Math.abs(i.y-r.y),n.x=o.x+n.width/2,n.y=r.y+n.height/2}}),W.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function xC(e){W.forEach(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function wC(e){var t=vt.buildLayerMatrix(e);W.forEach(t,function(n){var r=0;W.forEach(n,function(i,o){var a=e.node(i);a.order=o+r,W.forEach(a.selfEdges,function(s){vt.addDummyNode(e,"selfedge",{width:s.label.width,height:s.label.height,rank:a.rank,order:o+ ++r,e:s.e,label:s.label},"_se")}),delete a.selfEdges})})}function _C(e){W.forEach(e.nodes(),function(t){var n=e.node(t);if(n.dummy==="selfedge"){var r=e.node(n.e.v),i=r.x+r.width/2,o=r.y,a=n.x-i,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*a/3,y:o-s},{x:i+5*a/6,y:o-s},{x:i+a,y:o},{x:i+5*a/6,y:o+s},{x:i+2*a/3,y:o+s}],n.label.x=n.x,n.label.y=n.y}})}function Ca(e,t){return W.mapValues(W.pick(e,t),Number)}function Na(e){var t={};return W.forEach(e,function(n,r){t[r.toLowerCase()]=n}),t}var On=ce,EC=Ce,SC=Oe.Graph,CC={debugOrdering:NC};function NC(e){var t=EC.buildLayerMatrix(e),n=new SC({compound:!0,multigraph:!0}).setGraph({});return On.forEach(e.nodes(),function(r){n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),On.forEach(e.edges(),function(r){n.setEdge(r.v,r.w,{},r.name)}),On.forEach(t,function(r,i){var o="layer"+i;n.setNode(o,{rank:"same"}),On.reduce(r,function(a,s){return n.setEdge(a,s,{style:"invis"}),s})}),n}var MC="0.8.5",Os={graphlib:Oe,layout:QS,debug:CC,util:{time:Ce.time,notime:Ce.notime},version:MC};const ft=new Os.graphlib.Graph;ft.setDefaultEdgeLabel(()=>({}));const Rd=130,Td=28,IC=(e,t="LR")=>{const n=t==="LR";return ft.setGraph({rankdir:t}),e.forEach(r=>{ft.setNode(r.id,{width:Rd,height:Td})}),Os.layout(ft),e.map(r=>{const i=ft.node(r.id);return r.targetPosition=n?z.Left:z.Top,r.sourcePosition=n?z.Right:z.Bottom,r.position={x:i.x-Rd/2+Math.random()/1e3,y:i.y-Td/2},r})},kC=(e,t="LR")=>(ft.setGraph({rankdir:t}),e.forEach(n=>{ft.setEdge(n.source,n.target)}),Os.layout(ft),e),zn=33,RC=({id:e,sourceX:t,sourceY:n,targetX:r,targetY:i,sourcePosition:o,targetPosition:a,style:s={},markerType:c,markerEndId:l,selected:u,data:{onEdgeClick:d}})=>{const[f,h,g]=Cs({sourceX:t,sourceY:n,sourcePosition:o,targetX:r,targetY:i,targetPosition:a}),m=Db(c,l);return p.jsxs(p.Fragment,{children:[p.jsx("path",{id:e,style:s,className:"react-flow__edge-path",d:f,markerEnd:m}),u&&p.jsx("foreignObject",{width:zn,height:zn,x:h-zn/2,y:g-zn/2,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml",children:p.jsx("button",{className:"edgebutton",onClick:v=>d(v,e),children:p.jsx(zd,{})})})]})},TC=({data:e,selected:t})=>p.jsxs(p.Fragment,{children:[p.jsx(mt,{position:z.Right,type:"source"}),p.jsx("div",{className:`react-flow__node-default keycloak__authentication__conditional_node ${t?"selected":""}`,children:p.jsx("div",{children:e.label})}),p.jsx(mt,{position:z.Left,type:"target"})]}),AC=w.memo(TC),LC=({data:{label:e},prefix:t,selected:n})=>p.jsxs(p.Fragment,{children:[p.jsx(mt,{position:z.Right,type:"source"}),p.jsx("div",{className:`react-flow__node-default keycloak__authentication__subflow_node ${n?"selected":""}`,children:p.jsxs("div",{children:[t," ",e]})}),p.jsx(mt,{position:z.Left,type:"target"})]}),Tp=w.memo(LC),PC=({...e})=>p.jsx(Tp,{...e,prefix:"Start"}),qC=({...e})=>p.jsx(Tp,{...e,prefix:"End"});const kt=(e,t)=>({id:`edge-${e}-to-${t}`,type:"buttonEdge",source:e,target:t,data:{onEdgeClick:(n,r)=>{n.stopPropagation(),alert(`hello ${r}`)}}}),Ap=e=>{let t;return e.executionList&&(t="startSubFlow"),Qa(e)&&(t="conditional"),{id:e.id,type:t,sourcePosition:z.Right,targetPosition:z.Left,data:{label:e.displayName},position:{x:0,y:0}}},$C=e=>[Ap(e)],jC=(e,t,n)=>[kt(e.id,t.id),kt(t.id,n.id)],FC=e=>[Ap(e)],DC=(e,t,n,r,i,o)=>{const a=[];return i?a.push(kt(e.id,t.id)):a.push(kt(r.id,t.id)),o&&a.push(kt(t.id,n.id)),a},OC=e=>{const t=[];t.push({id:e.id,type:"startSubFlow",sourcePosition:z.Right,targetPosition:z.Left,data:{label:e.displayName},position:{x:0,y:0}});const n=`flow-end-${e.id}`;return t.push({id:n,type:"endSubFlow",sourcePosition:z.Right,targetPosition:z.Left,data:{label:e.displayName},position:{x:0,y:0}}),t.concat(Lp(e.executionList||[]))},zC=(e,t,n,r)=>{const i=[],o=`flow-end-${e.id}`;return i.push(kt(r&&r.requirement!=="ALTERNATIVE"?r.id:t.id,e.id)),i.push(kt(o,n.id)),i.concat(Pp(e,e.executionList||[],{...e,id:o}))},Lp=e=>{let t=[];for(let n=0;n<e.length;n++){const r=e[n];r.executionList?t=t.concat(OC(r)):r.requirement==="ALTERNATIVE"||r.requirement==="DISABLED"?t=t.concat($C(r)):t=t.concat(FC(r))}return t},Pp=(e,t,n)=>{let r=[];for(let i=0;i<t.length;i++){const o=t[i];o.executionList?r=r.concat(zC(o,e,n,t[i-1])):o.requirement==="ALTERNATIVE"||o.requirement==="DISABLED"?r=r.concat(jC(e,o,n)):r=r.concat(DC(e,o,n,t[i-1],i===0,i===t.length-1))}return r},BC={conditional:AC,startSubFlow:PC,endSubFlow:qC},HC={buttonEdge:RC};function Ad(e){return IC([{id:"start",sourcePosition:z.Right,type:"input",data:{label:"Start"},position:{x:0,y:0},className:"keycloak__authentication__input_node"},{id:"end",targetPosition:z.Left,type:"output",data:{label:"End"},position:{x:0,y:0},className:"keycloak__authentication__output_node"},...Lp(e)])}function Ld(e){return kC(Pp({id:"start"},e,{id:"end"}))}const VC=({executionList:{expandableList:e}})=>{const[t,n]=w.useState(!1),r=w.useMemo(()=>Ad(e),[]),i=w.useMemo(()=>Ld(e),[]),[o,a,s]=yw(r),[c,l,u]=bw(i);Dw(()=>{a(Ad(e)),l(Ld(e))},[e]);const d=h=>h.fitView(),f=()=>{n(!t)};return p.jsxs(Ih,{nodes:o,edges:c,onNodesChange:s,onEdgesChange:u,onInit:d,nodeTypes:BC,edgeTypes:HC,onNodeClick:f,nodesConnectable:!1,children:[p.jsx(Cw,{}),p.jsx(Aw,{}),p.jsx(Fw,{})]})},GC=({flow:e,toggleDialog:t})=>{const{t:n}=Fe("authentication"),{adminClient:r}=Kt(),{addAlert:i,addError:o}=ts(),a=ur({mode:"onChange"}),{reset:s,handleSubmit:c}=a;w.useEffect(()=>s(e),[e]);const l=async u=>{try{await r.authenticationManagement.updateFlow({flowId:e.id},{...e,...u}),i(n("updateFlowSuccess"),st.success)}catch(d){o("authentication:updateFlowError",d)}t()};return p.jsx(bn,{title:n("editFlow"),onClose:t,variant:xn.small,actions:[p.jsx(pe,{"data-testid":"confirm",type:"submit",form:"edit-flow-form",children:n("edit")},"confirm"),p.jsx(pe,{"data-testid":"cancel",variant:tt.link,onClick:()=>t(),children:n("common:cancel")},"cancel")],isOpen:!0,children:p.jsx(qd,{...a,children:p.jsx(wn,{id:"edit-flow-form",onSubmit:c(l),isHorizontal:!0,children:p.jsx(dm,{})})})})},Qa=e=>e.displayName?.startsWith("Condition ");function Z2(){const{t:e}=Fe("authentication"),{adminClient:t}=Kt(),{realm:n}=xg(),{addAlert:r,addError:i}=ts(),{id:o,usedBy:a,builtIn:s}=wg(),c=_g(),[l,u]=w.useState(0),d=()=>u(new Date().getTime()),[f,h]=w.useState(!0),[g,m]=w.useState(),[v,y]=w.useState(),[_,C]=w.useState(),[x,M]=w.useState(""),[N,L]=w.useState(),[$,P]=w.useState(),[O,j]=w.useState(),[F,R,b]=Ra(),[k,S]=w.useState(!1),[E,I]=Ra();yn(async()=>{const D=(await t.authenticationManagement.getFlows()).find(ie=>ie.id===o);if(!D)throw new Error(e("common:notFound"));const X=await t.authenticationManagement.getExecutions({flow:D.alias});return{flow:D,executions:X}},({flow:V,executions:D})=>{m(V),y(new fs(D))},[l]);const T=async(V,D)=>{try{let X=V.id;"parent"in D&&(await t.authenticationManagement.delExecution({id:X}),X=(await t.authenticationManagement.addExecutionToFlow({flow:D.parent?.displayName||g?.alias,provider:V.providerId})).id);const ie=D.newIndex-D.oldIndex;for(let ue=0;ue<Math.abs(ie);ue++)ie>0?await t.authenticationManagement.lowerPriorityExecution({id:X}):await t.authenticationManagement.raisePriorityExecution({id:X});d(),r(e("updateFlowSuccess"),st.success)}catch(X){i("authentication:updateFlowError",X)}},A=async V=>{const{executionList:D,isCollapsed:X,...ie}=V;try{await t.authenticationManagement.updateExecution({flow:g?.alias},ie),d(),r(e("updateFlowSuccess"),st.success)}catch(ue){i("authentication:updateFlowError",ue)}},B=async(V,D)=>{try{await t.authenticationManagement.addExecutionToFlow({flow:V,provider:D.id}),d(),r(e("updateFlowSuccess"),st.success)}catch(X){i("authentication:updateFlowError",X)}},H=async(V,{name:D,description:X="",type:ie,provider:ue})=>{try{await t.authenticationManagement.addFlowToFlow({flow:V,alias:D,description:X,provider:ue,type:ie}),d(),r(e("updateFlowSuccess"),st.success)}catch(te){i("authentication:updateFlowError",te)}},[Y,U]=Ys({titleKey:"authentication:deleteConfirmExecution",children:p.jsxs(Ks,{i18nKey:"authentication:deleteConfirmExecutionMessage",children:[" ",p.jsx("strong",{children:{name:O?.displayName}}),"."]}),continueButtonLabel:"common:delete",continueButtonVariant:tt.danger,onConfirm:async()=>{try{await t.authenticationManagement.delExecution({id:O?.id}),r(e("deleteExecutionSuccess"),st.success),d()}catch(V){i("authentication:deleteExecutionError",V)}}}),[Q,J]=Ys({titleKey:"authentication:deleteConfirmFlow",children:p.jsxs(Ks,{i18nKey:"authentication:deleteConfirmFlowMessage",children:[" ",p.jsx("strong",{children:{flow:g?.alias||""}}),"."]}),continueButtonLabel:"common:delete",continueButtonVariant:tt.danger,onConfirm:async()=>{try{await t.authenticationManagement.deleteFlow({flowId:g.id}),c(Eg({realm:n})),r(e("deleteFlowSuccess"),st.success)}catch(V){i("authentication:deleteFlowError",V)}}}),ee=v?.expandableList.length!==0,ne=[...a!=="DEFAULT"?[p.jsx(_t,{"data-testid":"set-as-default",onClick:I,children:e("bindFlow")},"default")]:[],p.jsx(_t,{onClick:()=>b(!0),children:e("duplicate")},"duplicate"),...s?[]:[p.jsx(_t,{"data-testid":"edit-flow",onClick:()=>S(!0),children:e("editInfo")},"edit"),p.jsx(_t,{"data-testid":"delete-flow",onClick:()=>Q(),children:e("common:delete")},"delete")]];return p.jsxs(p.Fragment,{children:[E&&p.jsx(um,{flowAlias:g?.alias,onClose:()=>{I(),d()}}),F&&p.jsx(lm,{name:g?.alias,description:g?.description,toggleDialog:R,onComplete:()=>{d(),b(!1)}}),k&&p.jsx(GC,{flow:g,toggleDialog:()=>{S(!k),d()}}),p.jsx(J,{}),p.jsx(Cg,{titleKey:g?.alias||"",badges:[{text:p.jsx(Us,{children:e(`used.${a}`)})},s?{text:p.jsx(Us,{className:"keycloak_authentication-section__usedby_label",icon:p.jsx(Sg,{}),children:e("buildIn")}),id:"builtIn"}:{}],dropdownItems:ne}),p.jsxs(Pd,{variant:"light",children:[v&&ee&&p.jsxs(p.Fragment,{children:[p.jsx(fm,{id:"toolbar",children:p.jsxs(hm,{children:[p.jsx(Tr,{children:p.jsxs(of,{children:[p.jsx(Kn,{icon:p.jsx(xm,{}),"aria-label":e("tableView"),buttonId:"tableView",isSelected:f,onChange:()=>h(!0)}),p.jsx(Kn,{icon:p.jsx(ym,{}),"aria-label":e("diagramView"),buttonId:"diagramView",isSelected:!f,onChange:()=>h(!1)})]})}),p.jsx(Tr,{children:p.jsx(pe,{"data-testid":"addStep",variant:"secondary",onClick:()=>L(!0),children:e("addStep")})}),p.jsx(Tr,{children:p.jsx(pe,{"data-testid":"addSubFlow",variant:"secondary",onClick:()=>P(!0),children:e("addSubFlow")})})]})}),p.jsx(U,{}),f&&p.jsxs(Rg,{"aria-label":e("flows"),onDragFinish:V=>{const D=V.slice(1);M(e("common:onDragFinish",{list:_?.displayName}));const X=v.getChange(_,D);T(_,X)},onDragStart:V=>{const D=v.findExecution(V);M(e("common:onDragStart",{item:D.displayName})),C(D),D.isCollapsed||(D.isCollapsed=!0,y(v.clone()))},onDragMove:()=>M(e("common:onDragMove",{item:_?.displayName})),onDragCancel:()=>M(e("common:onDragCancel")),itemOrder:["header",...v.order().map(V=>V.id)],children:[p.jsx(Sm,{}),p.jsx(p.Fragment,{children:v.expandableList.map(V=>p.jsx(af,{builtIn:!!s,execution:V,onRowClick:D=>{D.isCollapsed=!D.isCollapsed,y(v.clone())},onRowChange:A,onAddExecution:(D,X)=>B(D.displayName,X),onAddFlow:(D,X)=>H(D.displayName,X),onDelete:D=>{j(D),Y()}},V.id))})]}),g&&p.jsxs(p.Fragment,{children:[N&&p.jsx(ls,{name:g.alias,type:g.providerId==="client-flow"?"client":"basic",onSelect:V=>{V&&B(g.alias,V),L(!1)}}),$&&p.jsx(ds,{name:g.alias,onCancel:()=>P(!1),onConfirm:V=>{H(g.alias,V),P(!1)}})]}),p.jsx("div",{className:"pf-screen-reader","aria-live":"assertive",children:x})]}),!f&&v?.expandableList&&p.jsx(VC,{executionList:v}),!v?.expandableList||g&&!ee&&p.jsx(Em,{flow:g,onAddExecution:V=>B(g.alias,V),onAddFlow:V=>H(g.alias,V)})]})]})}export{Z2 as default,Qa as providerConditionFilter};
//# sourceMappingURL=FlowDetails-ca9f2fb1.js.map
