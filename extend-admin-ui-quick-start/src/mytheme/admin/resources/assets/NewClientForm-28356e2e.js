import{r as n,i as c,B as k,k as P,af as xe,ag as Ne,l as U,ah as ve,ai as q,_ as Q,aj as ze,T as Ce,ak as ye,u as X,a as Ee,ac as Te,j as m,F as Ie,G as ke,C as Be,c as _e,d as Le,b as Ae,e as je,f as Fe,P as De,g as We,al as Oe,s as Pe,A as Ve,ab as Ge}from"./index-a3421f29.js";import{F as Y}from"./FormAccess-1cceaef6.js";import{V as Me}from"./ViewHeader-832ec56e.js";import{C as Je,a as He}from"./ClientDescription-be494204.js";import{g as Ke}from"./utils-49fe564a.js";import{S as $e,a as Re,b as Ue}from"./Select-0f56a9cc.js";import{L as qe}from"./LoginSettings-2f4d45bc.js";import{M as Qe,a as Xe}from"./Modal-21c37af7.js";import"./copy-icon-a4fe01af.js";import"./Form-518a2cf2.js";import"./GridItem-d34dae2e.js";import"./Text-564bf299.js";import"./ToolbarContent-7b435752.js";import"./Checkbox-d00621d8.js";import"./check-fc57dbe1.js";import"./star-icon-6a7e7d25.js";import"./KeycloakTextInput-e7f6e917.js";import"./MultiLineInput-14187d1c.js";import"./minus-circle-icon-6f9a971c.js";import"./plus-circle-icon-cb854796.js";const l={button:"pf-c-button",card:"pf-c-card",drawer:"pf-c-drawer",modalBox:"pf-c-modal-box",modifiers:{finished:"pf-m-finished",expanded:"pf-m-expanded",current:"pf-m-current",expandable:"pf-m-expandable",disabled:"pf-m-disabled",noPadding:"pf-m-no-padding"},pageMainWizard:"pf-c-page__main-wizard",themeDark:"pf-theme-dark",wizard:"pf-c-wizard",wizardClose:"pf-c-wizard__close",wizardDescription:"pf-c-wizard__description",wizardFooter:"pf-c-wizard__footer",wizardFooterCancel:"pf-c-wizard__footer-cancel",wizardHeader:"pf-c-wizard__header",wizardInnerWrap:"pf-c-wizard__inner-wrap",wizardMain:"pf-c-wizard__main",wizardMainBody:"pf-c-wizard__main-body",wizardNav:"pf-c-wizard__nav",wizardNavItem:"pf-c-wizard__nav-item",wizardNavLink:"pf-c-wizard__nav-link",wizardNavLinkText:"pf-c-wizard__nav-link-text",wizardNavLinkToggle:"pf-c-wizard__nav-link-toggle",wizardNavLinkToggleIcon:"pf-c-wizard__nav-link-toggle-icon",wizardNavList:"pf-c-wizard__nav-list",wizardOuterWrap:"pf-c-wizard__outer-wrap",wizardTitle:"pf-c-wizard__title",wizardToggle:"pf-c-wizard__toggle",wizardToggleIcon:"pf-c-wizard__toggle-icon",wizardToggleList:"pf-c-wizard__toggle-list",wizardToggleListItem:"pf-c-wizard__toggle-list-item",wizardToggleNum:"pf-c-wizard__toggle-num",wizardToggleSeparator:"pf-c-wizard__toggle-separator"},Z=({onNext:o,onBack:r,onClose:d,isValid:t,firstStep:e,activeStep:a,nextButtonText:i,backButtonText:s,cancelButtonText:p})=>n.createElement("footer",{className:c(l.wizardFooter)},n.createElement(k,{variant:P.primary,type:"submit",onClick:o,isDisabled:!t},i),!a.hideBackButton&&n.createElement(k,{variant:P.secondary,onClick:r,isDisabled:e},s),!a.hideCancelButton&&n.createElement("div",{className:l.wizardFooterCancel},n.createElement(k,{variant:P.link,onClick:d},p)));Z.displayName="WizardFooterInternal";const ee=({hasDrawer:o,wrapper:r,children:d})=>o?r(d):d;ee.displayName="WizardDrawerWrapper";const te=({children:o,hasNoBodyPadding:r=!1,"aria-label":d,"aria-labelledby":t,mainComponent:e="div",hasDrawer:a,isDrawerExpanded:i,onExpandDrawer:s,activeStep:p})=>{const u=e;return n.createElement(u,{"aria-label":d,"aria-labelledby":t,className:c(l.wizardMain)},n.createElement(ee,{hasDrawer:a&&p.drawerPanelContent,wrapper:h=>n.createElement(xe,{isInline:!0,isExpanded:i,onExpand:s},n.createElement(Ne,{panelContent:p.drawerPanelContent},h))},n.createElement("div",{className:c(l.wizardMainBody,r&&l.modifiers.noPadding)},o)))};te.displayName="WizardBody";const ae=({isNavOpen:o,onNavToggle:r,nav:d,steps:t,activeStep:e,children:a,hasNoBodyPadding:i=!1,"aria-label":s="Wizard Toggle",mainAriaLabelledBy:p=null,mainAriaLabel:u=null,isInPage:h=!0,hasDrawer:f,isDrawerExpanded:x,onExpandDrawer:C})=>{let b,z,v;for(let g=0;g<t.length;g++)if(e.id&&t[g].id===e.id||t[g].name===e.name){b=g+1,z=t[g].name;break}else if(t[g].steps){for(const y of t[g].steps)if(e.id&&y.id===e.id||y.name===e.name){b=g+1,z=t[g].name,v=y.name;break}}return n.createElement(n.Fragment,null,n.createElement("button",{onClick:()=>r(!o),className:c(l.wizardToggle,o&&"pf-m-expanded"),"aria-label":s,"aria-expanded":o},n.createElement("span",{className:c(l.wizardToggleList)},n.createElement("span",{className:c(l.wizardToggleListItem)},n.createElement("span",{className:c(l.wizardToggleNum)},b)," ",z,v&&n.createElement(U,{className:c(l.wizardToggleSeparator),"aria-hidden":"true"})),v&&n.createElement("span",{className:c(l.wizardToggleListItem)},v)),n.createElement("span",{className:c(l.wizardToggleIcon)},n.createElement(ve,{"aria-hidden":"true"}))),n.createElement("div",{className:c(l.wizardOuterWrap)},n.createElement("div",{className:c(l.wizardInnerWrap)},d(o),n.createElement(te,{mainComponent:h?"div":"main","aria-label":u,"aria-labelledby":p,hasNoBodyPadding:i,activeStep:e,isDrawerExpanded:x,onExpandDrawer:C,hasDrawer:f},f&&!x&&e.drawerToggleButton,e.component)),a))};ae.displayName="WizardToggle";const F=({children:o,"aria-label":r,"aria-labelledby":d,isOpen:t=!1,returnList:e=!1,ouiaId:a,ouiaSafe:i=!0})=>{const s=q(F.displayName,a,i),p=n.createElement("ol",{className:c(l.wizardNavList)},o);return e?p:n.createElement("nav",Object.assign({className:c(l.wizardNav,t&&l.modifiers.expanded),"aria-label":r,"aria-labelledby":d},s),n.createElement("ol",{className:c(l.wizardNavList)},o))};F.displayName="WizardNav";const L=o=>{var{children:r=null,content:d="",isCurrent:t=!1,isDisabled:e=!1,step:a,onNavItemClick:i=()=>{},navItemComponent:s="button",href:p=null,isExpandable:u=!1,id:h,ouiaId:f,ouiaSafe:x=!0}=o,C=Q(o,["children","content","isCurrent","isDisabled","step","onNavItemClick","navItemComponent","href","isExpandable","id","ouiaId","ouiaSafe"]);const b=q(L.displayName,f,x),z=s,[v,g]=n.useState(!1);n.useEffect(()=>{g(t)},[t]);const y={disabled:e},N={tabIndex:e?-1:void 0,href:p};return n.createElement("li",{className:c(l.wizardNavItem,u&&l.modifiers.expandable,u&&v&&l.modifiers.expanded)},n.createElement(z,Object.assign({},C,s==="a"?Object.assign({},N):Object.assign({},y),h&&{id:h.toString()},{onClick:()=>u?g(!v||t):i(a),className:c(l.wizardNavLink,t&&l.modifiers.current,e&&l.modifiers.disabled),"aria-disabled":e?!0:null,"aria-current":t&&!r?"step":!1},u&&{"aria-expanded":v},b),u?n.createElement(n.Fragment,null,n.createElement("span",{className:c(l.wizardNavLinkText)},d),n.createElement("span",{className:c(l.wizardNavLinkToggle)},n.createElement("span",{className:c(l.wizardNavLinkToggleIcon)},n.createElement(U,null)))):d),r)};L.displayName="WizardNavItem";const ne=n.createContext({goToStepById:()=>null,goToStepByName:()=>null,onNext:()=>null,onBack:()=>null,onClose:()=>null,activeStep:{name:null}}),Ye=ne.Provider,Ze=ne.Consumer,ie=({onClose:o=()=>{},title:r,description:d,hideClose:t,closeButtonAriaLabel:e,titleId:a,descriptionComponent:i="p",descriptionId:s})=>n.createElement("div",{className:c(l.wizardHeader)},!t&&n.createElement(k,{variant:"plain",className:c(l.wizardClose),"aria-label":e,onClick:o},n.createElement(ze,{"aria-hidden":"true"})),n.createElement(Ce,{headingLevel:"h2",size:"3xl",className:c(l.wizardTitle),"aria-label":r,id:a},r||n.createElement(n.Fragment,null,"Â ")),d&&n.createElement(i,{className:c(l.wizardDescription),id:s},d));ie.displayName="WizardHeader";class _ extends n.Component{constructor(r){super(r),this.handleKeyClicks=t=>{t.key===ye.Escape&&(this.state.isNavOpen?this.setState({isNavOpen:!this.state.isNavOpen}):this.props.isOpen&&this.props.onClose())},this.onNext=()=>{const{onNext:t,onClose:e,onSave:a}=this.props,{currentStep:i}=this.state,s=this.getFlattenedSteps(),p=s.length;if(i>=p)return a?a():e();{let u=i;for(let b=i;b<=p;b++){if(!s[b])return;if(!s[b].isDisabled){u=b+1;break}}this.setCurrentStep(u,s[u-1]);const{id:h,name:f}=s[i-1],{id:x,name:C}=s[u-1];return t&&t({id:x,name:C},{prevId:h,prevName:f})}},this.onBack=()=>{const{onBack:t}=this.props,{currentStep:e}=this.state,a=this.getFlattenedSteps();if(a.length<e){const i=a.length;this.setCurrentStep(i,a[i-1])}else{let i=e;for(let f=e;f>=0;f--){if(!a[f-2])return;if(!a[f-2].isDisabled){i=f-1<=1?1:f-1;break}}this.setCurrentStep(i,a[i-1]);const{id:s,name:p}=a[i],{id:u,name:h}=a[i-1];return t&&t({id:u,name:h},{prevId:s,prevName:p})}},this.goToStep=t=>{const e=this.getFlattenedSteps();if(e[t-1].isDisabled)return;const{onGoToStep:a}=this.props,{currentStep:i}=this.state,s=e.length;t<1?t=1:t>s&&(t=s),this.setCurrentStep(t,e[t-1]),this.setState({isNavOpen:!1});const{id:p,name:u}=e[i-1],{id:h,name:f}=e[t-1];return a&&a({id:h,name:f},{prevId:p,prevName:u})},this.goToStepById=t=>{const e=this.getFlattenedSteps();let a;for(let i=0;i<e.length;i++)if(e[i].id===t){a=i+1;break}a&&this.setCurrentStep(a,e[a-1])},this.goToStepByName=t=>{const e=this.getFlattenedSteps();let a;for(let i=0;i<e.length;i++)if(e[i].name===t){a=i+1;break}a&&this.setCurrentStep(a,e[a-1])},this.getFlattenedSteps=()=>{const{steps:t}=this.props,e=[];for(const a of t)if(a.steps)for(const i of a.steps)e.push(i);else e.push(a);return e},this.getFlattenedStepsIndex=(t,e)=>{for(let a=0;a<t.length;a++)if(t[a].name===e)return a+1;return 0},this.initSteps=t=>{for(let e=0;e<t.length;e++){if(t[e].steps)for(let a=0;a<t[e].steps.length;a++)t[e].steps[a]=Object.assign({canJumpTo:!0},t[e].steps[a]);t[e]=Object.assign({canJumpTo:!0},t[e])}return t},this.getElement=t=>typeof t=="function"?t():t||document.body;const d=_.currentId++;if(this.titleId=r.titleId||`pf-wizard-title-${d}`,this.descriptionId=r.descriptionId||`pf-wizard-description-${d}`,this.state={currentStep:this.props.startAtStep&&Number.isInteger(this.props.startAtStep)?this.props.startAtStep:1,isNavOpen:!1},r.onCurrentStepChanged){const t=this.getFlattenedSteps();if(t.length>=this.state.currentStep){const e=t[this.state.currentStep-1];r.onCurrentStepChanged(e)}}this.drawerRef=n.createRef()}setCurrentStep(r,d){this.setState({currentStep:r}),this.props.onCurrentStepChanged&&this.props.onCurrentStepChanged(d)}componentDidMount(){const r=typeof document<"u"?document.body:null;r&&r.addEventListener("keydown",this.handleKeyClicks,!1)}componentWillUnmount(){const r=typeof document<"u"&&document.body||null;r&&r.removeEventListener("keydown",this.handleKeyClicks,!1)}componentDidUpdate(r){r.startAtStep!==this.props.startAtStep&&this.setState({currentStep:this.props.startAtStep})}render(){const r=this.props,{width:d,height:t,title:e,description:a,descriptionComponent:i,onClose:s,onSave:p,onBack:u,onNext:h,onGoToStep:f,className:x,steps:C,startAtStep:b,nextButtonText:z="Next",backButtonText:v="Back",cancelButtonText:g="Cancel",hideClose:y,closeButtonAriaLabel:N="Close",navAriaLabel:T,navAriaLabelledBy:A,mainAriaLabel:D,mainAriaLabelledBy:V,hasNoBodyPadding:se,footer:oe,appendTo:tt,isOpen:W,titleId:at,descriptionId:nt,isNavExpandable:le,onCurrentStepChanged:it,hasDrawer:de,isDrawerExpanded:ce,onExpandDrawer:pe}=r,me=Q(r,["width","height","title","description","descriptionComponent","onClose","onSave","onBack","onNext","onGoToStep","className","steps","startAtStep","nextButtonText","backButtonText","cancelButtonText","hideClose","closeButtonAriaLabel","navAriaLabel","navAriaLabelledBy","mainAriaLabel","mainAriaLabelledBy","hasNoBodyPadding","footer","appendTo","isOpen","titleId","descriptionId","isNavExpandable","onCurrentStepChanged","hasDrawer","isDrawerExpanded","onExpandDrawer"]),{currentStep:G}=this.state,I=this.getFlattenedSteps(),ue=I.length<G?I.length:G,w=I[ue-1],fe=this.initSteps(C),ge=w===I[0],he=w&&w.enableNext!==void 0?w.enableNext:!0,be=O=>{const H={isOpen:O,"aria-label":T,"aria-labelledby":(e||A)&&(A||this.titleId)};return n.createElement(F,Object.assign({},H),fe.map((S,K)=>{if(S.isFinishedStep)return;let j,B;if(S.steps){let $=!1,R=!1;for(const E of S.steps)w.name===E.name&&($=!0),E.canJumpTo&&(R=!0);return B=this.getFlattenedStepsIndex(I,S.steps[0].name),n.createElement(L,{key:K,id:S.id,content:S.name,isExpandable:le,isCurrent:$,isDisabled:!R,step:B,onNavItemClick:this.goToStep},n.createElement(F,Object.assign({},H,{returnList:!0}),S.steps.map((E,Se)=>{if(!E.isFinishedStep)return B=this.getFlattenedStepsIndex(I,E.name),j=E.canJumpTo&&!E.isDisabled,n.createElement(L,{key:`child_${Se}`,id:E.id,content:E.name,isCurrent:w.name===E.name,isDisabled:!j,step:B,onNavItemClick:this.goToStep})})))}return B=this.getFlattenedStepsIndex(I,S.name),j=S.canJumpTo&&!S.isDisabled,n.createElement(L,Object.assign({},S.stepNavItemProps,{key:K,id:S.id,content:S.name,isCurrent:w.name===S.name,isDisabled:!j,step:B,onNavItemClick:this.goToStep}))}))},we={goToStepById:this.goToStepById,goToStepByName:this.goToStepByName,onNext:this.onNext,onBack:this.onBack,onClose:s,activeStep:w},M=Object.assign(Object.assign({},t?{height:t}:{}),d?{width:d}:{}),J=n.createElement(Ye,{value:we},n.createElement("div",Object.assign({},me,{className:c(l.wizard,w&&w.isFinishedStep&&"pf-m-finished",x),style:Object.keys(M).length?M:void 0}),e&&n.createElement(ie,{titleId:this.titleId,descriptionId:this.descriptionId,onClose:s,title:e,description:a,descriptionComponent:i,closeButtonAriaLabel:N,hideClose:y}),n.createElement(ae,{hasDrawer:de,isDrawerExpanded:ce,onExpandDrawer:pe,mainAriaLabel:D,isInPage:W===void 0,mainAriaLabelledBy:(e||V)&&(V||this.titleId),isNavOpen:this.state.isNavOpen,onNavToggle:O=>this.setState({isNavOpen:O}),nav:be,steps:C,activeStep:w,hasNoBodyPadding:se},oe||n.createElement(Z,{onNext:this.onNext,onBack:this.onBack,onClose:s,isValid:he,firstStep:ge,activeStep:w,nextButtonText:w&&w.nextButtonText||z,backButtonText:v,cancelButtonText:g}))));return W!==void 0?n.createElement(Qe,{width:d!==null?d:void 0,isOpen:W,variant:Xe.large,"aria-labelledby":this.titleId,"aria-describedby":this.descriptionId,showClose:!1,hasNoBodyWrapper:!0},J):J}}_.displayName="Wizard";_.currentId=0;_.defaultProps={title:null,description:"",descriptionComponent:"p",className:"",startAtStep:1,nextButtonText:"Next",backButtonText:"Back",cancelButtonText:"Cancel",hideClose:!1,closeButtonAriaLabel:"Close",navAriaLabel:null,navAriaLabelledBy:null,mainAriaLabel:null,mainAriaLabelledBy:null,hasNoBodyPadding:!1,onBack:null,onNext:null,onGoToStep:null,width:null,height:null,footer:null,onClose:()=>{},appendTo:null,isOpen:void 0,isNavExpandable:!1,hasDrawer:!1,isDrawerExpanded:!1,onExpandDrawer:()=>{}};const re=({children:o})=>n.createElement("footer",{className:c(l.wizardFooter)},o);re.displayName="WizardFooter";const et=()=>{const{t:o}=X("clients"),{control:r,formState:{errors:d}}=Ee(),t=Te(),[e,a]=n.useState(!1);return m.jsxs(Y,{isHorizontal:!0,role:"manage-clients",children:[m.jsx(Ie,{label:o("clientType"),fieldId:"kc-type",validated:d.protocol?"error":"default",labelIcon:m.jsx(ke,{helpText:o("clients-help:clientType"),fieldLabelId:"clients:clientType"}),children:m.jsx(Be,{name:"protocol",defaultValue:"",control:r,render:({field:i})=>m.jsx($e,{id:"kc-type",onToggle:a,onSelect:(s,p)=>{i.onChange(p.toString()),a(!1)},selections:i.value,variant:Re.single,"aria-label":o("selectEncryptionType"),isOpen:e,children:t.map(s=>m.jsx(Ue,{selected:s===i.value,value:s,"data-testid":`option-${s}`,children:Ke(o,s)},s))})})}),m.jsx(Je,{hasConfigureAccess:!0})]})};function yt(){const{t:o}=X("clients"),{realm:r}=_e(),{adminClient:d}=Le(),t=Ae(),[e,a]=n.useState(0),{addAlert:i,addError:s}=je(),p=Fe({defaultValues:{protocol:"openid-connect",clientId:"",name:"",description:"",publicClient:!0,authorizationServicesEnabled:!1,serviceAccountsEnabled:!1,implicitFlowEnabled:!1,directAccessGrantsEnabled:!0,standardFlowEnabled:!0,frontchannelLogout:!0,attributes:{saml_idp_initiated_sso_url_name:""}}}),{getValues:u,watch:h,trigger:f}=p,x=h("protocol"),C=async()=>{const N=Pe(u());try{const T=await d.clients.create({...N,clientId:N.clientId?.trim()});i(o("createSuccess"),Ve.success),t(Ge({realm:r,clientId:T.id,tab:"settings"}))}catch(T){s("clients:createError",T)}},b=async N=>{await f()&&(z()||a(e+1),N?.())},z=()=>x==="openid-connect"?e===2:e===1,v=()=>{a(e-1)},g=N=>{N.id==="generalSettings"?a(0):N.id==="capabilityConfig"?a(1):a(2)},y=o("createClient");return m.jsxs(m.Fragment,{children:[m.jsx(Me,{titleKey:"clients:createClient",subKey:"clients:clientsExplain"}),m.jsx(De,{variant:"light",children:m.jsx(We,{...p,children:m.jsx(_,{onClose:()=>t(Oe({realm:r})),navAriaLabel:`${y} steps`,mainAriaLabel:`${y} content`,steps:[{id:"generalSettings",name:o("generalSettings"),component:m.jsx(et,{})},...x!=="saml"?[{id:"capabilityConfig",name:o("capabilityConfig"),component:m.jsx(He,{protocol:x}),canJumpTo:e>=1}]:[],{id:"loginSettings",name:o("loginSettings"),component:m.jsx(Y,{isHorizontal:!0,role:"manage-clients",children:m.jsx(qe,{protocol:x})}),canJumpTo:e>=1}],footer:m.jsx(re,{children:m.jsx(Ze,{children:({activeStep:N,onNext:T,onBack:A,onClose:D})=>m.jsxs(m.Fragment,{children:[m.jsx(k,{variant:"primary","data-testid":z()?"save":"next",type:"submit",onClick:()=>{b(T)},children:z()?o("common:save"):o("common:next")}),m.jsx(k,{variant:"secondary","data-testid":"back",onClick:()=>{v(),A()},isDisabled:N.name===o("generalSettings"),children:o("common:back")}),m.jsx(k,{"data-testid":"cancel",variant:"link",onClick:D,children:o("common:cancel")})]})})}),onSave:C,onGoToStep:g})})})]})}export{yt as default};
//# sourceMappingURL=NewClientForm-28356e2e.js.map
