import{u as F,d as k,a as w,r as n,j as r,F as u,G as m,S,aU as U}from"./index-a3421f29.js";import{K as C}from"./KeycloakTextInput-e7f6e917.js";const q=({id:o,fileUpload:E,children:c})=>{const{t:s}=F("identity-providers"),{adminClient:f}=k(),{setValue:h,register:x,setError:D,watch:g,clearErrors:a,formState:{errors:t}}=w(),l=g("discoveryEndpoint"),[i,b]=n.useState(!0),[p,d]=n.useState(!1),[y,j]=n.useState(),I=e=>{Object.keys(e).map(v=>h(`config.${v}`,e[v]))};return n.useEffect(()=>{if(!l){d(!1);return}(async()=>{a("discoveryError");try{const e=await f.identityProviders.importFromUrl({providerId:o,fromUrl:l});I(e),j(e)}catch(e){D("discoveryError",{type:"manual",message:e.message})}d(!1)})()},[p]),r.jsxs(r.Fragment,{children:[r.jsx(u,{label:s(o==="oidc"?"useDiscoveryEndpoint":"useEntityDescriptor"),fieldId:"kc-discovery-endpoint",labelIcon:r.jsx(m,{helpText:`identity-providers-help:${o==="oidc"?"useDiscoveryEndpoint":"useEntityDescriptor"}`,fieldLabelId:"identity-providers:discoveryEndpoint"}),children:r.jsx(S,{id:"kc-discovery-endpoint-switch",label:s("common:on"),labelOff:s("common:off"),isChecked:i,onChange:e=>{a("discoveryError"),b(e)},"aria-label":s(o==="oidc"?"useDiscoveryEndpoint":"useEntityDescriptor")})}),i&&r.jsx(u,{label:s(o==="oidc"?"discoveryEndpoint":"samlEntityDescriptor"),fieldId:"kc-discovery-endpoint",labelIcon:r.jsx(m,{helpText:`identity-providers-help:${o==="oidc"?"discoveryEndpoint":"samlEntityDescriptor"}`,fieldLabelId:"identity-providers:discoveryEndpoint"}),validated:t.discoveryError||t.discoveryEndpoint?"error":y?"success":"default",helperTextInvalid:t.discoveryEndpoint?s("common:required"):s("noValidMetaDataFound",{error:t.discoveryError?.message}),isRequired:!0,children:r.jsx(C,{type:"url","data-testid":"discoveryEndpoint",id:"kc-discovery-endpoint",placeholder:o==="oidc"?"https://hostname/auth/realms/master/.well-known/openid-configuration":"",validated:t.discoveryError||t.discoveryEndpoint?"error":y?"success":"default",customIconUrl:p?U.resourceUrl+"/discovery-load-indicator.svg":"",...x("discoveryEndpoint",{required:!0,onBlur:()=>d(!0)})})}),!i&&E,i&&!t.discoveryError&&c(!0),!i&&c(!1)]})};export{q as D};
//# sourceMappingURL=DiscoveryEndpointField-1ac4d0ed.js.map
