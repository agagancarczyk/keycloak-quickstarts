{"version":3,"file":"ClientSelect-3f0fc581.js","sources":["../../src/components/client/ClientSelect.tsx"],"sourcesContent":["import {\n  FormGroup,\n  Select,\n  SelectOption,\n  SelectVariant,\n} from \"@patternfly/react-core\";\nimport { useState } from \"react\";\nimport { Controller, useFormContext } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\n\nimport type ClientRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/clientRepresentation\";\nimport type { ClientQuery } from \"@keycloak/keycloak-admin-client/lib/resources/clients\";\nimport { useAdminClient, useFetch } from \"../../context/auth/AdminClient\";\nimport type { ComponentProps } from \"../dynamic/components\";\nimport { HelpItem } from \"ui-shared\";\n\ntype ClientSelectProps = ComponentProps & {\n  namespace: string;\n  required?: boolean;\n};\n\nexport const ClientSelect = ({\n  name,\n  label,\n  helpText,\n  defaultValue,\n  namespace,\n  isDisabled = false,\n  required = false,\n}: ClientSelectProps) => {\n  const { t } = useTranslation(namespace);\n  const {\n    control,\n    formState: { errors },\n  } = useFormContext();\n\n  const [open, setOpen] = useState(false);\n  const [clients, setClients] = useState<ClientRepresentation[]>([]);\n  const [search, setSearch] = useState(\"\");\n\n  const { adminClient } = useAdminClient();\n\n  useFetch(\n    () => {\n      const params: ClientQuery = {\n        max: 20,\n      };\n      if (search) {\n        params.clientId = search;\n        params.search = true;\n      }\n      return adminClient.clients.find(params);\n    },\n    (clients) => setClients(clients),\n    [search]\n  );\n\n  const convert = (clients: ClientRepresentation[]) => [\n    <SelectOption key=\"empty\" value=\"\">\n      {t(\"common:none\")}\n    </SelectOption>,\n    ...clients.map((option) => (\n      <SelectOption key={option.id} value={option.clientId} />\n    )),\n  ];\n\n  return (\n    <FormGroup\n      label={t(label!)}\n      isRequired={required}\n      labelIcon={\n        <HelpItem\n          helpText={t(helpText!)}\n          fieldLabelId={`${namespace}:${label}`}\n        />\n      }\n      fieldId={name!}\n      validated={errors[name!] ? \"error\" : \"default\"}\n      helperTextInvalid={t(\"common:required\")}\n    >\n      <Controller\n        name={name!}\n        defaultValue={defaultValue || \"\"}\n        control={control}\n        rules={required ? { required: true } : {}}\n        render={({ field }) => (\n          <Select\n            toggleId={name}\n            variant={SelectVariant.typeahead}\n            onToggle={(open) => setOpen(open)}\n            isOpen={open}\n            isDisabled={isDisabled}\n            selections={field.value}\n            onFilter={(_, value) => {\n              setSearch(value);\n              return convert(clients);\n            }}\n            onSelect={(_, value) => {\n              field.onChange(value.toString());\n              setOpen(false);\n            }}\n            typeAheadAriaLabel={t(label!)}\n          >\n            {convert(clients)}\n          </Select>\n        )}\n      />\n    </FormGroup>\n  );\n};\n"],"names":["ClientSelect","name","label","helpText","defaultValue","namespace","isDisabled","required","t","useTranslation","control","errors","useFormContext","open","setOpen","useState","clients","setClients","search","setSearch","adminClient","useAdminClient","useFetch","params","convert","SelectOption","option","jsx","FormGroup","HelpItem","Controller","field","Select","SelectVariant","_","value"],"mappings":"uJAqBO,MAAMA,EAAe,CAAC,CAC3B,KAAAC,EACA,MAAAC,EACA,SAAAC,EACA,aAAAC,EACA,UAAAC,EACA,WAAAC,EAAa,GACb,SAAAC,EAAW,EACb,IAAyB,CACvB,KAAM,CAAE,EAAAC,CAAA,EAAMC,EAAeJ,CAAS,EAChC,CACJ,QAAAK,EACA,UAAW,CAAE,OAAAC,CAAO,GAClBC,EAAe,EAEb,CAACC,EAAMC,CAAO,EAAIC,WAAS,EAAK,EAChC,CAACC,EAASC,CAAU,EAAIF,EAAA,SAAiC,CAAE,CAAA,EAC3D,CAACG,EAAQC,CAAS,EAAIJ,WAAS,EAAE,EAEjC,CAAE,YAAAK,GAAgBC,IAExBC,EACE,IAAM,CACJ,MAAMC,EAAsB,CAC1B,IAAK,EAAA,EAEP,OAAIL,IACFK,EAAO,SAAWL,EAClBK,EAAO,OAAS,IAEXH,EAAY,QAAQ,KAAKG,CAAM,CACxC,EACCP,GAAYC,EAAWD,CAAO,EAC/B,CAACE,CAAM,CAAA,EAGH,MAAAM,EAAWR,GAAoC,OAClDS,EAAyB,CAAA,MAAM,GAC7B,SAAEjB,EAAA,aAAa,GADA,OAElB,EACA,GAAGQ,EAAQ,IAAKU,GACdC,EAAA,IAACF,EAA6B,CAAA,MAAOC,EAAO,QAAA,EAAzBA,EAAO,EAA4B,CACvD,CAAA,EAID,OAAAC,EAAA,IAACC,EAAA,CACC,MAAOpB,EAAEN,CAAM,EACf,WAAYK,EACZ,UACEoB,EAAA,IAACE,EAAA,CACC,SAAUrB,EAAEL,CAAS,EACrB,aAAc,GAAGE,KAAaH,GAAA,CAChC,EAEF,QAASD,EACT,UAAWU,EAAOV,CAAK,EAAI,QAAU,UACrC,kBAAmBO,EAAE,iBAAiB,EAEtC,SAAAmB,EAAA,IAACG,EAAA,CACC,KAAA7B,EACA,aAAcG,GAAgB,GAC9B,QAAAM,EACA,MAAOH,EAAW,CAAE,SAAU,IAAS,CAAC,EACxC,OAAQ,CAAC,CAAE,MAAAwB,CAAA,IACTJ,EAAA,IAACK,EAAA,CACC,SAAU/B,EACV,QAASgC,EAAc,UACvB,SAAWpB,GAASC,EAAQD,CAAI,EAChC,OAAQA,EACR,WAAAP,EACA,WAAYyB,EAAM,MAClB,SAAU,CAACG,EAAGC,KACZhB,EAAUgB,CAAK,EACRX,EAAQR,CAAO,GAExB,SAAU,CAACkB,EAAGC,IAAU,CAChBJ,EAAA,SAASI,EAAM,SAAU,CAAA,EAC/BrB,EAAQ,EAAK,CACf,EACA,mBAAoBN,EAAEN,CAAM,EAE3B,WAAQc,CAAO,CAAA,CAClB,CAAA,CAEJ,CAAA,CAAA,CAGN"}