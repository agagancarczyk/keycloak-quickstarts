import{u as x,d as S,c as I,r as y,N as P,n as w,j as e,F as l,G as n,C as b,S as h,f as R,b as F,e as q,g as C,P as v,B as k,da as A,A as L}from"./index-a3421f29.js";import{u as H}from"./useParams-5abeab7d.js";import{F as N}from"./FormAccess-1cceaef6.js";import{K as d}from"./KeycloakTextInput-e7f6e917.js";import{W as D,H as E,S as O}from"./SettingsCache-d185f52c.js";import{i as V}from"./isEqual-69fbe00f.js";import{S as K,a as M,b as j}from"./Select-0f56a9cc.js";import{F as $,A as G}from"./Form-518a2cf2.js";import"./copy-icon-a4fe01af.js";import"./GridItem-d34dae2e.js";import"./ConfirmDialog-09ff7a12.js";import"./Modal-21c37af7.js";import"./ViewHeader-832ec56e.js";import"./Text-564bf299.js";import"./ToolbarContent-7b435752.js";import"./useToggle-a9cb2c55.js";import"./NumberInput-85f36a0d.js";import"./minus-icon-16876c86.js";import"./plus-icon-2a767bad.js";import"./check-fc57dbe1.js";import"./star-icon-6a7e7d25.js";const U=({form:a,showSectionHeading:i=!1,showSectionDescription:c=!1})=>{const{t:r}=x("user-federation"),{t:p}=x("user-federation-help"),{adminClient:s}=S(),{realm:m}=I(),[f,u]=y.useState(!1),g=P({control:a.control,name:"config.allowPasswordAuthentication"});return w(()=>s.realms.findOne({realm:m}),t=>a.setValue("parentId",t.id),[]),e.jsxs(e.Fragment,{children:[i&&e.jsx(D,{title:r("requiredSettings"),description:p("kerberosRequiredSettingsDescription"),showDescription:c}),e.jsxs(N,{role:"manage-realm",isHorizontal:!0,children:[e.jsxs(l,{label:r("uiDisplayName"),labelIcon:e.jsx(n,{helpText:r("user-federation-help:uiDisplayNameHelp"),fieldLabelId:"user-federation:uiDisplayName"}),fieldId:"kc-ui-display-name",isRequired:!0,validated:a.formState.errors.name?"error":"default",helperTextInvalid:a.formState.errors.name?.message,children:[e.jsx(d,{hidden:!0,id:"kc-ui-providerId",defaultValue:"kerberos",...a.register("providerId")}),e.jsx(d,{hidden:!0,id:"kc-ui-providerType",defaultValue:"org.keycloak.storage.UserStorageProvider",...a.register("providerType")}),e.jsx(d,{hidden:!0,id:"kc-ui-parentId",defaultValue:m,...a.register("parentId")}),e.jsx(d,{isRequired:!0,id:"kc-ui-name","data-testid":"kerberos-name",validated:a.formState.errors.name?"error":"default","aria-label":r("uiDisplayName"),...a.register("name",{required:{value:!0,message:r("validateName")}})})]}),e.jsx(l,{label:r("kerberosRealm"),labelIcon:e.jsx(n,{helpText:r("user-federation-help:kerberosRealmHelp"),fieldLabelId:"user-federation:kc-kerberos-realm"}),fieldId:"kc-kerberos-realm",isRequired:!0,validated:a.formState.errors.config?.kerberosRealm?.[0]?"error":"default",helperTextInvalid:a.formState.errors.config?.kerberosRealm?.[0].message,children:e.jsx(d,{isRequired:!0,id:"kc-kerberos-realm","data-testid":"kerberos-realm",validated:a.formState.errors.config?.kerberosRealm?.[0]?"error":"default",...a.register("config.kerberosRealm.0",{required:{value:!0,message:r("validateRealm")}})})}),e.jsx(l,{label:r("serverPrincipal"),labelIcon:e.jsx(n,{helpText:r("user-federation-help:serverPrincipalHelp"),fieldLabelId:"user-federation:serverPrincipal"}),fieldId:"kc-server-principal",isRequired:!0,validated:a.formState.errors.config?.serverPrincipal?.[0]?"error":"default",helperTextInvalid:a.formState.errors.config?.serverPrincipal?.[0].message,children:e.jsx(d,{isRequired:!0,id:"kc-server-principal","data-testid":"kerberos-principal",validated:a.formState.errors.config?.serverPrincipal?.[0]?"error":"default",...a.register("config.serverPrincipal.0",{required:{value:!0,message:r("validateServerPrincipal")}})})}),e.jsx(l,{label:r("keyTab"),labelIcon:e.jsx(n,{helpText:r("user-federation-help:keyTabHelp"),fieldLabelId:"user-federation:keyTab"}),fieldId:"kc-key-tab",isRequired:!0,validated:a.formState.errors.config?.keyTab?.[0]?"error":"default",helperTextInvalid:a.formState.errors.config?.keyTab?.[0].message,children:e.jsx(d,{isRequired:!0,id:"kc-key-tab","data-testid":"kerberos-keytab",validated:a.formState.errors.config?.keyTab?.[0]?"error":"default",...a.register("config.keyTab.0",{required:{value:!0,message:r("validateKeyTab")}})})}),e.jsxs(l,{label:r("debug"),labelIcon:e.jsx(n,{helpText:r("user-federation-help:debugHelp"),fieldLabelId:"user-federation:debug"}),fieldId:"kc-debug",hasNoPaddingTop:!0,children:[" ",e.jsx(b,{name:"config.debug",defaultValue:["false"],control:a.control,render:({field:t})=>e.jsx(h,{id:"kc-debug","data-testid":"debug",onChange:o=>t.onChange([`${o}`]),isChecked:t.value?.[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("debug")})})]}),e.jsx(l,{label:r("allowPasswordAuthentication"),labelIcon:e.jsx(n,{helpText:r("user-federation-help:allowPasswordAuthenticationHelp"),fieldLabelId:"user-federation:allowPasswordAuthentication"}),fieldId:"kc-allow-password-authentication",hasNoPaddingTop:!0,children:e.jsx(b,{name:"config.allowPasswordAuthentication",defaultValue:["false"],control:a.control,render:({field:t})=>e.jsx(h,{id:"kc-allow-password-authentication","data-testid":"allow-password-authentication",onChange:o=>t.onChange([`${o}`]),isChecked:t.value?.[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("allowPasswordAuthentication")})})}),V(g,["true"])?e.jsxs(l,{label:r("editMode"),labelIcon:e.jsx(n,{helpText:r("user-federation-help:editModeKerberosHelp"),fieldLabelId:"user-federation:editMode"}),isRequired:!0,fieldId:"kc-edit-mode",children:[" ",e.jsx(b,{name:"config.editMode[0]",defaultValue:"READ_ONLY",control:a.control,rules:{required:!0},render:({field:t})=>e.jsxs(K,{toggleId:"kc-edit-mode",required:!0,onToggle:()=>u(!f),isOpen:f,onSelect:(o,T)=>{t.onChange(T),u(!1)},selections:t.value,variant:M.single,children:[e.jsx(j,{value:"READ_ONLY",isPlaceholder:!0},0),e.jsx(j,{value:"UNSYNCED"},1)]})})]}):null,e.jsx(l,{label:r("updateFirstLogin"),labelIcon:e.jsx(n,{helpText:r("user-federation-help:updateFirstLoginHelp"),fieldLabelId:"user-federation:updateFirstLogin"}),fieldId:"kc-update-first-login",hasNoPaddingTop:!0,children:e.jsx(b,{name:"config.updateProfileFirstLogin",defaultValue:["false"],control:a.control,render:({field:t})=>e.jsx(h,{id:"kc-update-first-login","data-testid":"update-first-login",onChange:o=>t.onChange([`${o}`]),isChecked:t.value?.[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("updateFirstLogin")})})})]})]})};function pe(){const{t:a}=x("user-federation"),i=R({mode:"onChange"}),c=F(),{adminClient:r}=S(),{realm:p}=I(),{id:s}=H(),{addAlert:m,addError:f}=q();w(async()=>{if(s)return r.components.findOne({id:s})},t=>{if(t)u(t);else if(s)throw new Error(a("common:notFound"))},[]);const u=t=>{i.reset({...t})},g=async t=>{try{s?await r.components.update({id:s},t):(await r.components.create(t),c(`/${p}/user-federation`)),u(t),m(a(s?"saveSuccess":"createSuccess"),L.success)}catch(o){f(`user-federation:${s?"saveError":"createError"}`,o)}};return e.jsxs(e.Fragment,{children:[e.jsx(C,{...i,children:e.jsx(E,{provider:"Kerberos",save:()=>i.handleSubmit(g)()})}),e.jsx(v,{variant:"light",children:e.jsx(U,{form:i,showSectionHeading:!0})}),e.jsxs(v,{variant:"light",isFilled:!0,children:[e.jsx(O,{form:i,showSectionHeading:!0}),e.jsx($,{onSubmit:i.handleSubmit(g),children:e.jsxs(G,{children:[e.jsx(k,{isDisabled:!i.formState.isDirty,variant:"primary",type:"submit","data-testid":"kerberos-save",children:a("common:save")}),e.jsx(k,{variant:"link",onClick:()=>c(A({realm:p})),"data-testid":"kerberos-cancel",children:a("common:cancel")})]})})]})]})}export{pe as default};
//# sourceMappingURL=UserFederationKerberosSettings-8fbb675f.js.map
