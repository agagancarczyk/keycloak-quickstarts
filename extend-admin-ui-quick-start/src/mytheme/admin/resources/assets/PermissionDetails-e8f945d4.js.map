{"version":3,"file":"PermissionDetails-e8f945d4.js","sources":["../../src/clients/authorization/ScopeSelect.tsx","../../src/clients/authorization/PermissionDetails.tsx"],"sourcesContent":["import { useRef, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Controller, useFormContext } from \"react-hook-form\";\nimport { Select, SelectOption, SelectVariant } from \"@patternfly/react-core\";\n\nimport type ScopeRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/scopeRepresentation\";\nimport { useAdminClient, useFetch } from \"../../context/auth/AdminClient\";\n\ntype ScopeSelectProps = {\n  clientId: string;\n  resourceId?: string;\n  preSelected?: string;\n};\n\nexport const ScopeSelect = ({\n  clientId,\n  resourceId,\n  preSelected,\n}: ScopeSelectProps) => {\n  const { t } = useTranslation(\"clients\");\n  const { adminClient } = useAdminClient();\n\n  const {\n    control,\n    getValues,\n    setValue,\n    formState: { errors },\n  } = useFormContext();\n\n  const [scopes, setScopes] = useState<ScopeRepresentation[]>([]);\n  const [selectedScopes, setSelectedScopes] = useState<ScopeRepresentation[]>(\n    []\n  );\n  const [search, setSearch] = useState(\"\");\n  const [open, setOpen] = useState(false);\n  const firstUpdate = useRef(true);\n\n  const values: string[] | undefined = getValues(\"scopes\");\n\n  const toSelectOptions = (scopes: ScopeRepresentation[]) =>\n    scopes.map((scope) => (\n      <SelectOption key={scope.id} value={scope}>\n        {scope.name}\n      </SelectOption>\n    ));\n\n  useFetch(\n    async (): Promise<ScopeRepresentation[]> => {\n      if (!resourceId) {\n        return adminClient.clients.listAllScopes(\n          Object.assign(\n            { id: clientId, deep: false },\n            search === \"\" ? null : { name: search }\n          )\n        );\n      }\n\n      if (resourceId && !firstUpdate.current) {\n        setValue(\"scopes\", []);\n      }\n\n      firstUpdate.current = false;\n      return adminClient.clients.listScopesByResource({\n        id: clientId,\n        resourceName: resourceId,\n      });\n    },\n    (scopes) => {\n      setScopes(scopes);\n      if (!search)\n        setSelectedScopes(\n          scopes.filter((s: ScopeRepresentation) => values?.includes(s.id!))\n        );\n    },\n    [resourceId, search]\n  );\n\n  return (\n    <Controller\n      name=\"scopes\"\n      defaultValue={preSelected ? [preSelected] : []}\n      control={control}\n      rules={{ validate: (value) => value.length > 0 }}\n      render={({ field }) => (\n        <Select\n          toggleId=\"scopes\"\n          variant={SelectVariant.typeaheadMulti}\n          onToggle={setOpen}\n          onFilter={(_, filter) => {\n            setSearch(filter);\n            return toSelectOptions(scopes);\n          }}\n          onClear={() => {\n            field.onChange([]);\n            setSearch(\"\");\n          }}\n          selections={selectedScopes.map((s) => s.name)}\n          onSelect={(_, selectedValue) => {\n            const option =\n              typeof selectedValue === \"string\"\n                ? selectedScopes.find((s) => s.name === selectedValue)!\n                : (selectedValue as ScopeRepresentation);\n            const changedValue = selectedScopes.find((p) => p.id === option.id)\n              ? selectedScopes.filter((p) => p.id !== option.id)\n              : [...selectedScopes, option];\n\n            field.onChange(changedValue.map((s) => s.id));\n            setSelectedScopes(changedValue);\n            setSearch(\"\");\n          }}\n          isOpen={open}\n          aria-labelledby={t(\"scopes\")}\n          validated={errors.scopes ? \"error\" : \"default\"}\n          isDisabled={!!preSelected}\n          typeAheadAriaLabel={t(\"scopes\")}\n        >\n          {toSelectOptions(scopes)}\n        </Select>\n      )}\n    />\n  );\n};\n","import type PolicyRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/policyRepresentation\";\nimport { DecisionStrategy } from \"@keycloak/keycloak-admin-client/lib/defs/policyRepresentation\";\nimport {\n  ActionGroup,\n  AlertVariant,\n  Button,\n  ButtonVariant,\n  DropdownItem,\n  FormGroup,\n  PageSection,\n  Radio,\n  SelectVariant,\n  Switch,\n} from \"@patternfly/react-core\";\nimport { useState } from \"react\";\nimport { Controller, FormProvider, useForm, useWatch } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link, useNavigate } from \"react-router-dom\";\n\nimport { useAlerts } from \"../../components/alert/Alerts\";\nimport { useConfirmDialog } from \"../../components/confirm-dialog/ConfirmDialog\";\nimport { FormAccess } from \"../../components/form-access/FormAccess\";\nimport { HelpItem } from \"ui-shared\";\nimport { KeycloakSpinner } from \"../../components/keycloak-spinner/KeycloakSpinner\";\nimport { KeycloakTextArea } from \"../../components/keycloak-text-area/KeycloakTextArea\";\nimport { KeycloakTextInput } from \"../../components/keycloak-text-input/KeycloakTextInput\";\nimport { ViewHeader } from \"../../components/view-header/ViewHeader\";\nimport { useAdminClient, useFetch } from \"../../context/auth/AdminClient\";\nimport { toUpperCase } from \"../../util\";\nimport { useParams } from \"../../utils/useParams\";\nimport { toAuthorizationTab } from \"../routes/AuthenticationTab\";\nimport type { NewPermissionParams } from \"../routes/NewPermission\";\nimport {\n  PermissionDetailsParams,\n  toPermissionDetails,\n} from \"../routes/PermissionDetails\";\nimport { ResourcesPolicySelect } from \"./ResourcesPolicySelect\";\nimport { ScopeSelect } from \"./ScopeSelect\";\n\ntype FormFields = PolicyRepresentation & {\n  resourceType: string;\n};\n\nexport default function PermissionDetails() {\n  const { t } = useTranslation(\"clients\");\n\n  const form = useForm<FormFields>({\n    mode: \"onChange\",\n  });\n  const {\n    register,\n    control,\n    reset,\n    formState: { errors },\n    handleSubmit,\n  } = form;\n\n  const navigate = useNavigate();\n  const { id, realm, permissionType, permissionId, selectedId } = useParams<\n    NewPermissionParams & PermissionDetailsParams\n  >();\n\n  const { adminClient } = useAdminClient();\n  const { addAlert, addError } = useAlerts();\n  const [permission, setPermission] = useState<PolicyRepresentation>();\n  const [applyToResourceTypeFlag, setApplyToResourceTypeFlag] = useState(false);\n\n  useFetch(\n    async () => {\n      if (!permissionId) {\n        return {};\n      }\n      const [permission, resources, policies, scopes] = await Promise.all([\n        adminClient.clients.findOnePermission({\n          id,\n          type: permissionType,\n          permissionId,\n        }),\n        adminClient.clients.getAssociatedResources({\n          id,\n          permissionId,\n        }),\n        adminClient.clients.getAssociatedPolicies({\n          id,\n          permissionId,\n        }),\n        adminClient.clients.getAssociatedScopes({\n          id,\n          permissionId,\n        }),\n      ]);\n\n      if (!permission) {\n        throw new Error(t(\"common:notFound\"));\n      }\n\n      return {\n        permission,\n        resources: resources.map((r) => r._id),\n        policies: policies.map((p) => p.id!),\n        scopes: scopes.map((s) => s.id!),\n      };\n    },\n    ({ permission, resources, policies, scopes }) => {\n      reset({ ...permission, resources, policies, scopes });\n      if (permission && \"resourceType\" in permission) {\n        setApplyToResourceTypeFlag(\n          !!(permission as { resourceType: string }).resourceType\n        );\n      }\n      setPermission({ ...permission, resources, policies });\n    },\n    []\n  );\n\n  const save = async (permission: PolicyRepresentation) => {\n    try {\n      if (permissionId) {\n        await adminClient.clients.updatePermission(\n          { id, type: permissionType, permissionId },\n          permission\n        );\n      } else {\n        const result = await adminClient.clients.createPermission(\n          { id, type: permissionType },\n          permission\n        );\n        navigate(\n          toPermissionDetails({\n            realm,\n            id,\n            permissionType,\n            permissionId: result.id!,\n          })\n        );\n      }\n      addAlert(\n        t((permissionId ? \"update\" : \"create\") + \"PermissionSuccess\"),\n        AlertVariant.success\n      );\n    } catch (error) {\n      addError(\"clients:permissionSaveError\", error);\n    }\n  };\n\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\n    titleKey: \"clients:deletePermission\",\n    messageKey: t(\"deletePermissionConfirm\", {\n      permission: permission?.name,\n    }),\n    continueButtonVariant: ButtonVariant.danger,\n    continueButtonLabel: \"clients:confirm\",\n    onConfirm: async () => {\n      try {\n        await adminClient.clients.delPermission({\n          id,\n          type: permissionType,\n          permissionId: permissionId,\n        });\n        addAlert(t(\"permissionDeletedSuccess\"), AlertVariant.success);\n        navigate(\n          toAuthorizationTab({ realm, clientId: id, tab: \"permissions\" })\n        );\n      } catch (error) {\n        addError(\"clients:permissionDeletedError\", error);\n      }\n    },\n  });\n\n  const resourcesIds = useWatch({\n    control,\n    name: \"resources\",\n    defaultValue: [],\n  });\n\n  if (!permission) {\n    return <KeycloakSpinner />;\n  }\n\n  return (\n    <>\n      <DeleteConfirm />\n      <ViewHeader\n        titleKey={\n          permissionId\n            ? permission.name!\n            : `clients:create${toUpperCase(permissionType)}BasedPermission`\n        }\n        dropdownItems={\n          permissionId\n            ? [\n                <DropdownItem\n                  key=\"delete\"\n                  data-testid=\"delete-resource\"\n                  onClick={() => toggleDeleteDialog()}\n                >\n                  {t(\"common:delete\")}\n                </DropdownItem>,\n              ]\n            : undefined\n        }\n      />\n      <PageSection variant=\"light\">\n        <FormAccess\n          isHorizontal\n          role=\"view-clients\"\n          onSubmit={handleSubmit(save)}\n        >\n          <FormProvider {...form}>\n            <FormGroup\n              label={t(\"common:name\")}\n              isRequired\n              helperTextInvalid={t(\"common:required\")}\n              validated={errors.name ? \"error\" : \"default\"}\n              fieldId=\"name\"\n              labelIcon={\n                <HelpItem\n                  helpText={t(\"clients-help:permissionName\")}\n                  fieldLabelId=\"name\"\n                />\n              }\n            >\n              <KeycloakTextInput\n                id=\"name\"\n                validated={errors.name ? \"error\" : \"default\"}\n                {...register(\"name\", { required: true })}\n              />\n            </FormGroup>\n            <FormGroup\n              label={t(\"common:description\")}\n              fieldId=\"description\"\n              labelIcon={\n                <HelpItem\n                  helpText={t(\"clients-help:permissionDescription\")}\n                  fieldLabelId=\"description\"\n                />\n              }\n              validated={errors.description ? \"error\" : \"default\"}\n              helperTextInvalid={errors.description?.message}\n            >\n              <KeycloakTextArea\n                id=\"description\"\n                validated={errors.description ? \"error\" : \"default\"}\n                {...register(\"description\", {\n                  maxLength: {\n                    value: 255,\n                    message: t(\"common:maxLength\", { length: 255 }),\n                  },\n                })}\n              />\n            </FormGroup>\n            <FormGroup\n              label={t(\"applyToResourceTypeFlag\")}\n              fieldId=\"applyToResourceTypeFlag\"\n              labelIcon={\n                <HelpItem\n                  helpText={t(\"clients-help:applyToResourceTypeFlag\")}\n                  fieldLabelId=\"clients:applyToResourceTypeFlag\"\n                />\n              }\n            >\n              <Switch\n                id=\"applyToResourceTypeFlag\"\n                name=\"applyToResourceTypeFlag\"\n                label={t(\"common:on\")}\n                labelOff={t(\"common:off\")}\n                isChecked={applyToResourceTypeFlag}\n                onChange={setApplyToResourceTypeFlag}\n                aria-label={t(\"applyToResourceTypeFlag\")}\n              />\n            </FormGroup>\n            {applyToResourceTypeFlag ? (\n              <FormGroup\n                label={t(\"resourceType\")}\n                fieldId=\"name\"\n                labelIcon={\n                  <HelpItem\n                    helpText={t(\"clients-help:resourceType\")}\n                    fieldLabelId=\"resourceType\"\n                  />\n                }\n                isRequired={permissionType === \"scope\"}\n              >\n                <KeycloakTextInput\n                  id=\"resourceType\"\n                  {...register(\"resourceType\", {\n                    required: permissionType === \"scope\",\n                  })}\n                />\n              </FormGroup>\n            ) : (\n              <FormGroup\n                label={t(\"resources\")}\n                fieldId=\"resources\"\n                labelIcon={\n                  <HelpItem\n                    helpText={t(\"clients-help:permissionResources\")}\n                    fieldLabelId=\"clients:resources\"\n                  />\n                }\n                helperTextInvalid={t(\"common:required\")}\n                validated={errors.resources ? \"error\" : \"default\"}\n                isRequired={permissionType !== \"scope\"}\n              >\n                <ResourcesPolicySelect\n                  name=\"resources\"\n                  clientId={id}\n                  permissionId={permissionId}\n                  preSelected={\n                    permissionType === \"scope\" ? undefined : selectedId\n                  }\n                  variant={\n                    permissionType === \"scope\"\n                      ? SelectVariant.typeahead\n                      : SelectVariant.typeaheadMulti\n                  }\n                  isRequired={permissionType !== \"scope\"}\n                />\n              </FormGroup>\n            )}\n            {permissionType === \"scope\" && (\n              <FormGroup\n                label={t(\"authorizationScopes\")}\n                fieldId=\"scopes\"\n                labelIcon={\n                  <HelpItem\n                    helpText={t(\"clients-help:permissionScopes\")}\n                    fieldLabelId=\"clients:scopesSelect\"\n                  />\n                }\n                helperTextInvalid={t(\"common:required\")}\n                validated={errors.scopes ? \"error\" : \"default\"}\n                isRequired\n              >\n                <ScopeSelect\n                  clientId={id}\n                  resourceId={resourcesIds?.[0]}\n                  preSelected={selectedId}\n                />\n              </FormGroup>\n            )}\n            <FormGroup\n              label={t(\"policies\")}\n              fieldId=\"policies\"\n              labelIcon={\n                <HelpItem\n                  helpText={t(\"clients-help:permissionPolicies\")}\n                  fieldLabelId=\"clients:policies\"\n                />\n              }\n            >\n              <ResourcesPolicySelect\n                name=\"policies\"\n                clientId={id}\n                permissionId={permissionId}\n              />\n            </FormGroup>\n            <FormGroup\n              label={t(\"decisionStrategy\")}\n              labelIcon={\n                <HelpItem\n                  helpText={t(\"clients-help:permissionDecisionStrategy\")}\n                  fieldLabelId=\"clients:decisionStrategy\"\n                />\n              }\n              fieldId=\"policyEnforcementMode\"\n              hasNoPaddingTop\n            >\n              <Controller\n                name=\"decisionStrategy\"\n                data-testid=\"decisionStrategy\"\n                defaultValue={DecisionStrategy.UNANIMOUS}\n                control={control}\n                render={({ field }) => (\n                  <>\n                    {Object.values(DecisionStrategy).map((strategy) => (\n                      <Radio\n                        id={strategy}\n                        key={strategy}\n                        data-testid={strategy}\n                        isChecked={field.value === strategy}\n                        name=\"decisionStrategies\"\n                        onChange={() => field.onChange(strategy)}\n                        label={t(`decisionStrategies.${strategy}`)}\n                        className=\"pf-u-mb-md\"\n                      />\n                    ))}\n                  </>\n                )}\n              />\n            </FormGroup>\n            <ActionGroup>\n              <div className=\"pf-u-mt-md\">\n                <Button\n                  variant={ButtonVariant.primary}\n                  type=\"submit\"\n                  data-testid=\"save\"\n                >\n                  {t(\"common:save\")}\n                </Button>\n\n                <Button\n                  variant=\"link\"\n                  data-testid=\"cancel\"\n                  component={(props) => (\n                    <Link\n                      {...props}\n                      to={toAuthorizationTab({\n                        realm,\n                        clientId: id,\n                        tab: \"permissions\",\n                      })}\n                    ></Link>\n                  )}\n                >\n                  {t(\"common:cancel\")}\n                </Button>\n              </div>\n            </ActionGroup>\n          </FormProvider>\n        </FormAccess>\n      </PageSection>\n    </>\n  );\n}\n"],"names":["ScopeSelect","clientId","resourceId","preSelected","t","useTranslation","adminClient","useAdminClient","control","getValues","setValue","errors","useFormContext","scopes","setScopes","useState","selectedScopes","setSelectedScopes","search","setSearch","open","setOpen","firstUpdate","useRef","values","toSelectOptions","scope","jsx","SelectOption","useFetch","s","Controller","value","field","Select","SelectVariant","_","filter","selectedValue","option","changedValue","p","PermissionDetails","form","useForm","register","reset","handleSubmit","navigate","useNavigate","id","realm","permissionType","permissionId","selectedId","useParams","addAlert","addError","useAlerts","permission","setPermission","applyToResourceTypeFlag","setApplyToResourceTypeFlag","resources","policies","r","save","result","toPermissionDetails","AlertVariant","error","toggleDeleteDialog","DeleteConfirm","useConfirmDialog","ButtonVariant","toAuthorizationTab","resourcesIds","useWatch","jsxs","Fragment","ViewHeader","toUpperCase","DropdownItem","PageSection","FormAccess","FormProvider","FormGroup","HelpItem","KeycloakTextInput","KeycloakTextArea","Switch","ResourcesPolicySelect","DecisionStrategy","strategy","Radio","ActionGroup","Button","props","Link","KeycloakSpinner"],"mappings":"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"}