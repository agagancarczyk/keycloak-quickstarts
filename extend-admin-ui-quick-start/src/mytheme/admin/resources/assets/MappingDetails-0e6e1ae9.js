import{u as B,d as K,e as G,f as q,r as j,b as L,c as _,R as N,a9 as $,n as H,k as U,A as w,j as e,w as z,P as J,F as v,G as Q,V as l,g as W,B as F,L as X,aa as Y,a5 as Z,ab as ee,s as oe,q as te}from"./index-a3421f29.js";import{u as re}from"./ConfirmDialog-09ff7a12.js";import{D as ae}from"./DynamicComponents-72877b30.js";import{F as pe}from"./FormAccess-1cceaef6.js";import{K as S}from"./KeycloakTextInput-e7f6e917.js";import{V as ie}from"./ViewHeader-832ec56e.js";import{u as ne}from"./useParams-5abeab7d.js";import{A as se}from"./Form-518a2cf2.js";import"./Modal-21c37af7.js";import"./ClientSelect-3f0fc581.js";import"./Select-0f56a9cc.js";import"./check-fc57dbe1.js";import"./star-icon-6a7e7d25.js";import"./FileUpload-ca37c1a6.js";import"./CodeEditor-2fb93648.js";import"./copy-icon-a4fe01af.js";import"./EmptyStateBody-7b4fcee1.js";import"./EmptyStateSecondaryActions-08edafb5.js";import"./GroupPickerDialog-caf8c38d.js";import"./PaginatingTableToolbar-08ca9efb.js";import"./plus-circle-icon-cb854796.js";import"./TableToolbar-ee0c86ef.js";import"./ToolbarContent-7b435752.js";import"./DataListItemRow-75e02946.js";import"./data-list-7d55714c.js";import"./grip-vertical-icon-cbeff50f.js";import"./ActionListItem-ab1a4322.js";import"./FlexItem-65b5f999.js";import"./minus-circle-icon-6f9a971c.js";import"./MultiLineInput-14187d1c.js";import"./PasswordInput-85f9399f.js";import"./useToggle-a9cb2c55.js";import"./AddRoleMappingModal-abb19beb.js";import"./KeycloakDataTable-10a62d94.js";import"./Td-6d4ab209.js";import"./Checkbox-d00621d8.js";import"./useLocaleSort-3efc7c31.js";import"./resource-08ae7dbc.js";import"./joinPath-55fd24bc.js";import"./filter-icon-9d72dc58.js";import"./KeycloakTextArea-1b518857.js";import"./GridItem-d34dae2e.js";import"./Text-564bf299.js";function Ye(){const{t}=B("client-scopes"),{adminClient:i}=K(),{addAlert:u,addError:f}=G(),{id:r,mapperId:a}=ne(),g=q(),{register:T,setValue:b,formState:{errors:y},handleSubmit:C}=g,[d,I]=j.useState(),[D,P]=j.useState(),A=L(),{realm:x}=_(),h=N(),V=/^[{]?[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$/,s=!!a.match(V),m=!!$(Y.path),M=()=>m?Z({realm:x,id:r,tab:"mappers"}):ee({realm:x,clientId:r,tab:"mappers"});H(async()=>{let o;if(s){if(m?o=await i.clientScopes.findProtocolMapper({id:r,mapperId:a}):o=await i.clients.findProtocolMapperById({id:r,mapperId:a}),!o)throw new Error(t("common:notFound"));const p=h.protocolMapperTypes[o.protocol].find(c=>c.id===o.protocolMapper);return{config:{protocol:o.protocol,protocolMapper:o.protocolMapper},mapping:p,data:o}}else{const n=m?await i.clientScopes.findOne({id:r}):await i.clients.findOne({id:r});if(!n)throw new Error(t("common:notFound"));const c=h.protocolMapperTypes[n.protocol].find(R=>R.id===a);if(!c)throw new Error(t("common:notFound"));return{mapping:c,config:{protocol:n.protocol,protocolMapper:a}}}},({config:o,mapping:n,data:p})=>{P(o),I(n),p&&te(p,b)},[]);const[E,k]=re({titleKey:"common:deleteMappingTitle",messageKey:"common:deleteMappingConfirm",continueButtonLabel:"common:delete",continueButtonVariant:U.danger,onConfirm:async()=>{try{m?await i.clientScopes.delProtocolMapper({id:r,mapperId:a}):await i.clients.delProtocolMapper({id:r,mapperId:a}),u(t("common:mappingDeletedSuccess"),w.success),A(M())}catch(o){f("common:mappingDeletedError",o)}}}),O=async o=>{const n=s?"Updated":"Created";try{const p={...D,...oe(o)};s?m?await i.clientScopes.updateProtocolMapper({id:r,mapperId:a},{id:a,...p}):await i.clients.updateProtocolMapper({id:r,mapperId:a},{id:a,...p}):m?await i.clientScopes.addProtocolMapper({id:r},p):await i.clients.addProtocolMapper({id:r},p),u(t(`common:mapping${n}Success`),w.success)}catch(p){f(`common:mapping${n}Error`,p)}};return e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsx(ie,{titleKey:s?d?.name:t("common:addMapper"),subKey:s?a:"client-scopes:addMapperExplain",dropdownItems:s?[e.jsx(z,{value:"delete",onClick:E,children:t("common:delete")},"delete")]:void 0}),e.jsx(J,{variant:"light",children:e.jsxs(pe,{isHorizontal:!0,onSubmit:C(O),role:"manage-clients",className:"keycloak__client-scope-mapping-details__form",children:[e.jsx(v,{label:t("common:mapperType"),fieldId:"mapperType",children:e.jsx(S,{type:"text",id:"mapperType",name:"mapperType",isReadOnly:!0,value:d?.name})}),e.jsx(v,{label:t("common:name"),labelIcon:e.jsx(Q,{helpText:t("client-scopes-help:mapperName"),fieldLabelId:"name"}),fieldId:"name",isRequired:!0,validated:y.name?l.error:l.default,helperTextInvalid:t("common:required"),children:e.jsx(S,{id:"name",isReadOnly:s,validated:y.name?l.error:l.default,...T("name",{required:!0})})}),e.jsx(W,{...g,children:e.jsx(ae,{properties:d?.properties||[]})}),e.jsxs(se,{children:[e.jsx(F,{variant:"primary",type:"submit",children:t("common:save")}),e.jsx(F,{variant:"link",component:o=>e.jsx(X,{...o,to:M()}),children:t("common:cancel")})]})]})})]})}export{Ye as default};
//# sourceMappingURL=MappingDetails-0e6e1ae9.js.map
